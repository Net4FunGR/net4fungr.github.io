<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Kube My Router Up! - Last Part</title><meta name=author content=" ">
<meta name=description content="Final part of testing google&rsquo;s KNE - Installing and using kne_cli to build topologies using srlinux and cEOS."><meta name=keywords content='k8s,kne,netsim'><meta itemprop=name content="Kube my router up! - Last Part"><meta itemprop=description content="Final part of testing google’s KNE - Installing and using kne_cli to build topologies using srlinux and cEOS."><meta itemprop=datePublished content="2022-06-06T00:00:00+03:00"><meta itemprop=dateModified content="2022-06-09T00:00:00+03:00"><meta itemprop=wordCount content="9818"><meta itemprop=image content="https://net4fungr.github.io/posts/kube-my-router-pt3/featured-image.jpg"><meta itemprop=keywords content="K8s,Kne,Netsim"><meta property="og:url" content="https://net4fungr.github.io/posts/kube-my-router-pt3/"><meta property="og:site_name" content="Becos :: Back Blog"><meta property="og:title" content="Kube my router up! - Last Part"><meta property="og:description" content="Final part of testing google’s KNE - Installing and using kne_cli to build topologies using srlinux and cEOS."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-06-06T00:00:00+03:00"><meta property="article:modified_time" content="2022-06-09T00:00:00+03:00"><meta property="article:tag" content="K8s"><meta property="article:tag" content="Kne"><meta property="article:tag" content="Netsim"><meta property="og:image" content="https://net4fungr.github.io/posts/kube-my-router-pt3/featured-image.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://net4fungr.github.io/posts/kube-my-router-pt3/featured-image.jpg"><meta name=twitter:title content="Kube my router up! - Last Part"><meta name=twitter:description content="Final part of testing google’s KNE - Installing and using kne_cli to build topologies using srlinux and cEOS."><meta name=twitter:site content="@mkaliotis"><meta name=twitter:creator content="@mkaliotis"><meta name=application-name content="Becos :: Back Blog"><meta name=apple-mobile-web-app-title content="Becos :: Back Blog"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=canonical type=text/html href=https://net4fungr.github.io/posts/kube-my-router-pt3/ title="Kube my router up! - Last Part - Becos :: Back Blog"><link rel=prev type=text/html href=https://net4fungr.github.io/posts/kube-my-router-pt2/ title="Kube my router up! - Part Two"><link rel=next type=text/html href=https://net4fungr.github.io/posts/proxy-or-not/ title="Proxy or not...here I come..."><link rel=alternate type=text/markdown href=https://net4fungr.github.io/posts/kube-my-router-pt3/index.md title="Kube my router up! - Last Part - Becos :: Back Blog"><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><meta name=google-site-verification content="m_enMQYWx1a1cSKPfRT_00wHfqT8ir4PZSBPyeaIH-o"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Kube my router up! - Last Part","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/net4fungr.github.io\/posts\/kube-my-router-pt3\/"},"image":[{"@type":"ImageObject","url":"https:\/\/net4fungr.github.io\/posts\/kube-my-router-pt3\/featured-image.jpg","width":1600,"height":450}],"genre":"posts","keywords":"k8s, kne, netsim","wordcount":9818,"url":"https:\/\/net4fungr.github.io\/posts\/kube-my-router-pt3\/","datePublished":"2022-06-06T00:00:00+03:00","dateModified":"2022-06-09T00:00:00+03:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":" "},"description":""}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=narrow><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title="Becos :: Back Blog"><img class=logo src=/images/pyrtr_small.png alt="Becos :: Back Blog" height=32 width=32><span class=header-title-pre><</span><span class=header-title-text>...ssh and blog...</span><span class=header-title-post>/></span></a><span class="typeit header-subtitle"><template>revamped!</template></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/categories/ title="Posts Organised by Category"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=/collections/ title="Multipart Posts"><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> Collections</a></li><li class=menu-item><a class=menu-link href=/archives/ title="All My Posts"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> Archives</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=https://becos76.github.io title="About Me" rel="noopener noreferrer" target=_blank><i class="fa-solid fa-signature fa-fw fa-sm" aria-hidden=true></i> About</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="Search titles or contents ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Becos :: Back Blog"><img class=logo src=/images/pyrtr_small.png alt="Becos :: Back Blog" height=26 width=26><span class=header-title-pre><</span><span class=header-title-text>...ssh and blog...</span><span class=header-title-post>/></span></a><span class="typeit header-subtitle"><template>revamped!</template></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></li><li class=menu-item><a class=menu-link href=/categories/ title="Posts Organised by Category"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=/collections/ title="Multipart Posts"><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> Collections</a></li><li class=menu-item><a class=menu-link href=/archives/ title="All My Posts"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> Archives</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=https://becos76.github.io title="About Me" rel="noopener noreferrer" target=_blank><i class="fa-solid fa-signature fa-fw fa-sm" aria-hidden=true></i> About</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=Collections><div class="details collection-details open"><div class="details-summary collection-summary"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i>
<span class=collection-name title=Collections>Kube My Router Up!</span>
<span class=collection-count>3</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content collection-content"><nav><ul class=collection-list><li class=collection-item><a href=/posts/kube-my-router-pt1/ title="Kube My Router Up! - Part One">Kube My Router Up! - Part One</a></li><li class=collection-item><a href=/posts/kube-my-router-pt2/ title="Kube My Router Up! - Part Two">Kube My Router Up! - Part Two</a></li><li class=collection-item><span class=active title="Kube My Router Up! - Last Part">Kube My Router Up! - Last Part</span></li></ul><div class=collection-nav-simple><a href=/posts/kube-my-router-pt2/ class=collection-nav-item rel=prev title="Kube My Router Up! - Part Two"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i></a><span class=text-secondary>3/3</span><i class="fa-solid fa-angle-right fa-fw collection-nav-item text-secondary" aria-hidden=true></i></div></nav></div></div><div class="details related-details open"><div class="details-summary related-summary"><i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden=true></i>
<span class=related-title>Related Content</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content related-content"><ul class=related-list><li class=related-item><a href=/posts/kube-my-router-pt2/ title="Kube My Router Up! - Part Two">Kube My Router Up! - Part Two</a></li><li class=related-item><a href=/posts/kube-my-router-pt1/ title="Kube My Router Up! - Part One">Kube My Router Up! - Part One</a></li></ul></div></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Kube My Router Up! - Last Part</span></h1><p class="single-subtitle animate__animated animate__fadeIn">Test drive google&rsquo;s Kubernetes Network Emulation</p></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
</span></span><span class=post-included-in>&nbsp;included in <a href=/categories/art-of-labbing/ class=post-category title="Category - Art of Labbing"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Art of Labbing</a> and <a href=/collections/kube-my-router-up/ class=post-collection title="Collection - Kube My Router Up!"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> Kube My Router Up!</a></span></div><div class=post-meta-line><span title="published on 2022-06-06 00:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2022-06-06>2022-06-06</time></span>&nbsp;<span title="Updated on 2022-06-09 00:00:00"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden=true></i><time datetime=2022-06-09>2022-06-09</time></span>&nbsp;<span title="9818 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>About 9900 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>47 minutes</span>&nbsp;</div></div><div class=featured-image><img src=/posts/kube-my-router-pt3/featured-image.jpg alt=/posts/kube-my-router-pt3/featured-image.jpg></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#intro><a href=/posts/kube-my-router-pt1/#intro>Intro</a></a></li><li><a href=#part-one---setting-up-the-k8s-vms-in-eve-ng><a href=/posts/kube-my-router-pt1/>Part One - Setting up the k8s VMs in EVE-NG</a></a></li><li><a href=#part-two---deploying-the-k8s-cluster-with-kubeadm><a href=/posts/kube-my-router-pt2/>Part Two - Deploying the k8s cluster with kubeadm</a></a></li><li><a href=#last-part---installing-and-testing-kne><a href=/posts/kube-my-router-pt3/>Last Part - Installing and testing KNE</a></a><ul><li><a href=#the-intent>The Intent</a></li><li><a href=#prepare-for-kne-installation>Prepare for KNE installation</a></li><li><a href=#deploy-kne>Deploy KNE</a></li><li><a href=#prepare-k8s-cluster-for-kne>Prepare k8s cluster for KNE</a></li><li><a href=#use-kne-to-create-a-basic-topology>Use KNE to create a basic topology</a></li><li><a href=#test-nokia-srlinux>Test Nokia srlinux</a></li><li><a href=#test-arista-ceos>Test Arista cEOS</a></li><li><a href=#references-and-influences>References and influences</a></li></ul></li><li><a href=#outro>Outro</a></li></ul></nav></div></div><div class=content id=content><hr><h2 class=heading-element id=intro><span><a href=/posts/kube-my-router-pt1/#intro>Intro</a></span>
<a href=#intro class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><hr><h2 class=heading-element id=part-one---setting-up-the-k8s-vms-in-eve-ng><span><a href=/posts/kube-my-router-pt1/>Part One - Setting up the k8s VMs in EVE-NG</a></span>
<a href=#part-one---setting-up-the-k8s-vms-in-eve-ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><hr><h2 class=heading-element id=part-two---deploying-the-k8s-cluster-with-kubeadm><span><a href=/posts/kube-my-router-pt2/>Part Two - Deploying the k8s cluster with kubeadm</a></span>
<a href=#part-two---deploying-the-k8s-cluster-with-kubeadm class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><hr><h2 class=heading-element id=last-part---installing-and-testing-kne><span><a href=/posts/kube-my-router-pt3/>Last Part - Installing and testing KNE</a></span>
<a href=#last-part---installing-and-testing-kne class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><hr><h3 class=heading-element id=the-intent><span>The Intent</span>
<a href=#the-intent class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><ul><li>Install Google&rsquo;s KNE on the k8s control node</li><li>Use KNE to create sample topologies</li><li>Test with Nokia srlinux</li><li>Test with Arista cEOS</li></ul><p>The time has come to install Google&rsquo;s KNE!!!. We are going to use the k8s control node for KNEs &ldquo;control&rdquo; server, so everything will be installed on it.</p><hr><h3 class=heading-element id=prepare-for-kne-installation><span>Prepare for KNE installation</span>
<a href=#prepare-for-kne-installation class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><hr><p>We need <strong>go</strong> so we are going to install it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Download go</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ wget -q https://go.dev/dl/go1.18.2.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Install it under our HOME directory</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ tar -xvzf go1.18.2.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Put it in your PATH</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ <span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=nv>$PATH</span>:~/go/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ <span class=nb>echo</span> !! &gt;&gt; ~/.profile
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=nv>$PATH</span>:~/go/bin &gt;&gt; ~/.profile
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check if it&#39;s working</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ go version
</span></span><span class=line><span class=cl>go version go1.18.2 linux/amd64</span></span></code></pre></div><hr><h3 class=heading-element id=deploy-kne><span>Deploy KNE</span>
<a href=#deploy-kne class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><hr><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-pencil-alt" aria-hidden=true></i>Use of kind<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>KNE requires <strong>kind</strong> if you are going to use it in a single node. KNE can also deploy a single node k8s using kind and have it run inside a container. Then all the labs will be deployed into this containerised k8s node.</div></div></div><p>OK! We are now ready to install KNE. There are two ways, either install it via go</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ go install github.com/google/kne/kne_cli@latest</span></span></code></pre></div><p>or, clone the repo from github and build it locally, which is what I did.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ git clone https://github.com/google/kne.git
</span></span><span class=line><span class=cl>Cloning into <span class=s1>&#39;kne&#39;</span>...
</span></span><span class=line><span class=cl>remote: Enumerating objects: 2146, <span class=k>done</span>.
</span></span><span class=line><span class=cl>remote: Counting objects: 100% <span class=o>(</span>154/154<span class=o>)</span>, <span class=k>done</span>.
</span></span><span class=line><span class=cl>remote: Compressing objects: 100% <span class=o>(</span>89/89<span class=o>)</span>, <span class=k>done</span>.
</span></span><span class=line><span class=cl>remote: Total <span class=m>2146</span> <span class=o>(</span>delta 66<span class=o>)</span>, reused <span class=m>145</span> <span class=o>(</span>delta 62<span class=o>)</span>, pack-reused <span class=m>1992</span>
</span></span><span class=line><span class=cl>Receiving objects: 100% <span class=o>(</span>2146/2146<span class=o>)</span>, 41.28 MiB <span class=p>|</span> 200.00 KiB/s, <span class=k>done</span>.
</span></span><span class=line><span class=cl>Resolving deltas: 100% <span class=o>(</span>1052/1052<span class=o>)</span>, <span class=k>done</span>.
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ <span class=nb>cd</span> kne/kne_cli/
</span></span><span class=line><span class=cl>ubuntu@kates-control:~/kne/kne_cli$ <span class=nv>GOPATH</span><span class=o>=</span>~/go go install
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~/kne/kne_cli$ <span class=nb>cd</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kne_cli
</span></span><span class=line><span class=cl>Kubernetes Network Emulation CLI.  Works with meshnet to create
</span></span><span class=line><span class=cl>layer <span class=m>2</span> topology used by containers to layout networks in a k8s
</span></span><span class=line><span class=cl>environment.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Usage:
</span></span><span class=line><span class=cl>  kne_cli <span class=o>[</span>command<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Available Commands:
</span></span><span class=line><span class=cl>  completion  Generate the autocompletion script <span class=k>for</span> the specified shell
</span></span><span class=line><span class=cl>  create      Create Topology
</span></span><span class=line><span class=cl>  delete      Delete Topology
</span></span><span class=line><span class=cl>  deploy      Deploy cluster.
</span></span><span class=line><span class=cl>  <span class=nb>help</span>        Help about any <span class=nb>command</span>
</span></span><span class=line><span class=cl>  show        Show Topology
</span></span><span class=line><span class=cl>  topology    Topology commands.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Flags:
</span></span><span class=line><span class=cl>  -h, --help               <span class=nb>help</span> <span class=k>for</span> kne_cli
</span></span><span class=line><span class=cl>      --kubecfg string     kubeconfig file <span class=o>(</span>default <span class=s2>&#34;/home/ubuntu/.kube/config&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  -v, --verbosity string   log level <span class=o>(</span>default <span class=s2>&#34;info&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Use <span class=s2>&#34;kne_cli [command] --help&#34;</span> <span class=k>for</span> more information about a command.
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$</span></span></code></pre></div><hr><h3 class=heading-element id=prepare-k8s-cluster-for-kne><span>Prepare k8s cluster for KNE</span>
<a href=#prepare-k8s-cluster-for-kne class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><hr><p>We need to install meshnet CNI.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Install meshnet from local manifests</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl apply -k kne/manifests/meshnet/base/
</span></span><span class=line><span class=cl>namespace/meshnet created
</span></span><span class=line><span class=cl>customresourcedefinition.apiextensions.k8s.io/topologies.networkop.co.uk created
</span></span><span class=line><span class=cl>serviceaccount/meshnet created
</span></span><span class=line><span class=cl>clusterrole.rbac.authorization.k8s.io/meshnet-clusterrole created
</span></span><span class=line><span class=cl>clusterrolebinding.rbac.authorization.k8s.io/meshnet-clusterrolebinding created
</span></span><span class=line><span class=cl>daemonset.apps/meshnet created
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check for any issues</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl get events -n meshnet
</span></span><span class=line><span class=cl>LAST SEEN   TYPE     REASON             OBJECT              MESSAGE
</span></span><span class=line><span class=cl>15m         Normal   Scheduled          pod/meshnet-72zz4   Successfully assigned meshnet/meshnet-72zz4 to kates-node-02
</span></span><span class=line><span class=cl>15m         Normal   Pulling            pod/meshnet-72zz4   Pulling image <span class=s2>&#34;hfam/meshnet:latest&#34;</span>
</span></span><span class=line><span class=cl>15m         Normal   Pulled             pod/meshnet-72zz4   Successfully pulled image <span class=s2>&#34;hfam/meshnet:latest&#34;</span> in 9.581184132s
</span></span><span class=line><span class=cl>15m         Normal   Created            pod/meshnet-72zz4   Created container meshnet
</span></span><span class=line><span class=cl>15m         Normal   Started            pod/meshnet-72zz4   Started container meshnet
</span></span><span class=line><span class=cl>15m         Normal   Scheduled          pod/meshnet-9vqr2   Successfully assigned meshnet/meshnet-9vqr2 to kates-node-01
</span></span><span class=line><span class=cl>15m         Normal   Pulling            pod/meshnet-9vqr2   Pulling image <span class=s2>&#34;hfam/meshnet:latest&#34;</span>
</span></span><span class=line><span class=cl>15m         Normal   Pulled             pod/meshnet-9vqr2   Successfully pulled image <span class=s2>&#34;hfam/meshnet:latest&#34;</span> in 9.716760651s
</span></span><span class=line><span class=cl>15m         Normal   Created            pod/meshnet-9vqr2   Created container meshnet
</span></span><span class=line><span class=cl>15m         Normal   Started            pod/meshnet-9vqr2   Started container meshnet
</span></span><span class=line><span class=cl>15m         Normal   Scheduled          pod/meshnet-fkv2s   Successfully assigned meshnet/meshnet-fkv2s to kates-control
</span></span><span class=line><span class=cl>15m         Normal   Pulling            pod/meshnet-fkv2s   Pulling image <span class=s2>&#34;hfam/meshnet:latest&#34;</span>
</span></span><span class=line><span class=cl>15m         Normal   Pulled             pod/meshnet-fkv2s   Successfully pulled image <span class=s2>&#34;hfam/meshnet:latest&#34;</span> in 10.072682996s
</span></span><span class=line><span class=cl>15m         Normal   Created            pod/meshnet-fkv2s   Created container meshnet
</span></span><span class=line><span class=cl>15m         Normal   Started            pod/meshnet-fkv2s   Started container meshnet
</span></span><span class=line><span class=cl>15m         Normal   SuccessfulCreate   daemonset/meshnet   Created pod: meshnet-fkv2s
</span></span><span class=line><span class=cl>15m         Normal   SuccessfulCreate   daemonset/meshnet   Created pod: meshnet-72zz4
</span></span><span class=line><span class=cl>15m         Normal   SuccessfulCreate   daemonset/meshnet   Created pod: meshnet-9vqr2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check the new namespace</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl get all -n meshnet
</span></span><span class=line><span class=cl>NAME                READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>pod/meshnet-72zz4   1/1     Running   <span class=m>0</span>          15m
</span></span><span class=line><span class=cl>pod/meshnet-9vqr2   1/1     Running   <span class=m>0</span>          15m
</span></span><span class=line><span class=cl>pod/meshnet-fkv2s   1/1     Running   <span class=m>0</span>          15m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                     DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR              AGE
</span></span><span class=line><span class=cl>daemonset.apps/meshnet   <span class=m>3</span>         <span class=m>3</span>         <span class=m>3</span>       <span class=m>3</span>            <span class=m>3</span>           kubernetes.io/arch<span class=o>=</span>amd64   15m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check the cni</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ sudo cat /etc/cni/net.d/00-meshnet.conflist
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;cniVersion&#34;</span>: <span class=s2>&#34;0.3.1&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;name&#34;</span>: <span class=s2>&#34;cbr0&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;plugins&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>                <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;delegate&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                                <span class=s2>&#34;hairpinMode&#34;</span>: true,
</span></span><span class=line><span class=cl>                                <span class=s2>&#34;isDefaultGateway&#34;</span>: <span class=nb>true</span>
</span></span><span class=line><span class=cl>                        <span class=o>}</span>,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;type&#34;</span>: <span class=s2>&#34;flannel&#34;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>,
</span></span><span class=line><span class=cl>                <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;capabilities&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>                                <span class=s2>&#34;portMappings&#34;</span>: <span class=nb>true</span>
</span></span><span class=line><span class=cl>                        <span class=o>}</span>,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;type&#34;</span>: <span class=s2>&#34;portmap&#34;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>,
</span></span><span class=line><span class=cl>                <span class=o>{</span>
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;name&#34;</span>: <span class=s2>&#34;meshnet&#34;</span>,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;type&#34;</span>: <span class=s2>&#34;meshnet&#34;</span>,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;ipam&#34;</span>: <span class=o>{}</span>,
</span></span><span class=line><span class=cl>                        <span class=s2>&#34;dns&#34;</span>: <span class=o>{}</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div><p>Then we need to install metallb in order to access our nodes from outside k8s.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Install from local manifests</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl apply -f kne/manifests/metallb/namespace.yaml
</span></span><span class=line><span class=cl>namespace/metallb-system created
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl create secret generic -n metallb-system memberlist --from-literal<span class=o>=</span><span class=nv>secretkey</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>openssl rand -base64 128<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>secret/memberlist created
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl apply -f kne/manifests/metallb/metallb.yaml
</span></span><span class=line><span class=cl>Warning: policy/v1beta1 PodSecurityPolicy is deprecated in v1.21+, unavailable in v1.25+
</span></span><span class=line><span class=cl>podsecuritypolicy.policy/controller created
</span></span><span class=line><span class=cl>podsecuritypolicy.policy/speaker created
</span></span><span class=line><span class=cl>serviceaccount/controller created
</span></span><span class=line><span class=cl>serviceaccount/speaker created
</span></span><span class=line><span class=cl>clusterrole.rbac.authorization.k8s.io/metallb-system:controller created
</span></span><span class=line><span class=cl>clusterrole.rbac.authorization.k8s.io/metallb-system:speaker created
</span></span><span class=line><span class=cl>role.rbac.authorization.k8s.io/config-watcher created
</span></span><span class=line><span class=cl>role.rbac.authorization.k8s.io/pod-lister created
</span></span><span class=line><span class=cl>role.rbac.authorization.k8s.io/controller created
</span></span><span class=line><span class=cl>clusterrolebinding.rbac.authorization.k8s.io/metallb-system:controller created
</span></span><span class=line><span class=cl>clusterrolebinding.rbac.authorization.k8s.io/metallb-system:speaker created
</span></span><span class=line><span class=cl>rolebinding.rbac.authorization.k8s.io/config-watcher created
</span></span><span class=line><span class=cl>rolebinding.rbac.authorization.k8s.io/pod-lister created
</span></span><span class=line><span class=cl>rolebinding.rbac.authorization.k8s.io/controller created
</span></span><span class=line><span class=cl>daemonset.apps/speaker created
</span></span><span class=line><span class=cl>deployment.apps/controller created
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl get events -n metallb-system
</span></span><span class=line><span class=cl>LAST SEEN   TYPE     REASON              OBJECT                             MESSAGE
</span></span><span class=line><span class=cl>70s         Normal   Scheduled           pod/controller-868bf4c94d-dtnmn    Successfully assigned metallb-system/controller-868bf4c94d-dtnmn to kates-node-02
</span></span><span class=line><span class=cl>70s         Normal   Pulling             pod/controller-868bf4c94d-dtnmn    Pulling image <span class=s2>&#34;quay.io/metallb/controller:v0.12.1&#34;</span>
</span></span><span class=line><span class=cl>52s         Normal   Pulled              pod/controller-868bf4c94d-dtnmn    Successfully pulled image <span class=s2>&#34;quay.io/metallb/controller:v0.12.1&#34;</span> in 17.316467325s
</span></span><span class=line><span class=cl>52s         Normal   Created             pod/controller-868bf4c94d-dtnmn    Created container controller
</span></span><span class=line><span class=cl>52s         Normal   Started             pod/controller-868bf4c94d-dtnmn    Started container controller
</span></span><span class=line><span class=cl>70s         Normal   SuccessfulCreate    replicaset/controller-868bf4c94d   Created pod: controller-868bf4c94d-dtnmn
</span></span><span class=line><span class=cl>70s         Normal   ScalingReplicaSet   deployment/controller              Scaled up replica <span class=nb>set</span> controller-868bf4c94d to <span class=m>1</span>
</span></span><span class=line><span class=cl>70s         Normal   Scheduled           pod/speaker-hb6ms                  Successfully assigned metallb-system/speaker-hb6ms to kates-node-02
</span></span><span class=line><span class=cl>70s         Normal   Pulling             pod/speaker-hb6ms                  Pulling image <span class=s2>&#34;quay.io/metallb/speaker:v0.12.1&#34;</span>
</span></span><span class=line><span class=cl>60s         Normal   Pulled              pod/speaker-hb6ms                  Successfully pulled image <span class=s2>&#34;quay.io/metallb/speaker:v0.12.1&#34;</span> in 9.820655993s
</span></span><span class=line><span class=cl>60s         Normal   Created             pod/speaker-hb6ms                  Created container speaker
</span></span><span class=line><span class=cl>60s         Normal   Started             pod/speaker-hb6ms                  Started container speaker
</span></span><span class=line><span class=cl>70s         Normal   Scheduled           pod/speaker-j5gpn                  Successfully assigned metallb-system/speaker-j5gpn to kates-node-01
</span></span><span class=line><span class=cl>70s         Normal   Pulling             pod/speaker-j5gpn                  Pulling image <span class=s2>&#34;quay.io/metallb/speaker:v0.12.1&#34;</span>
</span></span><span class=line><span class=cl>59s         Normal   Pulled              pod/speaker-j5gpn                  Successfully pulled image <span class=s2>&#34;quay.io/metallb/speaker:v0.12.1&#34;</span> in 10.835647902s
</span></span><span class=line><span class=cl>59s         Normal   Created             pod/speaker-j5gpn                  Created container speaker
</span></span><span class=line><span class=cl>59s         Normal   Started             pod/speaker-j5gpn                  Started container speaker
</span></span><span class=line><span class=cl>70s         Normal   Scheduled           pod/speaker-z9qqw                  Successfully assigned metallb-system/speaker-z9qqw to kates-control
</span></span><span class=line><span class=cl>70s         Normal   Pulling             pod/speaker-z9qqw                  Pulling image <span class=s2>&#34;quay.io/metallb/speaker:v0.12.1&#34;</span>
</span></span><span class=line><span class=cl>59s         Normal   Pulled              pod/speaker-z9qqw                  Successfully pulled image <span class=s2>&#34;quay.io/metallb/speaker:v0.12.1&#34;</span> in 11.068649905s
</span></span><span class=line><span class=cl>59s         Normal   Created             pod/speaker-z9qqw                  Created container speaker
</span></span><span class=line><span class=cl>59s         Normal   Started             pod/speaker-z9qqw                  Started container speaker
</span></span><span class=line><span class=cl>70s         Normal   SuccessfulCreate    daemonset/speaker                  Created pod: speaker-z9qqw
</span></span><span class=line><span class=cl>70s         Normal   SuccessfulCreate    daemonset/speaker                  Created pod: speaker-j5gpn
</span></span><span class=line><span class=cl>70s         Normal   SuccessfulCreate    daemonset/speaker                  Created pod: speaker-hb6ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl get all -n metallb-system
</span></span><span class=line><span class=cl>NAME                              READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>pod/controller-868bf4c94d-qllcz   1/1     Running   <span class=m>0</span>          39s
</span></span><span class=line><span class=cl>pod/speaker-2dpxw                 1/1     Running   <span class=m>0</span>          39s
</span></span><span class=line><span class=cl>pod/speaker-5qgm9                 1/1     Running   <span class=m>0</span>          39s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                     DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE
</span></span><span class=line><span class=cl>daemonset.apps/speaker   <span class=m>2</span>         <span class=m>2</span>         <span class=m>2</span>       <span class=m>2</span>            <span class=m>2</span>           kubernetes.io/os<span class=o>=</span>linux   39s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                         READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span class=line><span class=cl>deployment.apps/controller   1/1     <span class=m>1</span>            <span class=m>1</span>           39s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                                    DESIRED   CURRENT   READY   AGE
</span></span><span class=line><span class=cl>replicaset.apps/controller-868bf4c94d   <span class=m>1</span>         <span class=m>1</span>         <span class=m>1</span>       39s</span></span></code></pre></div><p>Finally we need a configmap with an ip range to assign addresses from out local network.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ cat &gt; ./metallb-configmap.yaml <span class=s>&lt;&lt; EOF
</span></span></span><span class=line><span class=cl><span class=s>&gt; apiVersion: v1
</span></span></span><span class=line><span class=cl><span class=s>&gt; kind: ConfigMap
</span></span></span><span class=line><span class=cl><span class=s>&gt; metadata:
</span></span></span><span class=line><span class=cl><span class=s>&gt;   namespace: metallb-system
</span></span></span><span class=line><span class=cl><span class=s>&gt;   name: config
</span></span></span><span class=line><span class=cl><span class=s>&gt; data:
</span></span></span><span class=line><span class=cl><span class=s>&gt;   config: |
</span></span></span><span class=line><span class=cl><span class=s>&gt;    address-pools:
</span></span></span><span class=line><span class=cl><span class=s>&gt;     - name: default
</span></span></span><span class=line><span class=cl><span class=s>&gt;       protocol: layer2
</span></span></span><span class=line><span class=cl><span class=s>&gt;       addresses:
</span></span></span><span class=line><span class=cl><span class=s>&gt;       - 192.168.1.50 - 192.168.1.99
</span></span></span><span class=line><span class=cl><span class=s>&gt;
</span></span></span><span class=line><span class=cl><span class=s>&gt; EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl apply -f metallb-configmap.yaml
</span></span><span class=line><span class=cl>configmap/config created
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl get cm -n metallb-system
</span></span><span class=line><span class=cl>NAME               DATA   AGE
</span></span><span class=line><span class=cl>config             <span class=m>1</span>      13s
</span></span><span class=line><span class=cl>kube-root-ca.crt   <span class=m>1</span>      4m16s</span></span></code></pre></div><hr><h3 class=heading-element id=use-kne-to-create-a-basic-topology><span>Use KNE to create a basic topology</span>
<a href=#use-kne-to-create-a-basic-topology class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><hr><p>Okay now! Let pick a simple sample lab with two linux nodes and spin it up.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ kne_cli create kne/examples/2node-host.pb.txt
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> /home/ubuntu/kne/examples
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating manager <span class=k>for</span>: 2node-host
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Trying in-cluster configuration
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Falling back to kubeconfig: <span class=s2>&#34;/home/ubuntu/.kube/config&#34;</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Topology:
</span></span><span class=line><span class=cl>name: <span class=s2>&#34;2node-host&#34;</span>
</span></span><span class=line><span class=cl>nodes: &lt;
</span></span><span class=line><span class=cl>  name: <span class=s2>&#34;vm-1&#34;</span>
</span></span><span class=line><span class=cl>  type: HOST
</span></span><span class=line><span class=cl>  config: &lt;
</span></span><span class=line><span class=cl>    image: <span class=s2>&#34;hfam/ubuntu:latest&#34;</span>
</span></span><span class=line><span class=cl>  &gt;
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>nodes: &lt;
</span></span><span class=line><span class=cl>  name: <span class=s2>&#34;vm-2&#34;</span>
</span></span><span class=line><span class=cl>  type: HOST
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>links: &lt;
</span></span><span class=line><span class=cl>  a_node: <span class=s2>&#34;vm-1&#34;</span>
</span></span><span class=line><span class=cl>  a_int: <span class=s2>&#34;eth1&#34;</span>
</span></span><span class=line><span class=cl>  z_node: <span class=s2>&#34;vm-2&#34;</span>
</span></span><span class=line><span class=cl>  z_int: <span class=s2>&#34;eth1&#34;</span>
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Link: vm-1:eth1 vm-2:eth1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Node: vm-1:UNKNOWN:HOST
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Node: vm-2:UNKNOWN:HOST
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating namespace <span class=k>for</span> topology: <span class=s2>&#34;2node-host&#34;</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Server Namespace: <span class=p>&amp;</span>Namespace<span class=o>{</span>ObjectMeta:<span class=o>{</span>2node-host    13677a1e-f4fc-42cc-bee8-4484107facb6 <span class=m>139020</span> <span class=m>0</span> 2022-06-01 13:29:27 +0000 UTC &lt;nil&gt; &lt;nil&gt; map<span class=o>[</span>kubernetes.io/metadata.name:2node-host<span class=o>]</span> map<span class=o>[]</span> <span class=o>[]</span> <span class=o>[]</span>  <span class=o>[{</span>kne_cli Update v1 2022-06-01 13:29:27 +0000 UTC FieldsV1 <span class=o>{</span><span class=s2>&#34;f:metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:kubernetes.io/metadata.name&#34;</span>:<span class=o>{}}}}</span> <span class=o>}]}</span>,Spec:NamespaceSpec<span class=o>{</span>Finalizers:<span class=o>[</span>kubernetes<span class=o>]</span>,<span class=o>}</span>,Status:NamespaceStatus<span class=o>{</span>Phase:Active,Conditions:<span class=o>[]</span>NamespaceCondition<span class=o>{}</span>,<span class=o>}</span>,<span class=o>}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> namespace 2node-host
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> node vm-1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> node vm-2
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating topology <span class=k>for</span> meshnet node vm-2
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Meshnet Node:
</span></span><span class=line><span class=cl><span class=p>&amp;</span><span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name:vm-2 GenerateName: Namespace:2node-host SelfLink: UID:b6de0742-35e3-478b-8c40-e7b6f59dc8bf ResourceVersion:139023 Generation:1 CreationTimestamp:2022-06-01 13:29:27 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ZZZ_DeprecatedClusterName: ManagedFields:<span class=o>[{</span>Manager:kne_cli Operation:Update APIVersion:networkop.co.uk/v1beta1 Time:2022-06-01 13:29:27 +0000 UTC FieldsType:FieldsV1 FieldsV1:<span class=o>{</span><span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:links&#34;</span>:<span class=o>{}}}</span> Subresource:<span class=o>}]}</span> Status:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name: GenerateName: Namespace: SelfLink: UID: ResourceVersion: Generation:0 CreationTimestamp:0001-01-01 00:00:00 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ZZZ_DeprecatedClusterName: ManagedFields:<span class=o>[]}</span> Skipped:<span class=o>[]</span> SrcIp: NetNs:<span class=o>}</span> Spec:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> Links:<span class=o>[{</span>LocalIntf:eth1 LocalIP: PeerIntf:eth1 PeerIP: PeerPod:vm-1 UID:0<span class=o>}]}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating topology <span class=k>for</span> meshnet node vm-1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Meshnet Node:
</span></span><span class=line><span class=cl><span class=p>&amp;</span><span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name:vm-1 GenerateName: Namespace:2node-host SelfLink: UID:140df03a-15a1-44fe-a57f-47d464f8b9fc ResourceVersion:139024 Generation:1 CreationTimestamp:2022-06-01 13:29:27 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ZZZ_DeprecatedClusterName: ManagedFields:<span class=o>[{</span>Manager:kne_cli Operation:Update APIVersion:networkop.co.uk/v1beta1 Time:2022-06-01 13:29:27 +0000 UTC FieldsType:FieldsV1 FieldsV1:<span class=o>{</span><span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:links&#34;</span>:<span class=o>{}}}</span> Subresource:<span class=o>}]}</span> Status:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name: GenerateName: Namespace: SelfLink: UID: ResourceVersion: Generation:0 CreationTimestamp:0001-01-01 00:00:00 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ZZZ_DeprecatedClusterName: ManagedFields:<span class=o>[]}</span> Skipped:<span class=o>[]</span> SrcIp: NetNs:<span class=o>}</span> Spec:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> Links:<span class=o>[{</span>LocalIntf:eth1 LocalIP: PeerIntf:eth1 PeerIP: PeerPod:vm-2 UID:0<span class=o>}]}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating Node Pods
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating Pod:
</span></span><span class=line><span class=cl> name:<span class=s2>&#34;vm-1&#34;</span>  type:HOST  config:<span class=o>{</span>command:<span class=s2>&#34;/bin/sh&#34;</span>  command:<span class=s2>&#34;-c&#34;</span>  command:<span class=s2>&#34;sleep 2000000000000&#34;</span>  image:<span class=s2>&#34;hfam/ubuntu:latest&#34;</span>  entry_command:<span class=s2>&#34;kubectl exec -it vm-1 -- sh&#34;</span>  config_path:<span class=s2>&#34;/etc&#34;</span>  config_file:<span class=s2>&#34;config&#34;</span><span class=o>}</span>  interfaces:<span class=o>{</span>key:<span class=s2>&#34;eth1&#34;</span>  value:<span class=o>{</span>int_name:<span class=s2>&#34;eth1&#34;</span>  peer_name:<span class=s2>&#34;vm-2&#34;</span>  peer_int_name:<span class=s2>&#34;eth1&#34;</span><span class=o>}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> no services found
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Node <span class=s2>&#34;vm-1&#34;</span> resource created
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating Pod:
</span></span><span class=line><span class=cl> name:<span class=s2>&#34;vm-2&#34;</span>  type:HOST  config:<span class=o>{</span>command:<span class=s2>&#34;/bin/sh&#34;</span>  command:<span class=s2>&#34;-c&#34;</span>  command:<span class=s2>&#34;sleep 2000000000000&#34;</span>  image:<span class=s2>&#34;alpine:latest&#34;</span>  entry_command:<span class=s2>&#34;kubectl exec -it vm-2 -- sh&#34;</span>  config_path:<span class=s2>&#34;/etc&#34;</span>  config_file:<span class=s2>&#34;config&#34;</span><span class=o>}</span>  interfaces:<span class=o>{</span>key:<span class=s2>&#34;eth1&#34;</span>  value:<span class=o>{</span>int_name:<span class=s2>&#34;eth1&#34;</span>  peer_name:<span class=s2>&#34;vm-1&#34;</span>  peer_int_name:<span class=s2>&#34;eth1&#34;</span><span class=o>}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> no services found
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Node <span class=s2>&#34;vm-2&#34;</span> resource created
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0003<span class=o>]</span> Node <span class=s2>&#34;vm-1&#34;</span>: Status RUNNING
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0003<span class=o>]</span> Node <span class=s2>&#34;vm-2&#34;</span>: Status RUNNING
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0003<span class=o>]</span> Topology <span class=s2>&#34;2node-host&#34;</span> created
</span></span><span class=line><span class=cl>Error: failed to check resource kne/examples/2node-host.pb.txt: could not get services <span class=k>for</span> node vm-1: services <span class=s2>&#34;service-vm-1&#34;</span> not found
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$</span></span></code></pre></div><p>Let&rsquo;s look in k8s</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl get all -n 2node-host -owide
</span></span><span class=line><span class=cl>NAME       READY   STATUS    RESTARTS   AGE   IP               NODE            NOMINATED NODE   READINESS GATES
</span></span><span class=line><span class=cl>pod/vm-1   1/1     Running   <span class=m>0</span>          55s   10.244.115.196   kates-node-01   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>pod/vm-2   1/1     Running   <span class=m>0</span>          55s   10.244.209.195   kates-node-02   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Attach to the 1st device</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl <span class=nb>exec</span> -n 2node-host -it  pod/vm-1 -- bash
</span></span><span class=line><span class=cl>Defaulted container <span class=s2>&#34;vm-1&#34;</span> out of: vm-1, init-vm-1 <span class=o>(</span>init<span class=o>)</span>
</span></span><span class=line><span class=cl>root@vm-1:/#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@vm-1:/# ip link
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue state UNKNOWN mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>3: eth0@if26: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1450</span> qdisc noqueue state UP mode DEFAULT group default
</span></span><span class=line><span class=cl>    link/ether d6:75:2e:b9:44:e1 brd ff:ff:ff:ff:ff:ff link-netnsid <span class=m>0</span>
</span></span><span class=line><span class=cl>27: eth1@if27: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1450</span> qdisc noqueue state UNKNOWN mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether 5e:02:2b:e4:66:b2 brd ff:ff:ff:ff:ff:ff link-netnsid <span class=m>0</span>
</span></span><span class=line><span class=cl>root@vm-1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Configure an IP address on the adapter connected to the 2nd device</span>
</span></span><span class=line><span class=cl>root@vm-1:/# ip add add 10.1.1.1/30 dev eth1
</span></span><span class=line><span class=cl>root@vm-1:/# <span class=nb>exit</span>
</span></span><span class=line><span class=cl><span class=nb>exit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Attach to the 2nd device, do the same and verify that the ping is successful</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl <span class=nb>exec</span> -n 2node-host -it  pod/vm-2 -- sh
</span></span><span class=line><span class=cl>Defaulted container <span class=s2>&#34;vm-2&#34;</span> out of: vm-2, init-vm-2 <span class=o>(</span>init<span class=o>)</span>
</span></span><span class=line><span class=cl>/ <span class=c1>#</span>
</span></span><span class=line><span class=cl>/ <span class=c1># ip link</span>
</span></span><span class=line><span class=cl>/ <span class=c1># ip add add 10.1.1.2/30 dev eth1</span>
</span></span><span class=line><span class=cl>/ <span class=c1># ping 10.1.1.1</span>
</span></span><span class=line><span class=cl>PING 10.1.1.1 <span class=o>(</span>10.1.1.1<span class=o>)</span>: <span class=m>56</span> data bytes
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>seq</span><span class=o>=</span><span class=m>0</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>3.370 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>1.082 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.844 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>1.001 ms
</span></span><span class=line><span class=cl>^C
</span></span><span class=line><span class=cl>--- 10.1.1.1 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>4</span> packets transmitted, <span class=m>4</span> packets received, 0% packet loss
</span></span><span class=line><span class=cl>round-trip min/avg/max <span class=o>=</span> 0.844/1.574/3.370 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># We are learning the MAC of the peer device</span>
</span></span><span class=line><span class=cl>/ <span class=c1># ip nei</span>
</span></span><span class=line><span class=cl>10.1.1.1 dev eth1 lladdr 5e:02:2b:e4:66:b2 ref <span class=m>1</span> used 0/0/0 probes <span class=m>4</span> REACHABLE</span></span></code></pre></div><p>Seems working, right? &#x1f604;</p><hr><h3 class=heading-element id=test-nokia-srlinux><span>Test Nokia srlinux</span>
<a href=#test-nokia-srlinux class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><hr><p>In order to use the srlinux container we need to have the srlinux controller installed in k8s.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl apply -k https://github.com/srl-labs/srl-controller/config/default
</span></span><span class=line><span class=cl>namespace/srlinux-controller created
</span></span><span class=line><span class=cl>customresourcedefinition.apiextensions.k8s.io/srlinuxes.kne.srlinux.dev created
</span></span><span class=line><span class=cl>serviceaccount/srlinux-controller-controller-manager created
</span></span><span class=line><span class=cl>role.rbac.authorization.k8s.io/srlinux-controller-leader-election-role created
</span></span><span class=line><span class=cl>clusterrole.rbac.authorization.k8s.io/srlinux-controller-manager-role created
</span></span><span class=line><span class=cl>clusterrole.rbac.authorization.k8s.io/srlinux-controller-metrics-reader created
</span></span><span class=line><span class=cl>clusterrole.rbac.authorization.k8s.io/srlinux-controller-proxy-role created
</span></span><span class=line><span class=cl>rolebinding.rbac.authorization.k8s.io/srlinux-controller-leader-election-rolebinding created
</span></span><span class=line><span class=cl>clusterrolebinding.rbac.authorization.k8s.io/srlinux-controller-manager-rolebinding created
</span></span><span class=line><span class=cl>clusterrolebinding.rbac.authorization.k8s.io/srlinux-controller-proxy-rolebinding created
</span></span><span class=line><span class=cl>configmap/srlinux-controller-manager-config created
</span></span><span class=line><span class=cl>service/srlinux-controller-controller-manager-metrics-service created
</span></span><span class=line><span class=cl>deployment.apps/srlinux-controller-controller-manager created
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl get all -n srlinux-controller
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                                                         READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>pod/srlinux-controller-controller-manager-69f6579c6f-skg2j   2/2     Running   <span class=m>0</span>          40s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                                                            TYPE        CLUSTER-IP       EXTERNAL-IP   PORT<span class=o>(</span>S<span class=o>)</span>    AGE
</span></span><span class=line><span class=cl>service/srlinux-controller-controller-manager-metrics-service   ClusterIP   10.100.185.117   &lt;none&gt;        8443/TCP   40s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                                                    READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span class=line><span class=cl>deployment.apps/srlinux-controller-controller-manager   1/1     <span class=m>1</span>            <span class=m>1</span>           40s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                                                               DESIRED   CURRENT   READY   AGE
</span></span><span class=line><span class=cl>replicaset.apps/srlinux-controller-controller-manager-69f6579c6f   <span class=m>1</span>         <span class=m>1</span>         <span class=m>1</span>       40s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl get events -n srlinux-controller
</span></span><span class=line><span class=cl>LAST SEEN   TYPE     REASON              OBJECT                                                        MESSAGE
</span></span><span class=line><span class=cl>49s         Normal   LeaderElection      configmap/8bce046c.srlinux.dev                                srlinux-controller-controller-manager-69f6579c6f-skg2j_9e9d41e6-e29c-4abd-849f-39fd019eca72 became leader
</span></span><span class=line><span class=cl>49s         Normal   LeaderElection      lease/8bce046c.srlinux.dev                                    srlinux-controller-controller-manager-69f6579c6f-skg2j_9e9d41e6-e29c-4abd-849f-39fd019eca72 became leader
</span></span><span class=line><span class=cl>62s         Normal   Scheduled           pod/srlinux-controller-controller-manager-69f6579c6f-skg2j    Successfully assigned srlinux-controller/srlinux-controller-controller-manager-69f6579c6f-skg2j to kates-node-02
</span></span><span class=line><span class=cl>61s         Normal   Pulling             pod/srlinux-controller-controller-manager-69f6579c6f-skg2j    Pulling image <span class=s2>&#34;gcr.io/kubebuilder/kube-rbac-proxy:v0.8.0&#34;</span>
</span></span><span class=line><span class=cl>57s         Normal   Pulled              pod/srlinux-controller-controller-manager-69f6579c6f-skg2j    Successfully pulled image <span class=s2>&#34;gcr.io/kubebuilder/kube-rbac-proxy:v0.8.0&#34;</span> in 4.485800395s
</span></span><span class=line><span class=cl>57s         Normal   Created             pod/srlinux-controller-controller-manager-69f6579c6f-skg2j    Created container kube-rbac-proxy
</span></span><span class=line><span class=cl>57s         Normal   Started             pod/srlinux-controller-controller-manager-69f6579c6f-skg2j    Started container kube-rbac-proxy
</span></span><span class=line><span class=cl>57s         Normal   Pulling             pod/srlinux-controller-controller-manager-69f6579c6f-skg2j    Pulling image <span class=s2>&#34;ghcr.io/srl-labs/srl-controller:0.3.1&#34;</span>
</span></span><span class=line><span class=cl>53s         Normal   Pulled              pod/srlinux-controller-controller-manager-69f6579c6f-skg2j    Successfully pulled image <span class=s2>&#34;ghcr.io/srl-labs/srl-controller:0.3.1&#34;</span> in 4.313788546s
</span></span><span class=line><span class=cl>52s         Normal   Created             pod/srlinux-controller-controller-manager-69f6579c6f-skg2j    Created container manager
</span></span><span class=line><span class=cl>52s         Normal   Started             pod/srlinux-controller-controller-manager-69f6579c6f-skg2j    Started container manager
</span></span><span class=line><span class=cl>62s         Normal   SuccessfulCreate    replicaset/srlinux-controller-controller-manager-69f6579c6f   Created pod: srlinux-controller-controller-manager-69f6579c6f-skg2j
</span></span><span class=line><span class=cl>62s         Normal   ScalingReplicaSet   deployment/srlinux-controller-controller-manager              Scaled up replica <span class=nb>set</span> srlinux-controller-controller-manager-69f6579c6f to <span class=m>1</span></span></span></code></pre></div><p>Deploy a sample topology using KNEs sample topologies files.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ cat kne/examples/srlinux/2node-srl-with-cert.pbtxt
</span></span><span class=line><span class=cl>name: <span class=s2>&#34;2srl-certs&#34;</span>
</span></span><span class=line><span class=cl>nodes: <span class=o>{</span>
</span></span><span class=line><span class=cl>    name: <span class=s2>&#34;r1&#34;</span>
</span></span><span class=line><span class=cl>    type: NOKIA_SRL
</span></span><span class=line><span class=cl>    config: <span class=o>{</span>
</span></span><span class=line><span class=cl>        cert: <span class=o>{</span>
</span></span><span class=line><span class=cl>            self_signed: <span class=o>{</span>
</span></span><span class=line><span class=cl>                cert_name: <span class=s2>&#34;kne-profile&#34;</span>,
</span></span><span class=line><span class=cl>                key_name: <span class=s2>&#34;N/A&#34;</span>,
</span></span><span class=line><span class=cl>                key_size: 4096,
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    services:<span class=o>{</span>
</span></span><span class=line><span class=cl>        key: <span class=m>22</span>
</span></span><span class=line><span class=cl>        value: <span class=o>{</span>
</span></span><span class=line><span class=cl>            name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>            inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    services:<span class=o>{</span>
</span></span><span class=line><span class=cl>        key: <span class=m>57400</span>
</span></span><span class=line><span class=cl>        value: <span class=o>{</span>
</span></span><span class=line><span class=cl>            name: <span class=s2>&#34;gnmi&#34;</span>
</span></span><span class=line><span class=cl>            inside: <span class=m>57400</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>nodes: <span class=o>{</span>
</span></span><span class=line><span class=cl>    name: <span class=s2>&#34;r2&#34;</span>
</span></span><span class=line><span class=cl>    type: NOKIA_SRL
</span></span><span class=line><span class=cl>    config: <span class=o>{</span>
</span></span><span class=line><span class=cl>        cert: <span class=o>{</span>
</span></span><span class=line><span class=cl>            self_signed: <span class=o>{</span>
</span></span><span class=line><span class=cl>                cert_name: <span class=s2>&#34;kne-profile&#34;</span>,
</span></span><span class=line><span class=cl>                key_name: <span class=s2>&#34;N/A&#34;</span>,
</span></span><span class=line><span class=cl>                key_size: 4096,
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    services:<span class=o>{</span>
</span></span><span class=line><span class=cl>        key: <span class=m>22</span>
</span></span><span class=line><span class=cl>        value: <span class=o>{</span>
</span></span><span class=line><span class=cl>            name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>            inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>links: <span class=o>{</span>
</span></span><span class=line><span class=cl>    a_node: <span class=s2>&#34;r1&#34;</span>
</span></span><span class=line><span class=cl>    a_int: <span class=s2>&#34;e1-1&#34;</span>
</span></span><span class=line><span class=cl>    z_node: <span class=s2>&#34;r2&#34;</span>
</span></span><span class=line><span class=cl>    z_int: <span class=s2>&#34;e1-1&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div><p>Create the topology with 2 SR linux devices.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ kne_cli create kne/examples/srlinux/2node-srl-with-cert.pbtxt
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> /home/ubuntu/kne/examples/srlinux
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating manager <span class=k>for</span>: 2srl-certs
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Trying in-cluster configuration
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Falling back to kubeconfig: <span class=s2>&#34;/home/ubuntu/.kube/config&#34;</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Topology:
</span></span><span class=line><span class=cl>name: <span class=s2>&#34;2srl-certs&#34;</span>
</span></span><span class=line><span class=cl>nodes: &lt;
</span></span><span class=line><span class=cl>  name: <span class=s2>&#34;r1&#34;</span>
</span></span><span class=line><span class=cl>  type: NOKIA_SRL
</span></span><span class=line><span class=cl>  config: &lt;
</span></span><span class=line><span class=cl>    cert: &lt;
</span></span><span class=line><span class=cl>      self_signed: &lt;
</span></span><span class=line><span class=cl>        cert_name: <span class=s2>&#34;kne-profile&#34;</span>
</span></span><span class=line><span class=cl>        key_name: <span class=s2>&#34;N/A&#34;</span>
</span></span><span class=line><span class=cl>        key_size: <span class=m>4096</span>
</span></span><span class=line><span class=cl>      &gt;
</span></span><span class=line><span class=cl>    &gt;
</span></span><span class=line><span class=cl>  &gt;
</span></span><span class=line><span class=cl>  services: &lt;
</span></span><span class=line><span class=cl>    key: <span class=m>22</span>
</span></span><span class=line><span class=cl>    value: &lt;
</span></span><span class=line><span class=cl>      name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>      inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>    &gt;
</span></span><span class=line><span class=cl>  &gt;
</span></span><span class=line><span class=cl>  services: &lt;
</span></span><span class=line><span class=cl>    key: <span class=m>57400</span>
</span></span><span class=line><span class=cl>    value: &lt;
</span></span><span class=line><span class=cl>      name: <span class=s2>&#34;gnmi&#34;</span>
</span></span><span class=line><span class=cl>      inside: <span class=m>57400</span>
</span></span><span class=line><span class=cl>    &gt;
</span></span><span class=line><span class=cl>  &gt;
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>nodes: &lt;
</span></span><span class=line><span class=cl>  name: <span class=s2>&#34;r2&#34;</span>
</span></span><span class=line><span class=cl>  type: NOKIA_SRL
</span></span><span class=line><span class=cl>  config: &lt;
</span></span><span class=line><span class=cl>    cert: &lt;
</span></span><span class=line><span class=cl>      self_signed: &lt;
</span></span><span class=line><span class=cl>        cert_name: <span class=s2>&#34;kne-profile&#34;</span>
</span></span><span class=line><span class=cl>        key_name: <span class=s2>&#34;N/A&#34;</span>
</span></span><span class=line><span class=cl>        key_size: <span class=m>4096</span>
</span></span><span class=line><span class=cl>      &gt;
</span></span><span class=line><span class=cl>    &gt;
</span></span><span class=line><span class=cl>  &gt;
</span></span><span class=line><span class=cl>  services: &lt;
</span></span><span class=line><span class=cl>    key: <span class=m>22</span>
</span></span><span class=line><span class=cl>    value: &lt;
</span></span><span class=line><span class=cl>      name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>      inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>    &gt;
</span></span><span class=line><span class=cl>  &gt;
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>links: &lt;
</span></span><span class=line><span class=cl>  a_node: <span class=s2>&#34;r1&#34;</span>
</span></span><span class=line><span class=cl>  a_int: <span class=s2>&#34;e1-1&#34;</span>
</span></span><span class=line><span class=cl>  z_node: <span class=s2>&#34;r2&#34;</span>
</span></span><span class=line><span class=cl>  z_int: <span class=s2>&#34;e1-1&#34;</span>
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Link: r1:e1-1 r2:e1-1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Node: r1:UNKNOWN:NOKIA_SRL
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Node: r2:UNKNOWN:NOKIA_SRL
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating namespace <span class=k>for</span> topology: <span class=s2>&#34;2srl-certs&#34;</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Server Namespace: <span class=p>&amp;</span>Namespace<span class=o>{</span>ObjectMeta:<span class=o>{</span>2srl-certs    3dbfff65-53fe-430a-b4a5-1d8f364b598c <span class=m>9092</span> <span class=m>0</span> 2022-06-03 21:30:30 +0000 UTC &lt;nil&gt; &lt;nil&gt; map<span class=o>[</span>kubernetes.io/metadata.name:2srl-certs<span class=o>]</span> map<span class=o>[]</span> <span class=o>[]</span> <span class=o>[]</span>  <span class=o>[{</span>kne_cli Update v1 2022-06-03 21:30:30 +0000 UTC FieldsV1 <span class=o>{</span><span class=s2>&#34;f:metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:kubernetes.io/metadata.name&#34;</span>:<span class=o>{}}}}}]}</span>,Spec:NamespaceSpec<span class=o>{</span>Finalizers:<span class=o>[</span>kubernetes<span class=o>]</span>,<span class=o>}</span>,Status:NamespaceStatus<span class=o>{</span>Phase:Active,Conditions:<span class=o>[]</span>NamespaceCondition<span class=o>{}</span>,<span class=o>}</span>,<span class=o>}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> namespace 2srl-certs
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> node r1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> node r2
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating topology <span class=k>for</span> meshnet node r2
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Meshnet Node:
</span></span><span class=line><span class=cl><span class=p>&amp;</span><span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name:r2 GenerateName: Namespace:2srl-certs SelfLink: UID:45c4a20d-a803-491d-8a78-9a75603e3f1a ResourceVersion:9095 Generation:1 CreationTimestamp:2022-06-03 21:30:30 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[{</span>Manager:kne_cli Operation:Update APIVersion:networkop.co.uk/v1beta1 Time:2022-06-03 21:30:30 +0000 UTC FieldsType:FieldsV1 FieldsV1:<span class=o>{</span><span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:links&#34;</span>:<span class=o>{}}}}]}</span> Status:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name: GenerateName: Namespace: SelfLink: UID: ResourceVersion: Generation:0 CreationTimestamp:0001-01-01 00:00:00 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[]}</span> Skipped:<span class=o>[]</span> SrcIp: NetNs:<span class=o>}</span> Spec:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> Links:<span class=o>[{</span>LocalIntf:e1-1 LocalIP: PeerIntf:e1-1 PeerIP: PeerPod:r1 UID:0<span class=o>}]}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating topology <span class=k>for</span> meshnet node r1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Meshnet Node:
</span></span><span class=line><span class=cl><span class=p>&amp;</span><span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name:r1 GenerateName: Namespace:2srl-certs SelfLink: UID:bda477bd-f318-4a3d-ba2a-a7688c60716b ResourceVersion:9096 Generation:1 CreationTimestamp:2022-06-03 21:30:30 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[{</span>Manager:kne_cli Operation:Update APIVersion:networkop.co.uk/v1beta1 Time:2022-06-03 21:30:30 +0000 UTC FieldsType:FieldsV1 FieldsV1:<span class=o>{</span><span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:links&#34;</span>:<span class=o>{}}}}]}</span> Status:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name: GenerateName: Namespace: SelfLink: UID: ResourceVersion: Generation:0 CreationTimestamp:0001-01-01 00:00:00 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[]}</span> Skipped:<span class=o>[]</span> SrcIp: NetNs:<span class=o>}</span> Spec:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> Links:<span class=o>[{</span>LocalIntf:e1-1 LocalIP: PeerIntf:e1-1 PeerIP: PeerPod:r2 UID:0<span class=o>}]}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating Node Pods
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating Srlinux node resource r1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Created SR Linux node r1 configmap
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Created Srlinux resource: r1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Created Service:
</span></span><span class=line><span class=cl><span class=p>&amp;</span>Service<span class=o>{</span>ObjectMeta:<span class=o>{</span>service-r1  2srl-certs  776a3f25-05bd-483e-9947-2800efa8e796 <span class=m>9111</span> <span class=m>0</span> 2022-06-03 21:30:31 +0000 UTC &lt;nil&gt; &lt;nil&gt; map<span class=o>[</span>pod:r1<span class=o>]</span> map<span class=o>[]</span> <span class=o>[]</span> <span class=o>[]</span>  <span class=o>[{</span>kne_cli Update v1 2022-06-03 21:30:31 +0000 UTC FieldsV1 <span class=o>{</span><span class=s2>&#34;f:metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:pod&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:allocateLoadBalancerNodePorts&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:externalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:internalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:ports&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;k:{\&#34;port\&#34;:22,\&#34;protocol\&#34;:\&#34;TCP\&#34;}&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:name&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:port&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:protocol&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:targetPort&#34;</span>:<span class=o>{}}</span>,<span class=s2>&#34;k:{\&#34;port\&#34;:57400,\&#34;protocol\&#34;:\&#34;TCP\&#34;}&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:name&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:port&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:protocol&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:targetPort&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:selector&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:sessionAffinity&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:type&#34;</span>:<span class=o>{}}}}]}</span>,Spec:ServiceSpec<span class=o>{</span>Ports:<span class=o>[]</span>ServicePort<span class=o>{</span>ServicePort<span class=o>{</span>Name:ssh,Protocol:TCP,Port:22,TargetPort:<span class=o>{</span><span class=m>0</span> <span class=m>22</span> <span class=o>}</span>,NodePort:30742,AppProtocol:nil,<span class=o>}</span>,ServicePort<span class=o>{</span>Name:gnmi,Protocol:TCP,Port:57400,TargetPort:<span class=o>{</span><span class=m>0</span> <span class=m>57400</span> <span class=o>}</span>,NodePort:30637,AppProtocol:nil,<span class=o>}</span>,<span class=o>}</span>,Selector:map<span class=o>[</span>string<span class=o>]</span>string<span class=o>{</span>app: r1,<span class=o>}</span>,ClusterIP:10.103.94.50,Type:LoadBalancer,ExternalIPs:<span class=o>[]</span>,SessionAffinity:None,LoadBalancerIP:,LoadBalancerSourceRanges:<span class=o>[]</span>,ExternalName:,ExternalTrafficPolicy:Cluster,HealthCheckNodePort:0,PublishNotReadyAddresses:false,SessionAffinityConfig:nil,TopologyKeys:<span class=o>[]</span>,IPFamilyPolicy:*SingleStack,ClusterIPs:<span class=o>[</span>10.103.94.50<span class=o>]</span>,IPFamilies:<span class=o>[</span>IPv4<span class=o>]</span>,AllocateLoadBalancerNodePorts:*true,LoadBalancerClass:nil,InternalTrafficPolicy:*Cluster,<span class=o>}</span>,Status:ServiceStatus<span class=o>{</span>LoadBalancer:LoadBalancerStatus<span class=o>{</span>Ingress:<span class=o>[]</span>LoadBalancerIngress<span class=o>{}</span>,<span class=o>}</span>,Conditions:<span class=o>[]</span>Condition<span class=o>{}</span>,<span class=o>}</span>,<span class=o>}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Node <span class=s2>&#34;r1&#34;</span> resource created
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating Srlinux node resource r2
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Created SR Linux node r2 configmap
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Created Srlinux resource: r2
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Created Service:
</span></span><span class=line><span class=cl><span class=p>&amp;</span>Service<span class=o>{</span>ObjectMeta:<span class=o>{</span>service-r2  2srl-certs  09c1e6e0-0c19-4497-b133-d2b2fa22d20d <span class=m>9126</span> <span class=m>0</span> 2022-06-03 21:30:31 +0000 UTC &lt;nil&gt; &lt;nil&gt; map<span class=o>[</span>pod:r2<span class=o>]</span> map<span class=o>[]</span> <span class=o>[]</span> <span class=o>[]</span>  <span class=o>[{</span>kne_cli Update v1 2022-06-03 21:30:31 +0000 UTC FieldsV1 <span class=o>{</span><span class=s2>&#34;f:metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:pod&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:allocateLoadBalancerNodePorts&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:externalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:internalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:ports&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;k:{\&#34;port\&#34;:22,\&#34;protocol\&#34;:\&#34;TCP\&#34;}&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:name&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:port&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:protocol&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:targetPort&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:selector&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:sessionAffinity&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:type&#34;</span>:<span class=o>{}}}}]}</span>,Spec:ServiceSpec<span class=o>{</span>Ports:<span class=o>[]</span>ServicePort<span class=o>{</span>ServicePort<span class=o>{</span>Name:ssh,Protocol:TCP,Port:22,TargetPort:<span class=o>{</span><span class=m>0</span> <span class=m>22</span> <span class=o>}</span>,NodePort:32417,AppProtocol:nil,<span class=o>}</span>,<span class=o>}</span>,Selector:map<span class=o>[</span>string<span class=o>]</span>string<span class=o>{</span>app: r2,<span class=o>}</span>,ClusterIP:10.111.173.232,Type:LoadBalancer,ExternalIPs:<span class=o>[]</span>,SessionAffinity:None,LoadBalancerIP:,LoadBalancerSourceRanges:<span class=o>[]</span>,ExternalName:,ExternalTrafficPolicy:Cluster,HealthCheckNodePort:0,PublishNotReadyAddresses:false,SessionAffinityConfig:nil,TopologyKeys:<span class=o>[]</span>,IPFamilyPolicy:*SingleStack,ClusterIPs:<span class=o>[</span>10.111.173.232<span class=o>]</span>,IPFamilies:<span class=o>[</span>IPv4<span class=o>]</span>,AllocateLoadBalancerNodePorts:*true,LoadBalancerClass:nil,InternalTrafficPolicy:*Cluster,<span class=o>}</span>,Status:ServiceStatus<span class=o>{</span>LoadBalancer:LoadBalancerStatus<span class=o>{</span>Ingress:<span class=o>[]</span>LoadBalancerIngress<span class=o>{}</span>,<span class=o>}</span>,Conditions:<span class=o>[]</span>Condition<span class=o>{}</span>,<span class=o>}</span>,<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Node <span class=s2>&#34;r2&#34;</span> resource created
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> r1 - generating self signed certs
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> r1 - waiting <span class=k>for</span> pod to be running
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0003<span class=o>]</span> r1 - pod running.
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0018<span class=o>]</span> r1 - finshed cert generation
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0018<span class=o>]</span> r2 - generating self signed certs
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0018<span class=o>]</span> r2 - waiting <span class=k>for</span> pod to be running
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0018<span class=o>]</span> r2 - pod running.
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0021<span class=o>]</span> r2 - finshed cert generation
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0022<span class=o>]</span> Node <span class=s2>&#34;r1&#34;</span>: Status RUNNING
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0022<span class=o>]</span> Node <span class=s2>&#34;r2&#34;</span>: Status RUNNING
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0022<span class=o>]</span> Topology <span class=s2>&#34;2srl-certs&#34;</span> created
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0022<span class=o>]</span> Pods:
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0022<span class=o>]</span> r1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0022<span class=o>]</span> r2</span></span></code></pre></div><p>Now, it may take some time for the last command to complete since it is fetching the images as well. Let&rsquo;s check on k8s.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl get all -n 2srl-certs
</span></span><span class=line><span class=cl>NAME     READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>pod/r1   1/1     Running   <span class=m>0</span>          23m
</span></span><span class=line><span class=cl>pod/r2   1/1     Running   <span class=m>0</span>          23m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                 TYPE           CLUSTER-IP       EXTERNAL-IP    PORT<span class=o>(</span>S<span class=o>)</span>                        AGE
</span></span><span class="line hl"><span class=cl>service/service-r1   LoadBalancer   10.103.94.50     192.168.1.50   22:30742/TCP,57400:30637/TCP   23m
</span></span><span class="line hl"><span class=cl>service/service-r2   LoadBalancer   10.111.173.232   192.168.1.51   22:32417/TCP                   23m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl get events  -n 2srl-certs
</span></span><span class=line><span class=cl>LAST SEEN   TYPE     REASON         OBJECT               MESSAGE
</span></span><span class=line><span class=cl>23m         Normal   Scheduled      pod/r1               Successfully assigned 2srl-certs/r1 to kates-node-02
</span></span><span class=line><span class=cl>23m         Normal   Pulled         pod/r1               Container image <span class=s2>&#34;networkop/init-wait:latest&#34;</span> already present on machine
</span></span><span class=line><span class=cl>23m         Normal   Created        pod/r1               Created container init-r1
</span></span><span class=line><span class=cl>23m         Normal   Started        pod/r1               Started container init-r1
</span></span><span class=line><span class=cl>23m         Normal   Pulled         pod/r1               Container image <span class=s2>&#34;ghcr.io/nokia/srlinux:latest&#34;</span> already present on machine
</span></span><span class=line><span class=cl>23m         Normal   Created        pod/r1               Created container r1
</span></span><span class=line><span class=cl>23m         Normal   Started        pod/r1               Started container r1
</span></span><span class=line><span class=cl>23m         Normal   Scheduled      pod/r2               Successfully assigned 2srl-certs/r2 to kates-node-01
</span></span><span class=line><span class=cl>23m         Normal   Pulled         pod/r2               Container image <span class=s2>&#34;networkop/init-wait:latest&#34;</span> already present on machine
</span></span><span class=line><span class=cl>23m         Normal   Created        pod/r2               Created container init-r2
</span></span><span class=line><span class=cl>23m         Normal   Started        pod/r2               Started container init-r2
</span></span><span class=line><span class=cl>23m         Normal   Pulled         pod/r2               Container image <span class=s2>&#34;ghcr.io/nokia/srlinux:latest&#34;</span> already present on machine
</span></span><span class=line><span class=cl>23m         Normal   Created        pod/r2               Created container r2
</span></span><span class=line><span class=cl>23m         Normal   Started        pod/r2               Started container r2
</span></span><span class=line><span class=cl>23m         Normal   IPAllocated    service/service-r1   Assigned IP <span class=o>[</span><span class=s2>&#34;192.168.1.50&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>23m         Normal   nodeAssigned   service/service-r1   announcing from node <span class=s2>&#34;kates-node-01&#34;</span>
</span></span><span class=line><span class=cl>23m         Normal   IPAllocated    service/service-r2   Assigned IP <span class=o>[</span><span class=s2>&#34;192.168.1.51&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>23m         Normal   nodeAssigned   service/service-r2   announcing from node <span class=s2>&#34;kates-node-02&#34;</span></span></span></code></pre></div><p>It looks good. From another terminal you can access the devices via SSH to the service IP assigned (admin:admin are the credentials).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>❯ ssh admin@192.168.1.50
</span></span><span class=line><span class=cl>The authenticity of host <span class=s1>&#39;192.168.1.50 (192.168.1.50)&#39;</span> can<span class=s1>&#39;t be established.
</span></span></span><span class=line><span class=cl><span class=s1>ECDSA key fingerprint is SHA256:cJwi5r4UVEVYEX9IAqrThzCrIQUYRRk3y5i5Lnw5hPE.
</span></span></span><span class=line><span class=cl><span class=s1>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span class=line><span class=cl><span class=s1>Warning: Permanently added &#39;</span>192.168.1.50<span class=s1>&#39; (ECDSA) to the list of known hosts.
</span></span></span><span class=line><span class=cl><span class=s1>admin@192.168.1.50&#39;</span>s password:
</span></span><span class=line><span class=cl>Using configuration file<span class=o>(</span>s<span class=o>)</span>: <span class=o>[</span><span class=s1>&#39;/etc/opt/srlinux/srlinux.rc&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>Welcome to the srlinux CLI.
</span></span><span class=line><span class=cl>Type <span class=s1>&#39;help&#39;</span> <span class=o>(</span>and press &lt;ENTER&gt;<span class=o>)</span> <span class=k>if</span> you need any <span class=nb>help</span> using this.
</span></span><span class=line><span class=cl>--<span class=o>{</span> running <span class=o>}</span>--<span class=o>[</span>  <span class=o>]</span>--
</span></span><span class=line><span class=cl>A:r1#
</span></span><span class=line><span class=cl>A:r1# show interface brief
</span></span><span class=line><span class=cl>+---------------------+---------------+---------------+---------------+---------------+
</span></span><span class=line><span class=cl><span class=p>|</span>        Port         <span class=p>|</span>  Admin State  <span class=p>|</span>  Oper State   <span class=p>|</span>     Speed     <span class=p>|</span>     Type      <span class=p>|</span>
</span></span><span class=line><span class=cl>+<span class=o>=====================</span>+<span class=o>===============</span>+<span class=o>===============</span>+<span class=o>===============</span>+<span class=o>===============</span>+
</span></span><span class=line><span class=cl><span class=p>|</span> mgmt0               <span class=p>|</span> <span class=nb>enable</span>        <span class=p>|</span> down          <span class=p>|</span>               <span class=p>|</span>               <span class=p>|</span>
</span></span><span class=line><span class=cl>+---------------------+---------------+---------------+---------------+---------------+
</span></span><span class=line><span class=cl>--<span class=o>{</span> running <span class=o>}</span>--<span class=o>[</span>  <span class=o>]</span>--
</span></span><span class=line><span class=cl>A:r1#</span></span></code></pre></div><p>Hmmm, something is wrong here. We were supposed to get a bunch of interfaces, instead we got only mgmt0 and it is down.
Let&rsquo;s attach to the device shell and check the interfaces with some pings</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl -n 2srl-certs <span class=nb>exec</span> -it r1 -- bash
</span></span><span class=line><span class=cl>Defaulted container <span class=s2>&#34;r1&#34;</span> out of: r1, init-r1 <span class=o>(</span>init<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@r1 /<span class=o>]</span><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@r1 /<span class=o>]</span><span class=c1># ip link</span>
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue state UNKNOWN mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>3: mgmt0@if6: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1450</span> qdisc noqueue state UP mode DEFAULT group default
</span></span><span class=line><span class=cl>    link/ether 82:98:bc:94:f1:94 brd ff:ff:ff:ff:ff:ff link-netnsid <span class=m>0</span>
</span></span><span class=line><span class=cl>4: gway-2800@if2: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc noqueue state UP mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether be:75:15:da:44:66 brd ff:ff:ff:ff:ff:ff link-netns srbase-mgmt
</span></span><span class=line><span class=cl>7: e1-1@if7: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1450</span> qdisc noqueue state UNKNOWN mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether f6:96:83:ff:1f:db brd ff:ff:ff:ff:ff:ff link-netnsid <span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@r1 /<span class=o>]</span><span class=c1># ip add</span>
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue state UNKNOWN group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>    inet 127.0.0.1/8 scope host lo
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>    inet6 ::1/128 scope host
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>3: mgmt0@if6: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1450</span> qdisc noqueue state UP group default
</span></span><span class=line><span class=cl>    link/ether 82:98:bc:94:f1:94 brd ff:ff:ff:ff:ff:ff link-netnsid <span class=m>0</span>
</span></span><span class=line><span class=cl>    inet 10.244.2.53/24 brd 10.244.2.255 scope global eth0
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>    inet6 fe80::8098:bcff:fe94:f194/64 scope link
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>4: gway-2800@if2: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc noqueue state UP group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether be:75:15:da:44:66 brd ff:ff:ff:ff:ff:ff link-netns srbase-mgmt
</span></span><span class=line><span class=cl>    inet6 fe80::bc75:15ff:feda:4466/64 scope link
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>7: e1-1@if7: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1450</span> qdisc noqueue state UNKNOWN group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether f6:96:83:ff:1f:db brd ff:ff:ff:ff:ff:ff link-netnsid <span class=m>0</span>
</span></span><span class=line><span class=cl>    inet6 fe80::f496:83ff:feff:1fdb/64 scope link
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@r1 /<span class=o>]</span><span class=c1># ip add add 10.1.1.1/30 dev e1-1</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@r1 /<span class=o>]</span><span class=c1># exit</span>
</span></span><span class=line><span class=cl><span class=nb>exit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl -n 2srl-certs <span class=nb>exec</span> -it r2 -- bash
</span></span><span class=line><span class=cl>Defaulted container <span class=s2>&#34;r2&#34;</span> out of: r2, init-r2 <span class=o>(</span>init<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@r2 /<span class=o>]</span><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@r2 /<span class=o>]</span><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@r2 /<span class=o>]</span><span class=c1># ip add add 10.1.1.2/30 dev e1-1</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@r2 /<span class=o>]</span><span class=c1># ping 10.1.1.1</span>
</span></span><span class=line><span class=cl>PING 10.1.1.1 <span class=o>(</span>10.1.1.1<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>1.99 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.804 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.678 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.959 ms
</span></span><span class=line><span class=cl>^C
</span></span><span class=line><span class=cl>--- 10.1.1.1 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>4</span> packets transmitted, <span class=m>4</span> received, 0% packet loss, <span class=nb>time</span> 3052ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 0.678/1.108/1.992/0.520 ms</span></span></code></pre></div><p>Seems PODs are communicating fine, and I guess the issues is with the router itself, or should I say the container &#x1f604;. Let&rsquo;s check some logs.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl -n 2srl-certs describe pod/r1
</span></span><span class=line><span class=cl>&lt; ...omitted...&gt;
</span></span><span class=line><span class=cl>Events:
</span></span><span class=line><span class=cl>  Type    Reason     Age   From               Message
</span></span><span class=line><span class=cl>  ----    ------     ----  ----               -------
</span></span><span class=line><span class=cl>  Normal  Scheduled  36m   default-scheduler  Successfully assigned 2srl-certs/r1 to kates-node-02
</span></span><span class=line><span class=cl>  Normal  Pulled     36m   kubelet            Container image <span class=s2>&#34;networkop/init-wait:latest&#34;</span> already present on machine
</span></span><span class=line><span class=cl>  Normal  Created    36m   kubelet            Created container init-r1
</span></span><span class=line><span class=cl>  Normal  Started    36m   kubelet            Started container init-r1
</span></span><span class=line><span class=cl>  Normal  Pulled     36m   kubelet            Container image <span class=s2>&#34;ghcr.io/nokia/srlinux:latest&#34;</span> already present on machine
</span></span><span class=line><span class=cl>  Normal  Created    36m   kubelet            Created container r1
</span></span><span class=line><span class=cl>  Normal  Started    36m   kubelet            Started container r1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check to see the boot up logs</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl -n 2srl-certs logs r1
</span></span><span class=line><span class=cl>Defaulted container <span class=s2>&#34;r1&#34;</span> out of: r1, init-r1 <span class=o>(</span>init<span class=o>)</span>
</span></span><span class=line><span class=cl>Fri Jun  <span class=m>3</span> 21:30:33 UTC 2022: entrypoint.sh called
</span></span><span class=line><span class=cl>Fri Jun  <span class=m>3</span> 21:30:33 UTC 2022: renaming docker interface eth0 to mgmt0
</span></span><span class=line><span class=cl>Fri Jun  <span class=m>3</span> 21:30:33 UTC 2022: turning off checksum offloading on mgmt0
</span></span><span class=line><span class=cl>Actual changes:
</span></span><span class=line><span class=cl>rx-checksumming: off
</span></span><span class=line><span class=cl>tx-checksumming: off
</span></span><span class=line><span class=cl>        tx-checksum-ip-generic: off
</span></span><span class=line><span class=cl>        tx-checksum-sctp: off
</span></span><span class=line><span class=cl>tcp-segmentation-offload: off
</span></span><span class=line><span class=cl>        tx-tcp-segmentation: off <span class=o>[</span>requested on<span class=o>]</span>
</span></span><span class=line><span class=cl>        tx-tcp-ecn-segmentation: off <span class=o>[</span>requested on<span class=o>]</span>
</span></span><span class=line><span class=cl>        tx-tcp-mangleid-segmentation: off <span class=o>[</span>requested on<span class=o>]</span>
</span></span><span class=line><span class=cl>        tx-tcp6-segmentation: off <span class=o>[</span>requested on<span class=o>]</span>
</span></span><span class=line><span class=cl>Fri Jun  <span class=m>3</span> 21:30:33 UTC 2022: starting sshd
</span></span><span class=line><span class=cl>ssh-keygen: generating new host keys: RSA DSA ECDSA ED25519
</span></span><span class=line><span class=cl>Fri Jun  <span class=m>3</span> 21:30:33 UTC 2022: Calling boot_run script
</span></span><span class=line><span class=cl>cat: /sys/class/dmi/id/board_name: No such file or directory
</span></span><span class=line><span class=cl>cat: /sys/class/dmi/id/board_name: No such file or directory
</span></span><span class=line><span class=cl>/opt/srlinux/bin/bootscript/05_sr_createuser.sh: line 270: !srl_is_running_on_nokia_rootfs: <span class=nb>command</span> not found
</span></span><span class=line><span class=cl>/opt/srlinux/bin/bootscript/05_sr_createuser.sh: line 282: python: <span class=nb>command</span> not found
</span></span><span class=line><span class=cl>chmod: cannot access <span class=s1>&#39;/dev/console&#39;</span>: No such file or directory
</span></span><span class=line><span class=cl>chmod: missing operand after <span class=s1>&#39;0664&#39;</span>
</span></span><span class=line><span class=cl>Try <span class=s1>&#39;chmod --help&#39;</span> <span class=k>for</span> more information.
</span></span><span class=line><span class=cl>/usr/bin/find: <span class=s1>&#39;/var/log/srlinux/file&#39;</span>: No such file or directory
</span></span><span class=line><span class=cl>logmgr_set_env.sh: plain_bootup_start
</span></span><span class=line><span class=cl>Fri Jun  <span class=m>3</span> 21:30:35 UTC <span class=m>2022</span>  logmgr_set_env.sh: restart of rsyslogd
</span></span><span class=line><span class=cl>which: no python in <span class=o>(</span>/opt/srlinux/bin:/opt/srlinux/usr/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin<span class=o>)</span>
</span></span><span class=line><span class=cl>readlink: missing operand
</span></span><span class=line><span class=cl>Try <span class=s1>&#39;readlink --help&#39;</span> <span class=k>for</span> more information.
</span></span><span class=line><span class=cl>setfacl: /mnt/nokiaos: No such file or directory
</span></span><span class=line><span class=cl>setfacl: /mnt/nokiaos: No such file or directory
</span></span><span class=line><span class=cl>setfacl: /mnt/nokiaos: No such file or directory
</span></span><span class=line><span class=cl>setfacl: /mnt/nokiaos: No such file or directory
</span></span><span class=line><span class=cl>setfacl: Option -m: Invalid argument near character <span class=m>5</span>
</span></span><span class=line><span class=cl>setfacl: Option -m: Invalid argument near character <span class=m>3</span>
</span></span><span class=line><span class=cl>setfacl: Option -m: Invalid argument near character <span class=m>5</span>
</span></span><span class=line><span class=cl>setfacl: Option -m: Invalid argument near character <span class=m>3</span>
</span></span><span class=line><span class=cl>System has not been booted with systemd as init system <span class=o>(</span>PID 1<span class=o>)</span>. Can<span class=s1>&#39;t operate.
</span></span></span><span class=line><span class=cl><span class=s1>Failed to connect to bus: Host is down
</span></span></span><span class=line><span class=cl><span class=s1>Failed to open connection to &#34;system&#34; message bus: Failed to connect to socket /run/dbus/system_bus_socket: No such file or directory
</span></span></span><span class=line><span class=cl><span class=s1>System has not been booted with systemd as init system (PID 1). Can&#39;</span>t operate.
</span></span><span class=line><span class=cl>Failed to connect to bus: Host is down
</span></span><span class=line><span class=cl>findfs: unable to resolve <span class=s1>&#39;LABEL=EFI-System&#39;</span>
</span></span><span class=line><span class=cl>No disk with label EFI-System is found
</span></span><span class=line><span class=cl>Failed to <span class=nb>set</span> capabilities on file <span class=sb>`</span>/usr/sbin/tcpdump<span class=s1>&#39; (No such file or directory)
</span></span></span><span class=line><span class=cl><span class=s1>usage: setcap [-q] [-v] [-n &lt;rootid&gt;] (-r|-|&lt;caps&gt;) &lt;filename&gt; [ ... (-r|-|&lt;capsN&gt;) &lt;filenameN&gt; ]
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1> Note &lt;filename&gt; must be a regular (non-symlink) file.
</span></span></span><span class=line><span class=cl><span class=s1>Fri Jun  3 21:30:37 UTC 2022: entrypoint.sh done, executing sudo bash -c touch /.dockerenv &amp;&amp; /opt/srlinux/bin/sr_linux
</span></span></span><span class=line><span class=cl><span class=s1>No/Invalid license found!
</span></span></span><span class=line><span class=cl><span class=s1>Not starting in a named namespace, giving it the name &#34;srbase&#34;
</span></span></span><span class=line><span class=cl><span class=s1>Unix domain socket directory is /opt/srlinux/var/run/
</span></span></span><span class=line><span class=cl><span class=s1>Log directory is /var/log/srlinux/stdout
</span></span></span><span class=line><span class=cl><span class=s1>  Started supportd: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_supportd --server-mode&#34; &gt;/var/log/srlinux/stdout/supportd.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Application supportd is running: PID 1525
</span></span></span><span class=line><span class=cl><span class=s1>  Started dev_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_device_mgr&#34; &gt;/var/log/srlinux/stdout/dev_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Application dev_mgr is running: PID 1548
</span></span></span><span class=line><span class=cl><span class=s1>  Started idb_server: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_idb_server&#34; &gt;/var/log/srlinux/stdout/idb_server.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Application idb_server is running: PID 1568
</span></span></span><span class=line><span class=cl><span class=s1>  Started aaa_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_aaa_mgr&#34; &gt;/var/log/srlinux/stdout/aaa_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started acl_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_acl_mgr&#34; &gt;/var/log/srlinux/stdout/acl_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started arp_nd_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_arp_nd_mgr&#34; &gt;/var/log/srlinux/stdout/arp_nd_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started chassis_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_chassis_mgr&#34; &gt;/var/log/srlinux/stdout/chassis_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started dhcp_client_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_dhcp_client_mgr&#34; &gt;/var/log/srlinux/stdout/dhcp_client_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started evpn_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_evpn_mgr&#34; &gt;/var/log/srlinux/stdout/evpn_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started fhs_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_fhs_mgr&#34; &gt;/var/log/srlinux/stdout/fhs_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started fib_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_fib_mgr&#34; &gt;/var/log/srlinux/stdout/fib_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started l2_mac_learn_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_l2_mac_learn_mgr&#34; &gt;/var/log/srlinux/stdout/l2_mac_learn_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started l2_mac_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_l2_mac_mgr&#34; &gt;/var/log/srlinux/stdout/l2_mac_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started lag_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_lag_mgr&#34; &gt;/var/log/srlinux/stdout/lag_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started linux_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_linux_mgr&#34; &gt;/var/log/srlinux/stdout/linux_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started log_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_log_mgr&#34; &gt;/var/log/srlinux/stdout/log_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started mcid_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_mcid_mgr&#34; &gt;/var/log/srlinux/stdout/mcid_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started mgmt_server: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_mgmt_server&#34; &gt;/var/log/srlinux/stdout/mgmt_server.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started net_inst_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_net_inst_mgr&#34; &gt;/var/log/srlinux/stdout/net_inst_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started sdk_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_sdk_mgr&#34; &gt;/var/log/srlinux/stdout/sdk_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started sflow_sample_mgr: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;./sr_sflow_sample_mgr&#34; &gt;/var/log/srlinux/stdout/sflow_sample_mgr.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Started xdp_lc_1: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;exec -a sr_xdp_lc_1 ./sr_xdp_lc  --slot_num 1&#34; &gt;/var/log/srlinux/stdout/xdp_lc_1.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Application aaa_mgr is running: PID 1582
</span></span></span><span class=line><span class=cl><span class=s1>  Application acl_mgr is running: PID 1593
</span></span></span><span class=line><span class=cl><span class=s1>  Application arp_nd_mgr is running: PID 1604
</span></span></span><span class=line><span class=cl><span class=s1>  Application chassis_mgr is running: PID 1615
</span></span></span><span class=line><span class=cl><span class=s1>  Application dhcp_client_mgr is running: PID 1627
</span></span></span><span class=line><span class=cl><span class=s1>  Application evpn_mgr is running: PID 1638
</span></span></span><span class=line><span class=cl><span class=s1>  Application fhs_mgr is running: PID 1649
</span></span></span><span class=line><span class=cl><span class=s1>  Application fib_mgr is running: PID 1662
</span></span></span><span class=line><span class=cl><span class=s1>  Application l2_mac_learn_mgr is running: PID 1673
</span></span></span><span class=line><span class=cl><span class=s1>  Application l2_mac_mgr is running: PID 1687
</span></span></span><span class=line><span class=cl><span class=s1>  Application lag_mgr is running: PID 1706
</span></span></span><span class=line><span class=cl><span class=s1>  Application linux_mgr is running: PID 1717
</span></span></span><span class=line><span class=cl><span class=s1>  Application log_mgr is running: PID 1728
</span></span></span><span class=line><span class=cl><span class=s1>  Application mcid_mgr is running: PID 1741
</span></span></span><span class=line><span class=cl><span class=s1>  Application mgmt_server is running: PID 1755
</span></span></span><span class=line><span class=cl><span class=s1>  Application net_inst_mgr is running: PID 1766
</span></span></span><span class=line><span class=cl><span class=s1>  Application sdk_mgr is running: PID 1777
</span></span></span><span class=line><span class=cl><span class=s1>  Application sflow_sample_mgr is running: PID 1787
</span></span></span><span class=line><span class=cl><span class=s1>  Application xdp_lc_1 is running: PID 1797
</span></span></span><span class=line><span class=cl><span class=s1>  Started xdp_lc_1: source /etc/profile.d/sr_app_env.sh &amp;&gt;/dev/null; bash -c &#34;exec -a sr_xdp_lc_1 ./sr_xdp_lc  --slot_num 1&#34; &gt;/var/log/srlinux/stdout/xdp_lc_1.log 2&gt;&amp;1 &amp;
</span></span></span><span class=line><span class=cl><span class=s1>  Application xdp_lc_1 is running: PID 2551
</span></span></span><span class=line><span class=cl><span class=s1>[/dev/console unavailable]: 22-06-03 21:30:55.343 sr_app_mgr: Would reboot with reason &#39;</span>AppMgr: xdp_lc_1 has failed<span class=err>&#39;</span> but no-reboot is set</span></span></code></pre></div><p>Well it took me some time to figure out that the last line was the indication that &ldquo;xdp_lc_1&rdquo; represents the process for the line card, i.e. all interfaces were missing.
Let&rsquo;s go into the device shell to check the mentioned log.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>root@r1 /<span class=o>]</span><span class=c1># cat /var/log/srlinux/stdout/xdp_lc_1.20220603_213042.log</span>
</span></span><span class=line><span class=cl>ERROR: This system does not support <span class=s2>&#34;SSSE3&#34;</span>.
</span></span><span class=line><span class=cl>Please check that RTE_MACHINE is <span class=nb>set</span> correctly.
</span></span><span class=line><span class=cl>EAL: FATAL: unsupported cpu type.
</span></span><span class=line><span class=cl>EAL: unsupported cpu type.
</span></span><span class=line><span class=cl>22-06-03 21:30:42.524202  <span class=m>1797</span> C common    dpdk.cc:925                    SRL_ASSERT_MSG  Termination <span class=nv>handler</span>
</span></span><span class=line><span class=cl><span class=o>=========</span> SRL_ASSERT_MSG in program: <span class=nv>sr_xdp_lc_1</span> <span class=o>=========</span>
</span></span><span class=line><span class=cl><span class=o>===</span> At: /builds/sr/srlinux/srlutil/dpdk/dpdk.cc:925
</span></span><span class=line><span class=cl><span class=o>===</span> Condition failed: <span class=o>((</span>diag &gt; 0<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=o>===</span> Cannot init DPDK EAL
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> 0x7a1bad, sr_xdp_lc_1 : srlinux::dpdk::Dpdk::InitEal<span class=o>()</span>+0x159d
</span></span><span class=line><span class=cl> 0x7a1cb1, sr_xdp_lc_1 : srlinux::dpdk::Dpdk::Init<span class=o>()</span>+0x11
</span></span><span class=line><span class=cl> 0x57c766, sr_xdp_lc_1 : main<span class=o>()</span>+0x236
</span></span><span class=line><span class=cl> 0x7fc972aadca3, /lib64/libc.so.6 : __libc_start_main<span class=o>()</span>+0xf3
</span></span><span class=line><span class=cl> 0x59268e, sr_xdp_lc_1 : _start<span class=o>()</span>+0x2e
</span></span><span class=line><span class=cl><span class=o>==============================</span>
</span></span><span class=line><span class=cl><span class=o>===</span> Program: sr_xdp_lc_1
</span></span><span class=line><span class=cl>/builds/sr/srlinux/srlutil/dpdk/dpdk.cc:925 <span class=p>|</span> condition failed <span class=o>((</span>diag &gt; 0<span class=o>))</span> <span class=p>|</span> Cannot init DPDK EAL</span></span></code></pre></div><p>After some googling around, It seems that SSSE3 is not there in the CPU.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ lscpu
</span></span><span class=line><span class=cl>Architecture:                    x86_64
</span></span><span class=line><span class=cl>CPU op-mode<span class=o>(</span>s<span class=o>)</span>:                  32-bit, 64-bit
</span></span><span class=line><span class=cl>Byte Order:                      Little Endian
</span></span><span class=line><span class=cl>Address sizes:                   <span class=m>40</span> bits physical, <span class=m>48</span> bits virtual
</span></span><span class=line><span class=cl>CPU<span class=o>(</span>s<span class=o>)</span>:                          <span class=m>8</span>
</span></span><span class=line><span class=cl>On-line CPU<span class=o>(</span>s<span class=o>)</span> list:             0-7
</span></span><span class=line><span class=cl>Thread<span class=o>(</span>s<span class=o>)</span> per core:              <span class=m>1</span>
</span></span><span class=line><span class=cl>Core<span class=o>(</span>s<span class=o>)</span> per socket:              <span class=m>1</span>
</span></span><span class=line><span class=cl>Socket<span class=o>(</span>s<span class=o>)</span>:                       <span class=m>8</span>
</span></span><span class=line><span class=cl>NUMA node<span class=o>(</span>s<span class=o>)</span>:                    <span class=m>1</span>
</span></span><span class=line><span class=cl>Vendor ID:                       GenuineIntel
</span></span><span class=line><span class=cl>CPU family:                      <span class=m>6</span>
</span></span><span class=line><span class=cl>Model:                           <span class=m>6</span>
</span></span><span class=line><span class=cl>Model name:                      QEMU Virtual CPU version 2.5+
</span></span><span class=line><span class=cl>Stepping:                        <span class=m>3</span>
</span></span><span class=line><span class=cl>CPU MHz:                         2496.000
</span></span><span class=line><span class=cl>BogoMIPS:                        4992.00
</span></span><span class=line><span class=cl>Hypervisor vendor:               KVM
</span></span><span class=line><span class=cl>Virtualization type:             full
</span></span><span class=line><span class=cl>L1d cache:                       <span class=m>256</span> KiB
</span></span><span class=line><span class=cl>L1i cache:                       <span class=m>256</span> KiB
</span></span><span class=line><span class=cl>L2 cache:                        <span class=m>32</span> MiB
</span></span><span class=line><span class=cl>L3 cache:                        <span class=m>128</span> MiB
</span></span><span class=line><span class=cl>NUMA node0 CPU<span class=o>(</span>s<span class=o>)</span>:               0-7
</span></span><span class=line><span class=cl>Vulnerability Itlb multihit:     KVM: Vulnerable
</span></span><span class=line><span class=cl>Vulnerability L1tf:              Mitigation<span class=p>;</span> PTE Inversion
</span></span><span class=line><span class=cl>Vulnerability Mds:               Vulnerable: Clear CPU buffers attempted, no microcode<span class=p>;</span> SMT Host state unknown
</span></span><span class=line><span class=cl>Vulnerability Meltdown:          Mitigation<span class=p>;</span> PTI
</span></span><span class=line><span class=cl>Vulnerability Spec store bypass: Vulnerable
</span></span><span class=line><span class=cl>Vulnerability Spectre v1:        Mitigation<span class=p>;</span> usercopy/swapgs barriers and __user pointer sanitization
</span></span><span class=line><span class=cl>Vulnerability Spectre v2:        Mitigation<span class=p>;</span> Retpolines, STIBP disabled, RSB filling
</span></span><span class=line><span class=cl>Vulnerability Srbds:             Not affected
</span></span><span class=line><span class=cl>Vulnerability Tsx async abort:   Not affected
</span></span><span class=line><span class=cl>Flags:                           fpu de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pse36 clflush mmx fxsr sse sse2 syscall nx lm rep_good nopl xtopology cpuid tsc_known_freq pni cx16 x2apic hypervisor lahf_lm cpuid_fault pti</span></span></code></pre></div><p>Let&rsquo;s check on EVE-NGs CPU because I don&rsquo;t think the processor is too old &#x1f604;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@eve-01:~# lscpu <span class=p>|</span> grep Flags
</span></span><span class=line><span class=cl>Flags:                 fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf tsc_known_freq pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb invpcid_single pti tpr_shadow vnmi flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm mpx rdseed adx smap clflushopt intel_pt xsaveopt xsavec xgetbv1 xsaves dtherm ida arat pln pts hwp hwp_notify hwp_act_window hwp_epp</span></span></code></pre></div><p>So, it is there, but QEMU is not exposing it to the guest machines, which is an easy fix &#x1f604; rather than deprecating the EVE-NGs. The fix is to append the parameters <strong>-cpu qemu64,+ssse3,+sse4.1,+sse4.2</strong> to the qemu command line for booting the VMs, but only after shutting down all 3 nodes to apply the change, as depicted below.</p><figure><a class=lightgallery href=/posts/kube-my-router-pt3/ssse3.png title=/posts/kube-my-router-pt3/ssse3.png data-thumbnail=/posts/kube-my-router-pt3/ssse3.png data-sub-html="<h2>Missing CPU instruction set for SR Linux</h2>"><img loading=lazy src=/posts/kube-my-router-pt3/ssse3.png alt=/posts/kube-my-router-pt3/ssse3.png height=385 width=400></a><figcaption class=image-caption>Missing CPU instruction set for SR Linux</figcaption></figure><p>Yet again if you want to make this the default for all linux VMs on your EVE-NG, you could append this to the template.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@eve-01:~# cat /opt/unetlab/html/templates/intel/linux.yml <span class=p>|</span> grep -v <span class=s2>&#34;#&#34;</span>
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>type: qemu
</span></span><span class=line><span class=cl>description: Linux
</span></span><span class=line><span class=cl>name: Linux
</span></span><span class=line><span class=cl>cpulimit: <span class=m>1</span>
</span></span><span class=line><span class=cl>icon: Server.png
</span></span><span class=line><span class=cl>cpu: <span class=m>2</span>
</span></span><span class=line><span class=cl>ram: <span class=m>4096</span>
</span></span><span class=line><span class=cl>ethernet: <span class=m>1</span>
</span></span><span class=line><span class=cl>console: vnc
</span></span><span class=line><span class=cl>shutdown: <span class=m>1</span>
</span></span><span class=line><span class=cl>qemu_arch: x86_64
</span></span><span class=line><span class=cl>qemu_version: 2.12.0
</span></span><span class=line><span class=cl>qemu_nic: virtio-net-pci
</span></span><span class=line><span class=cl>qemu_options: -machine <span class=nv>type</span><span class=o>=</span>pc,accel<span class=o>=</span>kvm -vga virtio -usbdevice tablet -boot <span class=nv>order</span><span class=o>=</span><span class=nb>cd</span> -cpu qemu64,+ssse3,+sse4.1,+sse4.2
</span></span><span class=line><span class=cl>...</span></span></code></pre></div><p>After applying the &ldquo;patch&rdquo; and bringing up all nodes, everything should look better.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl -n 2srl-certs get all
</span></span><span class=line><span class=cl>NAME     READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>pod/r1   1/1     Running   <span class=m>1</span>          63m
</span></span><span class=line><span class=cl>pod/r2   1/1     Running   <span class=m>1</span>          63m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                 TYPE           CLUSTER-IP       EXTERNAL-IP    PORT<span class=o>(</span>S<span class=o>)</span>                        AGE
</span></span><span class=line><span class=cl>service/service-r1   LoadBalancer   10.103.94.50     192.168.1.50   22:30742/TCP,57400:30637/TCP   63m
</span></span><span class=line><span class=cl>service/service-r2   LoadBalancer   10.111.173.232   192.168.1.51   22:32417/TCP                   63m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ ssh admin@192.168.1.50
</span></span><span class=line><span class=cl>admin@192.168.1.50<span class=s1>&#39;s password:
</span></span></span><span class=line><span class=cl><span class=s1>Using configuration file(s): [&#39;</span>/etc/opt/srlinux/srlinux.rc<span class=s1>&#39;]
</span></span></span><span class=line><span class=cl><span class=s1>Welcome to the srlinux CLI.
</span></span></span><span class=line><span class=cl><span class=s1>Type &#39;</span>help<span class=err>&#39;</span> <span class=o>(</span>and press &lt;ENTER&gt;<span class=o>)</span> <span class=k>if</span> you need any <span class=nb>help</span> using this.
</span></span><span class=line><span class=cl>--<span class=o>{</span> <span class=o>[</span>FACTORY<span class=o>]</span> running <span class=o>}</span>--<span class=o>[</span>  <span class=o>]</span>--
</span></span><span class=line><span class=cl>A:r1# show interface brief
</span></span><span class=line><span class=cl>+---------------------+-----------------------+-----------------------+-----------------------+-----------------------+
</span></span><span class=line><span class=cl><span class=p>|</span>        Port         <span class=p>|</span>      Admin State      <span class=p>|</span>      Oper State       <span class=p>|</span>         Speed         <span class=p>|</span>         Type          <span class=p>|</span>
</span></span><span class=line><span class=cl>+<span class=o>=====================</span>+<span class=o>=======================</span>+<span class=o>=======================</span>+<span class=o>=======================</span>+<span class=o>=======================</span>+
</span></span><span class=line><span class=cl><span class=p>|</span> ethernet-1/1        <span class=p>|</span> disable               <span class=p>|</span> down                  <span class=p>|</span> 25G                   <span class=p>|</span>                       <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ethernet-1/2        <span class=p>|</span> disable               <span class=p>|</span> down                  <span class=p>|</span> 25G                   <span class=p>|</span>                       <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ethernet-1/3        <span class=p>|</span> disable               <span class=p>|</span> down                  <span class=p>|</span> 25G                   <span class=p>|</span>                       <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ethernet-1/4        <span class=p>|</span> disable               <span class=p>|</span> down                  <span class=p>|</span> 25G                   <span class=p>|</span>                       <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ethernet-1/5        <span class=p>|</span> disable               <span class=p>|</span> down                  <span class=p>|</span> 25G                   <span class=p>|</span>                       <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ethernet-1/6        <span class=p>|</span> disable               <span class=p>|</span> down                  <span class=p>|</span> 25G                   <span class=p>|</span>                       <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ethernet-1/7        <span class=p>|</span> disable               <span class=p>|</span> down                  <span class=p>|</span> 25G                   <span class=p>|</span>                       <span class=p>|</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt; ...omitted... &gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>|</span> ethernet-1/53       <span class=p>|</span> disable               <span class=p>|</span> down                  <span class=p>|</span> 100G                  <span class=p>|</span>                       <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ethernet-1/54       <span class=p>|</span> disable               <span class=p>|</span> down                  <span class=p>|</span> 100G                  <span class=p>|</span>                       <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ethernet-1/55       <span class=p>|</span> disable               <span class=p>|</span> down                  <span class=p>|</span> 100G                  <span class=p>|</span>                       <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ethernet-1/56       <span class=p>|</span> disable               <span class=p>|</span> down                  <span class=p>|</span> 100G                  <span class=p>|</span>                       <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> mgmt0               <span class=p>|</span> <span class=nb>enable</span>                <span class=p>|</span> up                    <span class=p>|</span> 1G                    <span class=p>|</span>                       <span class=p>|</span>
</span></span><span class=line><span class=cl>+---------------------+-----------------------+-----------------------+-----------------------+-----------------------+</span></span></code></pre></div><p>We can now proceed with the ping testing, this time from within the box &#x1f604;. Let&rsquo;s apply some configs on the interfaces.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>A:r1# diff flat
</span></span><span class=line><span class=cl>insert / interface ethernet-1/1
</span></span><span class=line><span class=cl>insert / interface ethernet-1/1 admin-state <span class=nb>enable</span>
</span></span><span class=line><span class=cl>insert / interface ethernet-1/1 subinterface <span class=m>0</span>
</span></span><span class=line><span class=cl>insert / interface ethernet-1/1 subinterface <span class=m>0</span> ipv4
</span></span><span class=line><span class=cl>insert / interface ethernet-1/1 subinterface <span class=m>0</span> ipv4 address 10.1.1.1/30
</span></span><span class=line><span class=cl>insert / network-instance main
</span></span><span class=line><span class=cl>insert / network-instance main interface ethernet-1/1.0
</span></span><span class=line><span class=cl>A:r1# commit now
</span></span><span class=line><span class=cl>All changes have been committed. Leaving candidate mode.
</span></span><span class=line><span class=cl>--<span class=o>{</span> <span class=o>[</span>FACTORY<span class=o>]</span> + running <span class=o>}</span>--<span class=o>[</span>  <span class=o>]</span>--
</span></span><span class=line><span class=cl>A:r1# show interface ethernet-1/1
</span></span><span class=line><span class=cl><span class=o>==========================================================================================================================</span>
</span></span><span class=line><span class=cl>ethernet-1/1 is down, reason lower-layer-down
</span></span><span class=line><span class=cl>  ethernet-1/1.0 is down, reason port-down
</span></span><span class=line><span class=cl>    Network-instance: main
</span></span><span class=line><span class=cl>    Encapsulation   : null
</span></span><span class=line><span class=cl>    Type            : routed
</span></span><span class=line><span class=cl>    IPv4 addr    : 10.1.1.1/30 <span class=o>(</span>static, None<span class=o>)</span>
</span></span><span class=line><span class=cl>--------------------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl><span class=o>==========================================================================================================================</span>
</span></span><span class=line><span class=cl>--<span class=o>{</span> <span class=o>[</span>FACTORY<span class=o>]</span> + candidate shared default <span class=o>}</span>--<span class=o>[</span>  <span class=o>]</span>--
</span></span><span class=line><span class=cl>A:r1#</span></span></code></pre></div><p>I guess we still have a <em>lower layer</em> problem. Let&rsquo;s get a shell into the box and check the logs.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl -n 2srl-certs <span class=nb>exec</span> -it r1 -- bash
</span></span><span class=line><span class=cl>Defaulted container <span class=s2>&#34;r1&#34;</span> out of: r1, init-r1 <span class=o>(</span>init<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@r1 /<span class=o>]</span><span class=c1># tail /var/log/messages</span>
</span></span><span class=line><span class=cl>Jun  <span class=m>8</span> 12:50:02 r1 sr_net_inst_mgr: netinst<span class=p>|</span>1704<span class=p>|</span>1704<span class=p>|</span>00013<span class=p>|</span>N: The interface mgmt0.0 in network-instance mgmt is now up
</span></span><span class=line><span class=cl>Jun  <span class=m>8</span> 12:51:19 r1 sr_aaa_mgr: aaa<span class=p>|</span>1528<span class=p>|</span>1650<span class=p>|</span>00000<span class=p>|</span>N: Opened session <span class=k>for</span> user admin from host 10.244.0.0
</span></span><span class=line><span class=cl>Jun  <span class=m>8</span> 12:51:19 r1 sr_aaa_mgr: aaa<span class=p>|</span>1528<span class=p>|</span>1650<span class=p>|</span>00001<span class=p>|</span>N: User admin successfully authenticated from host 10.244.0.0
</span></span><span class=line><span class=cl>Jun  <span class=m>8</span> 12:55:44 r1 sr_mgmt_server: mgmt<span class=p>|</span>1693<span class=p>|</span>1693<span class=p>|</span>00020<span class=p>|</span>I: All changes have been committed successfully by user admin session 1.
</span></span><span class=line><span class=cl>Jun  <span class=m>8</span> 12:55:44 r1 sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>1814<span class=p>|</span>00001<span class=p>|</span>E: common    netdevice.c:355             NetDeviceGetSpeed  ioctl<span class=o>(</span>SIOCETHTOOL, <span class=s2>&#34;e1-1&#34;</span>, <span class=m>1</span> <span class=o>(</span>0x1<span class=o>)</span>, <span class=m>32684</span> <span class=o>(</span>0x7fac<span class=o>))</span>: Operation not supported <span class=o>(</span>95<span class=o>)</span>
</span></span><span class=line><span class=cl>Jun  <span class=m>8</span> 12:55:44 r1 sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>1814<span class=p>|</span>00003<span class=p>|</span>E: common    netdevice.c:182               NetDeviceSetMTU  ioctl<span class=o>(</span>SIOCSIFMTU, <span class=s2>&#34;e1-1&#34;</span>, 9232<span class=o>)</span>: Invalid argument <span class=o>(</span>22<span class=o>)</span>
</span></span><span class=line><span class=cl>Jun  <span class=m>8</span> 12:55:44 r1 sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>1814<span class=p>|</span>00004<span class=p>|</span>E: simif     sim_physif.cc:764            UpdateAdminState  error setting mtu <span class=k>for</span> interface <span class=s2>&#34;ethernet-1/1&#34;</span> mtu: <span class=m>9232</span>
</span></span><span class=line><span class=cl>Jun  <span class=m>8</span> 12:55:44 r1 sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>1814<span class=p>|</span>00005<span class=p>|</span>E: common    netdevice.c:355             NetDeviceGetSpeed  ioctl<span class=o>(</span>SIOCETHTOOL, <span class=s2>&#34;e1-1&#34;</span>, <span class=m>1</span> <span class=o>(</span>0x1<span class=o>)</span>, <span class=m>26571</span> <span class=o>(</span>0x67cb<span class=o>))</span>: Operation not supported <span class=o>(</span>95<span class=o>)</span>
</span></span><span class=line><span class=cl>Jun  <span class=m>8</span> 12:55:44 r1 sr_net_inst_mgr: netinst<span class=p>|</span>1704<span class=p>|</span>1704<span class=p>|</span>00014<span class=p>|</span>N: Network Instance main is now up
</span></span><span class=line><span class=cl>Jun  <span class=m>8</span> 12:55:45 r1 sr_net_inst_mgr: netinst<span class=p>|</span>1704<span class=p>|</span>1704<span class=p>|</span>00015<span class=p>|</span>W: The interface ethernet-1/1.0 in network-instance main is now down <span class=k>for</span> reason: the subinterface is operationally down
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@r1 ~<span class=o>]</span><span class=c1># tail /var/log/srlinux/debug/errors.log</span>
</span></span><span class=line><span class=cl>2022-06-08T12:55:44.990045+00:00 r1 local6<span class=p>|</span>ERR sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>1814<span class=p>|</span>00001<span class=p>|</span>E: common    netdevice.c:355             NetDeviceGetSpeed  ioctl<span class=o>(</span>SIOCETHTOOL, <span class=s2>&#34;e1-1&#34;</span>, <span class=m>1</span> <span class=o>(</span>0x1<span class=o>)</span>, <span class=m>32684</span> <span class=o>(</span>0x7fac<span class=o>))</span>: Operation not supported <span class=o>(</span>95<span class=o>)</span>
</span></span><span class=line><span class=cl>2022-06-08T12:55:44.990171+00:00 r1 local6<span class=p>|</span>ERR sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>1814<span class=p>|</span>00003<span class=p>|</span>E: common    netdevice.c:182               NetDeviceSetMTU  ioctl<span class=o>(</span>SIOCSIFMTU, <span class=s2>&#34;e1-1&#34;</span>, 9232<span class=o>)</span>: Invalid argument <span class=o>(</span>22<span class=o>)</span>
</span></span><span class=line><span class=cl>2022-06-08T12:55:44.990193+00:00 r1 local6<span class=p>|</span>ERR sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>1814<span class=p>|</span>00004<span class=p>|</span>E: simif     sim_physif.cc:764            UpdateAdminState  error setting mtu <span class=k>for</span> interface <span class=s2>&#34;ethernet-1/1&#34;</span> mtu: <span class=m>9232</span>
</span></span><span class=line><span class=cl>2022-06-08T12:55:44.990805+00:00 r1 local6<span class=p>|</span>ERR sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>1814<span class=p>|</span>00005<span class=p>|</span>E: common    netdevice.c:355             NetDeviceGetSpeed  ioctl<span class=o>(</span>SIOCETHTOOL, <span class=s2>&#34;e1-1&#34;</span>, <span class=m>1</span> <span class=o>(</span>0x1<span class=o>)</span>, <span class=m>26571</span> <span class=o>(</span>0x67cb<span class=o>))</span>: Operation not supported <span class=o>(</span>95<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>root@r1 ~<span class=o>]</span><span class=c1># tail /var/log/srlinux/debug/sr_xdp_lc_1.log</span>
</span></span><span class=line><span class=cl>2022-06-08T12:55:44.990045+00:00 r1 local6<span class=p>|</span>ERR sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>1814<span class=p>|</span>00001<span class=p>|</span>E: common    netdevice.c:355             NetDeviceGetSpeed  ioctl<span class=o>(</span>SIOCETHTOOL, <span class=s2>&#34;e1-1&#34;</span>, <span class=m>1</span> <span class=o>(</span>0x1<span class=o>)</span>, <span class=m>32684</span> <span class=o>(</span>0x7fac<span class=o>))</span>: Operation not supported <span class=o>(</span>95<span class=o>)</span>
</span></span><span class=line><span class=cl>2022-06-08T12:55:44.990087+00:00 r1 local6<span class=p>|</span>WARN sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>1814<span class=p>|</span>00002<span class=p>|</span>W: simif     sim_physif.cc:218           GetInterfaceSpeed  Unable to get speed <span class=k>for</span> interface: e1-1
</span></span><span class=line><span class=cl>2022-06-08T12:55:44.990171+00:00 r1 local6<span class=p>|</span>ERR sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>1814<span class=p>|</span>00003<span class=p>|</span>E: common    netdevice.c:182               NetDeviceSetMTU  ioctl<span class=o>(</span>SIOCSIFMTU, <span class=s2>&#34;e1-1&#34;</span>, 9232<span class=o>)</span>: Invalid argument <span class=o>(</span>22<span class=o>)</span>
</span></span><span class=line><span class=cl>2022-06-08T12:55:44.990193+00:00 r1 local6<span class=p>|</span>ERR sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>1814<span class=p>|</span>00004<span class=p>|</span>E: simif     sim_physif.cc:764            UpdateAdminState  error setting mtu <span class=k>for</span> interface <span class=s2>&#34;ethernet-1/1&#34;</span> mtu: <span class=m>9232</span>
</span></span><span class=line><span class=cl>2022-06-08T12:55:44.990805+00:00 r1 local6<span class=p>|</span>ERR sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>1814<span class=p>|</span>00005<span class=p>|</span>E: common    netdevice.c:355             NetDeviceGetSpeed  ioctl<span class=o>(</span>SIOCETHTOOL, <span class=s2>&#34;e1-1&#34;</span>, <span class=m>1</span> <span class=o>(</span>0x1<span class=o>)</span>, <span class=m>26571</span> <span class=o>(</span>0x67cb<span class=o>))</span>: Operation not supported <span class=o>(</span>95<span class=o>)</span>
</span></span><span class=line><span class=cl>2022-06-08T12:55:44.990828+00:00 r1 local6<span class=p>|</span>WARN sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>1814<span class=p>|</span>00006<span class=p>|</span>W: simif     sim_physif.cc:218           GetInterfaceSpeed  Unable to get speed <span class=k>for</span> interface: e1-1
</span></span><span class=line><span class=cl>2022-06-08T12:55:45.006160+00:00 r1 local6<span class=p>|</span>WARN sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>2066<span class=p>|</span>00009<span class=p>|</span>W: cpmgr     cp_mgr.cc:1595       CpMgrExtractFrameHandler  interface <span class=m>2147483647</span> not found <span class=k>for</span> reason MLD
</span></span><span class=line><span class=cl>2022-06-08T12:55:45.018077+00:00 r1 local6<span class=p>|</span>WARN sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>2066<span class=p>|</span>00010<span class=p>|</span>W: cpmgr     cp_mgr.cc:1595       CpMgrExtractFrameHandler  interface <span class=m>2147483647</span> not found <span class=k>for</span> reason MLD
</span></span><span class=line><span class=cl>2022-06-08T12:55:45.658478+00:00 r1 local6<span class=p>|</span>WARN sr_xdp_lc_1: debug<span class=p>|</span>1739<span class=p>|</span>2066<span class=p>|</span>00011<span class=p>|</span>W: cpmgr     cp_mgr.cc:1595       CpMgrExtractFrameHandler  interface <span class=m>2147483647</span> not found <span class=k>for</span> reason MLD</span></span></code></pre></div><p>It seems we have an MTU issue for the 25G interfaces that by default get 9232. Maybe if we specify a lower MTU and set speed to 1G</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>--<span class=o>{</span> <span class=o>[</span>FACTORY<span class=o>]</span> + candidate shared default <span class=o>}</span>--<span class=o>[</span>  <span class=o>]</span>--
</span></span><span class=line><span class=cl>A:r1# info flat interface ethernet-1/1
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 admin-state <span class=nb>enable</span>
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 mtu <span class=m>1500</span>
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 ethernet
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 ethernet port-speed 1G
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 subinterface <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 subinterface <span class=m>0</span> ipv4
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 subinterface <span class=m>0</span> ipv4 address 10.1.1.1/30
</span></span><span class=line><span class=cl>--<span class=o>{</span> <span class=o>[</span>FACTORY<span class=o>]</span> + candidate shared default <span class=o>}</span>--<span class=o>[</span>  <span class=o>]</span>--
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>A:r1# show interface ethernet-1/1
</span></span><span class=line><span class=cl><span class=o>==========================================================================</span>
</span></span><span class=line><span class=cl>ethernet-1/1 is down, reason lower-layer-down
</span></span><span class=line><span class=cl>  ethernet-1/1.0 is down, reason ip-mtu-too-large
</span></span><span class=line><span class=cl>    Network-instance: main
</span></span><span class=line><span class=cl>    Encapsulation   : null
</span></span><span class=line><span class=cl>    Type            : routed
</span></span><span class=line><span class=cl>    IPv4 addr    : 10.1.1.1/30 <span class=o>(</span>static, None<span class=o>)</span>
</span></span><span class=line><span class=cl>--------------------------------------------------------------------------
</span></span><span class=line><span class=cl><span class=o>==========================================================================</span>
</span></span><span class=line><span class=cl>--<span class=o>{</span> <span class=o>[</span>FACTORY<span class=o>]</span> + candidate shared default <span class=o>}</span>--<span class=o>[</span>  <span class=o>]</span>--
</span></span><span class=line><span class=cl>A:r1</span></span></code></pre></div><p>OK, let&rsquo;s check the MTU on the container then after deleting the configs in r1 to see the default situation</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>root@r1 ~<span class=o>]</span><span class=c1># ip link</span>
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue state UNKNOWN mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>3: mgmt0@if7: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1514</span> qdisc noqueue state UP mode DEFAULT group default
</span></span><span class=line><span class=cl>    link/ether 86:28:21:01:2f:32 brd ff:ff:ff:ff:ff:ff link-netnsid <span class=m>0</span>
</span></span><span class=line><span class=cl>4: gway-2800@if2: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc noqueue state UP mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether 26:e1:9b:7f:82:07 brd ff:ff:ff:ff:ff:ff link-netns srbase-mgmt
</span></span><span class=line><span class=cl>5: mgmt0-0@if4: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc noqueue state UP mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether e2:33:67:b1:b0:8e brd ff:ff:ff:ff:ff:ff link-netns srbase-mgmt
</span></span><span class=line><span class=cl>    <span class=nb>alias</span> mgmt0.0
</span></span><span class=line><span class=cl>6: monit_in@if5: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>9234</span> qdisc noqueue state UP mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether fa:13:fb:a3:7c:e6 brd ff:ff:ff:ff:ff:ff link-netns monit
</span></span><span class=line><span class=cl>8: e1-1@if8: &lt;BROADCAST,MULTICAST&gt; mtu <span class=m>1450</span> qdisc noqueue state DOWN mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether 02:ab:b7:ff:00:01 brd ff:ff:ff:ff:ff:ff link-netnsid <span class=m>0</span></span></span></code></pre></div><p>So, the interface is configured with an MTU of 1450, which I guess is inherited by our <em>host</em> network adapter and also cannot be changed on the fly in the container. Let&rsquo;s see what we kave in k8s.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ ip link
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue state UNKNOWN mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>2: ens3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc fq_codel state UP mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether 00:50:02:00:01:00 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>3: flannel.1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1450</span> qdisc noqueue state UNKNOWN mode DEFAULT group default
</span></span><span class=line><span class=cl>    link/ether 5e:3c:ea:cf:bd:cd brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>4: cni0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1450</span> qdisc noqueue state UP mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether 92:19:8e:ea:71:f5 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>5: vethf00a4528@if3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1450</span> qdisc noqueue master cni0 state UP mode DEFAULT group default
</span></span><span class=line><span class=cl>    link/ether 92:85:21:c2:60:82 brd ff:ff:ff:ff:ff:ff link-netns cni-461b355e-9191-3b43-3778-e328f19016ef
</span></span><span class=line><span class=cl>6: vethd6c19f4d@if3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1450</span> qdisc noqueue master cni0 state UP mode DEFAULT group default
</span></span><span class=line><span class=cl>    link/ether d6:77:32:3c:c2:91 brd ff:ff:ff:ff:ff:ff link-netns cni-c88dd2d1-485d-2cd4-5f2d-d5b5539370eb
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$</span></span></code></pre></div><p>So flannel, since it is a VXLAN CNI inherits the MTU of ens3 <em>physical</em> interface minus 50 overhead for the headers. I am thinking of an easy fix around this is to increase the MTU on the physical interface, i.e. EVE-NGs physical interface and k8s VMs one as well. Let&rsquo;s shutdown all VMs first and make the change to the EVE hosts.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Configure jumbo MTU on both EVE-NG nodes</span>
</span></span><span class=line><span class=cl>root@eve-01:~# ip link <span class=nb>set</span> mtu <span class=m>9000</span> dev eth0
</span></span><span class=line><span class=cl>root@eve-01:~# ip link <span class=nb>set</span> mtu <span class=m>9000</span> dev pnet0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@eve-02:~# ip link <span class=nb>set</span> mtu <span class=m>9000</span> dev eth0
</span></span><span class=line><span class=cl>root@eve-02:~# ip link <span class=nb>set</span> mtu <span class=m>9000</span> dev pnet0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># If you want to make it permanent</span>
</span></span><span class=line><span class=cl>root@eve-01:~# head -n20 /etc/network/interfaces
</span></span><span class=line><span class=cl><span class=c1># This file describes the network interfaces available on your system</span>
</span></span><span class=line><span class=cl><span class=c1># and how to activate them. For more information, see interfaces(5).</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># The loopback network interface</span>
</span></span><span class=line><span class=cl>auto lo
</span></span><span class=line><span class=cl>iface lo inet loopback
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># The primary network interface</span>
</span></span><span class=line><span class=cl>iface eth0 inet manual
</span></span><span class=line><span class=cl>auto pnet0
</span></span><span class=line><span class=cl>iface pnet0 inet static
</span></span><span class=line><span class=cl>    address 192.168.1.21
</span></span><span class=line><span class=cl>    netmask 255.255.255.0
</span></span><span class=line><span class=cl>    gateway 192.168.1.1
</span></span><span class=line><span class=cl>    dns-domain lab.net
</span></span><span class=line><span class=cl>    dns-nameservers 192.168.1.1 8.8.8.8
</span></span><span class=line><span class=cl>    bridge_ports eth0
</span></span><span class=line><span class=cl>    bridge_stp off
</span></span><span class=line><span class=cl>    mtu <span class=m>9000</span>
</span></span><span class="line hl"><span class=cl>    post-up ifconfig eth0 mtu <span class=m>9000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Verify that jumbo MTU is supported on your infra</span>
</span></span><span class=line><span class=cl>root@eve-01:~# ping 192.168.1.22 -Mdo -s <span class=m>5000</span>
</span></span><span class=line><span class=cl>PING 192.168.1.22 <span class=o>(</span>192.168.1.22<span class=o>)</span> 5000<span class=o>(</span>5028<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>5008</span> bytes from 192.168.1.22: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.434 ms
</span></span><span class=line><span class=cl><span class=m>5008</span> bytes from 192.168.1.22: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.415 ms
</span></span><span class=line><span class=cl><span class=m>5008</span> bytes from 192.168.1.22: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.423 ms
</span></span><span class=line><span class=cl><span class=m>5008</span> bytes from 192.168.1.22: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.397 ms
</span></span><span class=line><span class=cl>^C
</span></span><span class=line><span class=cl>--- 192.168.1.22 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>4</span> packets transmitted, <span class=m>4</span> received, 0% packet loss, <span class=nb>time</span> 3083ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 0.397/0.417/0.434/0.019 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@eve-02:~# tracepath -n 192.168.1.21
</span></span><span class=line><span class=cl> 1?: <span class=o>[</span>LOCALHOST<span class=o>]</span>                                         pmtu <span class=m>9000</span>
</span></span><span class=line><span class=cl> 1:  192.168.1.21                                          0.570ms reached
</span></span><span class=line><span class=cl> 1:  192.168.1.21                                          0.428ms reached
</span></span><span class=line><span class=cl>     Resume: pmtu <span class=m>9000</span> hops <span class=m>1</span> back <span class=m>1</span></span></span></code></pre></div><p>Bring up the k8s VMs and set the MTU there too.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ cat /etc/netplan/50-cloud-init.yaml
</span></span><span class=line><span class=cl><span class=c1># This file is generated from information provided by the datasource.  Changes</span>
</span></span><span class=line><span class=cl><span class=c1># to it will not persist across an instance reboot.  To disable cloud-init&#39;s</span>
</span></span><span class=line><span class=cl><span class=c1># network configuration capabilities, write a file</span>
</span></span><span class=line><span class=cl><span class=c1># /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:</span>
</span></span><span class=line><span class=cl><span class=c1># network: {config: disabled}</span>
</span></span><span class=line><span class=cl>network:
</span></span><span class=line><span class=cl>    ethernets:
</span></span><span class=line><span class=cl>        ens3:
</span></span><span class="line hl"><span class=cl>            mtu: <span class=m>9000</span>
</span></span><span class=line><span class=cl>            dhcp4: <span class=nb>false</span>
</span></span><span class=line><span class=cl>            dhcp6: <span class=nb>false</span>
</span></span><span class=line><span class=cl>            addresses: <span class=o>[</span>192.168.1.30/24<span class=o>]</span>
</span></span><span class=line><span class=cl>            gateway4: 192.168.1.1
</span></span><span class=line><span class=cl>            nameservers:
</span></span><span class=line><span class=cl>                    addresses: <span class=o>[</span>192.168.1.1, 8.8.8.8<span class=o>]</span>
</span></span><span class=line><span class=cl>    version: <span class=m>2</span></span></span></code></pre></div><p>Reboot all 3 VMs and check the network</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ ip link
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue state UNKNOWN mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>2: ens3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>9000</span> qdisc fq_codel state UP mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether 00:50:02:00:01:00 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>3: flannel.1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>8950</span> qdisc noqueue state UNKNOWN mode DEFAULT group default
</span></span><span class=line><span class=cl>    link/ether 2a:d3:ae:2c:3a:47 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>4: cni0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>8950</span> qdisc noqueue state UP mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether b2:26:5f:c2:46:4c brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>5: veth48f89ceb@if3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>8950</span> qdisc noqueue master cni0 state UP mode DEFAULT group default
</span></span><span class=line><span class=cl>    link/ether 4a:f4:77:a3:32:db brd ff:ff:ff:ff:ff:ff link-netns cni-9818a9b4-e802-2a6c-fc91-c4e241c38383
</span></span><span class=line><span class=cl>6: vethafbac825@if3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>8950</span> qdisc noqueue master cni0 state UP mode DEFAULT group default
</span></span><span class=line><span class=cl>    link/ether c6:44:4c:53:b4:50 brd ff:ff:ff:ff:ff:ff link-netns cni-014e3a91-e088-0d4b-740b-1024368a45a4</span></span></code></pre></div><p>It looks so much better now &#x1f604;. OK, back on r1 then, let&rsquo;s see how it looks like on the networking side</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl -n 2srl-certs <span class=nb>exec</span> -it r1 -- bash
</span></span><span class=line><span class=cl>Defaulted container <span class=s2>&#34;r1&#34;</span> out of: r1, init-r1 <span class=o>(</span>init<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@r1 /<span class=o>]</span><span class=c1># ip link</span>
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue state UNKNOWN mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>3: mgmt0@if10: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1514</span> qdisc noqueue state UP mode DEFAULT group default
</span></span><span class=line><span class=cl>    link/ether 2e:99:25:47:fe:3d brd ff:ff:ff:ff:ff:ff link-netnsid <span class=m>0</span>
</span></span><span class=line><span class=cl>4: gway-2800@if2: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc noqueue state UP mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether 66:fa:8c:11:28:47 brd ff:ff:ff:ff:ff:ff link-netns srbase-mgmt
</span></span><span class=line><span class=cl>5: mgmt0-0@if4: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc noqueue state UP mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether 0a:5d:84:d6:be:df brd ff:ff:ff:ff:ff:ff link-netns srbase-mgmt
</span></span><span class=line><span class=cl>    <span class=nb>alias</span> mgmt0.0
</span></span><span class=line><span class=cl>6: monit_in@if5: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>9234</span> qdisc noqueue state UP mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether 76:35:de:b1:c1:a6 brd ff:ff:ff:ff:ff:ff link-netns monit
</span></span><span class=line><span class=cl>11: e1-1@if11: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>8950</span> qdisc noqueue state UNKNOWN mode DEFAULT group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether be:d0:be:51:69:e3 brd ff:ff:ff:ff:ff:ff link-netnsid <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=o>[</span>root@r1 /<span class=o>]</span><span class=c1>#</span></span></span></code></pre></div><p>Now lets configure the devices with the following commands</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># on R1</span>
</span></span><span class=line><span class=cl>--<span class=o>{</span> <span class=o>[</span>FACTORY<span class=o>]</span> + candidate shared default <span class=o>}</span>--<span class=o>[</span>  <span class=o>]</span>--
</span></span><span class=line><span class=cl>A:r1# info flat interface ethernet-1/1
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 mtu <span class=m>1516</span>
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 ethernet
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 ethernet port-speed 10G
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 subinterface <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 subinterface <span class=m>0</span> ip-mtu <span class=m>1500</span>
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 subinterface <span class=m>0</span> ipv4
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 subinterface <span class=m>0</span> ipv4 address 10.1.1.1/30
</span></span><span class=line><span class=cl>--<span class=o>{</span> <span class=o>[</span>FACTORY<span class=o>]</span> + candidate shared default <span class=o>}</span>--<span class=o>[</span>  <span class=o>]</span>--
</span></span><span class=line><span class=cl>A:r1# info flat network-instance main
</span></span><span class=line><span class=cl><span class=nb>set</span> / network-instance main
</span></span><span class=line><span class=cl><span class=nb>set</span> / network-instance main interface ethernet-1/1.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>A:r1# show interface ethernet-1/1
</span></span><span class=line><span class=cl><span class=o>==========================================================================</span>
</span></span><span class=line><span class=cl>ethernet-1/1 is up, speed 10G, <span class=nb>type</span> None
</span></span><span class=line><span class=cl>  ethernet-1/1.0 is up
</span></span><span class=line><span class=cl>    Network-instance: main
</span></span><span class=line><span class=cl>    Encapsulation   : null
</span></span><span class=line><span class=cl>    Type            : routed
</span></span><span class=line><span class=cl>    IPv4 addr    : 10.1.1.1/30 <span class=o>(</span>static, preferred, primary<span class=o>)</span>
</span></span><span class=line><span class=cl>--------------------------------------------------------------------------
</span></span><span class=line><span class=cl><span class=o>==========================================================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># on R2</span>
</span></span><span class=line><span class=cl>A:r2# info flat interface ethernet-1/1
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 mtu <span class=m>1516</span>
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 ethernet
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 ethernet port-speed 10G
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 subinterface <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 subinterface <span class=m>0</span> ip-mtu <span class=m>1500</span>
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 subinterface <span class=m>0</span> ipv4
</span></span><span class=line><span class=cl><span class=nb>set</span> / interface ethernet-1/1 subinterface <span class=m>0</span> ipv4 address 10.1.1.2/30
</span></span><span class=line><span class=cl>--<span class=o>{</span> running <span class=o>}</span>--<span class=o>[</span>  <span class=o>]</span>--
</span></span><span class=line><span class=cl>A:r2# info flat network-instance main
</span></span><span class=line><span class=cl><span class=nb>set</span> / network-instance main
</span></span><span class=line><span class=cl><span class=nb>set</span> / network-instance main interface ethernet-1/1.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check that we get pings</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>A:r2# ping 10.1.1.1 network-instance main
</span></span><span class=line><span class=cl>Using network instance main
</span></span><span class=line><span class=cl>PING 10.1.1.1 <span class=o>(</span>10.1.1.1<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>58.8 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>14.7 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>9.13 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>12.5 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>5</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>14.7 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>6</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>9.12 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>7</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>12.5 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>8</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>6.85 ms
</span></span><span class=line><span class=cl>^C
</span></span><span class=line><span class=cl>--- 10.1.1.1 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>8</span> packets transmitted, <span class=m>8</span> received, 0% packet loss, <span class=nb>time</span> 7008ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 6.853/17.291/58.831/15.918 ms</span></span></code></pre></div><p>OK, now let&rsquo;s try out the other srlinux variants supported</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl -n 2srl-certs get cm
</span></span><span class=line><span class=cl>NAME                     DATA   AGE
</span></span><span class=line><span class=cl>kube-root-ca.crt         <span class=m>1</span>      5h33m
</span></span><span class=line><span class=cl>srlinux-kne-entrypoint   <span class=m>1</span>      5h33m
</span></span><span class=line><span class=cl>srlinux-topomac-script   <span class=m>1</span>      5h33m
</span></span><span class=line><span class=cl>srlinux-variants         <span class=m>5</span>      5h33m
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl -n 2srl-certs describe cm srlinux-variants <span class=p>|</span> grep ^ixr
</span></span><span class=line><span class=cl>ixrd1:
</span></span><span class=line><span class=cl>ixrd10:
</span></span><span class=line><span class=cl>ixrd2:
</span></span><span class=line><span class=cl>ixrd3:
</span></span><span class=line><span class=cl>ixr6:</span></span></code></pre></div><p>Create a simple lab containing only the node definitions.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~/labs$ cat test-sr.pbtxt
</span></span><span class=line><span class=cl>name: <span class=s2>&#34;srl-test&#34;</span>
</span></span><span class=line><span class=cl>nodes: <span class=o>{</span>
</span></span><span class=line><span class=cl>    name: <span class=s2>&#34;r1&#34;</span>
</span></span><span class=line><span class=cl>    vendor: NOKIA
</span></span><span class=line><span class=cl>    services:<span class=o>{</span>
</span></span><span class=line><span class=cl>        key: <span class=m>22</span>
</span></span><span class=line><span class=cl>        value: <span class=o>{</span>
</span></span><span class=line><span class=cl>            name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>            inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    model: <span class=s2>&#34;ixr6&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nodes: <span class=o>{</span>
</span></span><span class=line><span class=cl>    name: <span class=s2>&#34;r2&#34;</span>
</span></span><span class=line><span class=cl>    vendor: NOKIA
</span></span><span class=line><span class=cl>    services:<span class=o>{</span>
</span></span><span class=line><span class=cl>        key: <span class=m>22</span>
</span></span><span class=line><span class=cl>        value: <span class=o>{</span>
</span></span><span class=line><span class=cl>            name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>            inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    model: <span class=s2>&#34;ixrd1&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nodes: <span class=o>{</span>
</span></span><span class=line><span class=cl>    name: <span class=s2>&#34;r3&#34;</span>
</span></span><span class=line><span class=cl>    vendor: NOKIA
</span></span><span class=line><span class=cl>    services:<span class=o>{</span>
</span></span><span class=line><span class=cl>        key: <span class=m>22</span>
</span></span><span class=line><span class=cl>        value: <span class=o>{</span>
</span></span><span class=line><span class=cl>            name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>            inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    model: <span class=s2>&#34;ixrd2&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>nodes: <span class=o>{</span>
</span></span><span class=line><span class=cl>    name: <span class=s2>&#34;r4&#34;</span>
</span></span><span class=line><span class=cl>    vendor: NOKIA
</span></span><span class=line><span class=cl>    services:<span class=o>{</span>
</span></span><span class=line><span class=cl>        key: <span class=m>22</span>
</span></span><span class=line><span class=cl>        value: <span class=o>{</span>
</span></span><span class=line><span class=cl>            name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>            inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    model: <span class=s2>&#34;ixrd3&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>nodes: <span class=o>{</span>
</span></span><span class=line><span class=cl>    name: <span class=s2>&#34;r5&#34;</span>
</span></span><span class=line><span class=cl>    vendor: NOKIA
</span></span><span class=line><span class=cl>    services:<span class=o>{</span>
</span></span><span class=line><span class=cl>        key: <span class=m>22</span>
</span></span><span class=line><span class=cl>        value: <span class=o>{</span>
</span></span><span class=line><span class=cl>            name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>            inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    model: <span class=s2>&#34;ixrd10&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div><p>And start it up.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~/labs$ kne_cli create test-sr.pbtxt
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> /home/ubuntu/labs
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating manager <span class=k>for</span>: srl-test
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Trying in-cluster configuration
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Falling back to kubeconfig: <span class=s2>&#34;/home/ubuntu/.kube/config&#34;</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Topology:
</span></span><span class=line><span class=cl>name: <span class=s2>&#34;srl-test&#34;</span>
</span></span><span class=line><span class=cl>nodes: &lt;
</span></span><span class=line><span class=cl>  name: <span class=s2>&#34;r1&#34;</span>
</span></span><span class=line><span class=cl>  services: &lt;
</span></span><span class=line><span class=cl>    key: <span class=m>22</span>
</span></span><span class=line><span class=cl>    value: &lt;
</span></span><span class=line><span class=cl>      name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>      inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>    &gt;
</span></span><span class=line><span class=cl>  &gt;
</span></span><span class=line><span class=cl>  vendor: NOKIA
</span></span><span class=line><span class=cl>  model: <span class=s2>&#34;ixr6&#34;</span>
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>nodes: &lt;
</span></span><span class=line><span class=cl>  name: <span class=s2>&#34;r2&#34;</span>
</span></span><span class=line><span class=cl>  services: &lt;
</span></span><span class=line><span class=cl>    key: <span class=m>22</span>
</span></span><span class=line><span class=cl>    value: &lt;
</span></span><span class=line><span class=cl>      name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>      inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>    &gt;
</span></span><span class=line><span class=cl>  &gt;
</span></span><span class=line><span class=cl>  vendor: NOKIA
</span></span><span class=line><span class=cl>  model: <span class=s2>&#34;ixrd1&#34;</span>
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>nodes: &lt;
</span></span><span class=line><span class=cl>  name: <span class=s2>&#34;r3&#34;</span>
</span></span><span class=line><span class=cl>  services: &lt;
</span></span><span class=line><span class=cl>    key: <span class=m>22</span>
</span></span><span class=line><span class=cl>    value: &lt;
</span></span><span class=line><span class=cl>      name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>      inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>    &gt;
</span></span><span class=line><span class=cl>  &gt;
</span></span><span class=line><span class=cl>  vendor: NOKIA
</span></span><span class=line><span class=cl>  model: <span class=s2>&#34;ixrd2&#34;</span>
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>nodes: &lt;
</span></span><span class=line><span class=cl>  name: <span class=s2>&#34;r4&#34;</span>
</span></span><span class=line><span class=cl>  services: &lt;
</span></span><span class=line><span class=cl>    key: <span class=m>22</span>
</span></span><span class=line><span class=cl>    value: &lt;
</span></span><span class=line><span class=cl>      name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>      inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>    &gt;
</span></span><span class=line><span class=cl>  &gt;
</span></span><span class=line><span class=cl>  vendor: NOKIA
</span></span><span class=line><span class=cl>  model: <span class=s2>&#34;ixrd3&#34;</span>
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>nodes: &lt;
</span></span><span class=line><span class=cl>  name: <span class=s2>&#34;r5&#34;</span>
</span></span><span class=line><span class=cl>  services: &lt;
</span></span><span class=line><span class=cl>    key: <span class=m>22</span>
</span></span><span class=line><span class=cl>    value: &lt;
</span></span><span class=line><span class=cl>      name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>      inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>    &gt;
</span></span><span class=line><span class=cl>  &gt;
</span></span><span class=line><span class=cl>  vendor: NOKIA
</span></span><span class=line><span class=cl>  model: <span class=s2>&#34;ixrd10&#34;</span>
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Node: r1:NOKIA:UNKNOWN
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Node: r2:NOKIA:UNKNOWN
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Node: r3:NOKIA:UNKNOWN
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Node: r4:NOKIA:UNKNOWN
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Node: r5:NOKIA:UNKNOWN
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating namespace <span class=k>for</span> topology: <span class=s2>&#34;srl-test&#34;</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Server Namespace: <span class=p>&amp;</span>Namespace<span class=o>{</span>ObjectMeta:<span class=o>{</span>srl-test    9209b1c5-6ea2-427f-8a2f-4f6e3705f8e8 <span class=m>53116</span> <span class=m>0</span> 2022-06-08 18:41:57 +0000 UTC &lt;nil&gt; &lt;nil&gt; map<span class=o>[</span>kubernetes.io/metadata.name:srl-test<span class=o>]</span> map<span class=o>[]</span> <span class=o>[]</span> <span class=o>[]</span>  <span class=o>[{</span>kne_cli Update v1 2022-06-08 18:41:57 +0000 UTC FieldsV1 <span class=o>{</span><span class=s2>&#34;f:metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:kubernetes.io/metadata.name&#34;</span>:<span class=o>{}}}}}]}</span>,Spec:NamespaceSpec<span class=o>{</span>Finalizers:<span class=o>[</span>kubernetes<span class=o>]</span>,<span class=o>}</span>,Status:NamespaceStatus<span class=o>{</span>Phase:Active,Conditions:<span class=o>[]</span>NamespaceCondition<span class=o>{}</span>,<span class=o>}</span>,<span class=o>}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> namespace srl-test
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> node r5
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> node r1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> node r2
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> node r3
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> node r4
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating topology <span class=k>for</span> meshnet node r2
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Meshnet Node:
</span></span><span class=line><span class=cl><span class=p>&amp;</span><span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name:r2 GenerateName: Namespace:srl-test SelfLink: UID:c11bdba8-4d64-4aea-b065-858907ed8271 ResourceVersion:53119 Generation:1 CreationTimestamp:2022-06-08 18:41:57 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[{</span>Manager:kne_cli Operation:Update APIVersion:networkop.co.uk/v1beta1 Time:2022-06-08 18:41:57 +0000 UTC FieldsType:FieldsV1 FieldsV1:<span class=o>{</span><span class=s2>&#34;f:spec&#34;</span>:<span class=o>{}}}]}</span> Status:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name: GenerateName: Namespace: SelfLink: UID: ResourceVersion: Generation:0 CreationTimestamp:0001-01-01 00:00:00 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[]}</span> Skipped:<span class=o>[]</span> SrcIp: NetNs:<span class=o>}</span> Spec:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> Links:<span class=o>[]}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating topology <span class=k>for</span> meshnet node r3
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Meshnet Node:
</span></span><span class=line><span class=cl><span class=p>&amp;</span><span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name:r3 GenerateName: Namespace:srl-test SelfLink: UID:3b0ca0fd-263a-400b-aec5-c2799a07f711 ResourceVersion:53120 Generation:1 CreationTimestamp:2022-06-08 18:41:57 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[{</span>Manager:kne_cli Operation:Update APIVersion:networkop.co.uk/v1beta1 Time:2022-06-08 18:41:57 +0000 UTC FieldsType:FieldsV1 FieldsV1:<span class=o>{</span><span class=s2>&#34;f:spec&#34;</span>:<span class=o>{}}}]}</span> Status:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name: GenerateName: Namespace: SelfLink: UID: ResourceVersion: Generation:0 CreationTimestamp:0001-01-01 00:00:00 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[]}</span> Skipped:<span class=o>[]</span> SrcIp: NetNs:<span class=o>}</span> Spec:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> Links:<span class=o>[]}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating topology <span class=k>for</span> meshnet node r4
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Meshnet Node:
</span></span><span class=line><span class=cl><span class=p>&amp;</span><span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name:r4 GenerateName: Namespace:srl-test SelfLink: UID:66947ac6-f55a-4082-8eee-4afcbc513c33 ResourceVersion:53121 Generation:1 CreationTimestamp:2022-06-08 18:41:57 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[{</span>Manager:kne_cli Operation:Update APIVersion:networkop.co.uk/v1beta1 Time:2022-06-08 18:41:57 +0000 UTC FieldsType:FieldsV1 FieldsV1:<span class=o>{</span><span class=s2>&#34;f:spec&#34;</span>:<span class=o>{}}}]}</span> Status:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name: GenerateName: Namespace: SelfLink: UID: ResourceVersion: Generation:0 CreationTimestamp:0001-01-01 00:00:00 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[]}</span> Skipped:<span class=o>[]</span> SrcIp: NetNs:<span class=o>}</span> Spec:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> Links:<span class=o>[]}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating topology <span class=k>for</span> meshnet node r5
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Meshnet Node:
</span></span><span class=line><span class=cl><span class=p>&amp;</span><span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name:r5 GenerateName: Namespace:srl-test SelfLink: UID:2f31adf0-3298-4709-a310-5144e1253913 ResourceVersion:53122 Generation:1 CreationTimestamp:2022-06-08 18:41:57 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[{</span>Manager:kne_cli Operation:Update APIVersion:networkop.co.uk/v1beta1 Time:2022-06-08 18:41:57 +0000 UTC FieldsType:FieldsV1 FieldsV1:<span class=o>{</span><span class=s2>&#34;f:spec&#34;</span>:<span class=o>{}}}]}</span> Status:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name: GenerateName: Namespace: SelfLink: UID: ResourceVersion: Generation:0 CreationTimestamp:0001-01-01 00:00:00 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[]}</span> Skipped:<span class=o>[]</span> SrcIp: NetNs:<span class=o>}</span> Spec:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> Links:<span class=o>[]}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating topology <span class=k>for</span> meshnet node r1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Meshnet Node:
</span></span><span class=line><span class=cl><span class=p>&amp;</span><span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name:r1 GenerateName: Namespace:srl-test SelfLink: UID:54123e29-d30e-4c6c-8e65-a2689d8bce5f ResourceVersion:53123 Generation:1 CreationTimestamp:2022-06-08 18:41:57 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[{</span>Manager:kne_cli Operation:Update APIVersion:networkop.co.uk/v1beta1 Time:2022-06-08 18:41:57 +0000 UTC FieldsType:FieldsV1 FieldsV1:<span class=o>{</span><span class=s2>&#34;f:spec&#34;</span>:<span class=o>{}}}]}</span> Status:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name: GenerateName: Namespace: SelfLink: UID: ResourceVersion: Generation:0 CreationTimestamp:0001-01-01 00:00:00 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[]}</span> Skipped:<span class=o>[]</span> SrcIp: NetNs:<span class=o>}</span> Spec:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> Links:<span class=o>[]}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating Node Pods
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating Srlinux node resource r3
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Created SR Linux node r3 configmap
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Created Srlinux resource: r3
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Created Service:
</span></span><span class=line><span class=cl><span class=p>&amp;</span>Service<span class=o>{</span>ObjectMeta:<span class=o>{</span>service-r3  srl-test  e1b53ca4-5334-42b1-bc76-d02541fae176 <span class=m>53133</span> <span class=m>0</span> 2022-06-08 18:41:58 +0000 UTC &lt;nil&gt; &lt;nil&gt; map<span class=o>[</span>pod:r3<span class=o>]</span> map<span class=o>[]</span> <span class=o>[]</span> <span class=o>[]</span>  <span class=o>[{</span>kne_cli Update v1 2022-06-08 18:41:58 +0000 UTC FieldsV1 <span class=o>{</span><span class=s2>&#34;f:metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:pod&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:allocateLoadBalancerNodePorts&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:externalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:internalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:ports&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;k:{\&#34;port\&#34;:22,\&#34;protocol\&#34;:\&#34;TCP\&#34;}&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:name&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:port&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:protocol&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:targetPort&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:selector&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:sessionAffinity&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:type&#34;</span>:<span class=o>{}}}}]}</span>,Spec:ServiceSpec<span class=o>{</span>Ports:<span class=o>[]</span>ServicePort<span class=o>{</span>ServicePort<span class=o>{</span>Name:ssh,Protocol:TCP,Port:22,TargetPort:<span class=o>{</span><span class=m>0</span> <span class=m>22</span> <span class=o>}</span>,NodePort:30482,AppProtocol:nil,<span class=o>}</span>,<span class=o>}</span>,Selector:map<span class=o>[</span>string<span class=o>]</span>string<span class=o>{</span>app: r3,<span class=o>}</span>,ClusterIP:10.98.252.104,Type:LoadBalancer,ExternalIPs:<span class=o>[]</span>,SessionAffinity:None,LoadBalancerIP:,LoadBalancerSourceRanges:<span class=o>[]</span>,ExternalName:,ExternalTrafficPolicy:Cluster,HealthCheckNodePort:0,PublishNotReadyAddresses:false,SessionAffinityConfig:nil,TopologyKeys:<span class=o>[]</span>,IPFamilyPolicy:*SingleStack,ClusterIPs:<span class=o>[</span>10.98.252.104<span class=o>]</span>,IPFamilies:<span class=o>[</span>IPv4<span class=o>]</span>,AllocateLoadBalancerNodePorts:*true,LoadBalancerClass:nil,InternalTrafficPolicy:*Cluster,<span class=o>}</span>,Status:ServiceStatus<span class=o>{</span>LoadBalancer:LoadBalancerStatus<span class=o>{</span>Ingress:<span class=o>[]</span>LoadBalancerIngress<span class=o>{}</span>,<span class=o>}</span>,Conditions:<span class=o>[]</span>Condition<span class=o>{}</span>,<span class=o>}</span>,<span class=o>}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Node <span class=s2>&#34;r3&#34;</span> resource created
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating Srlinux node resource r4
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Created SR Linux node r4 configmap
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Created Srlinux resource: r4
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Created Service:
</span></span><span class=line><span class=cl><span class=p>&amp;</span>Service<span class=o>{</span>ObjectMeta:<span class=o>{</span>service-r4  srl-test  c83fd861-fdda-44af-984b-6fe94e3ab2b8 <span class=m>53151</span> <span class=m>0</span> 2022-06-08 18:41:58 +0000 UTC &lt;nil&gt; &lt;nil&gt; map<span class=o>[</span>pod:r4<span class=o>]</span> map<span class=o>[]</span> <span class=o>[]</span> <span class=o>[]</span>  <span class=o>[{</span>kne_cli Update v1 2022-06-08 18:41:58 +0000 UTC FieldsV1 <span class=o>{</span><span class=s2>&#34;f:metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:pod&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:allocateLoadBalancerNodePorts&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:externalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:internalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:ports&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;k:{\&#34;port\&#34;:22,\&#34;protocol\&#34;:\&#34;TCP\&#34;}&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:name&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:port&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:protocol&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:targetPort&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:selector&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:sessionAffinity&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:type&#34;</span>:<span class=o>{}}}}]}</span>,Spec:ServiceSpec<span class=o>{</span>Ports:<span class=o>[]</span>ServicePort<span class=o>{</span>ServicePort<span class=o>{</span>Name:ssh,Protocol:TCP,Port:22,TargetPort:<span class=o>{</span><span class=m>0</span> <span class=m>22</span> <span class=o>}</span>,NodePort:30936,AppProtocol:nil,<span class=o>}</span>,<span class=o>}</span>,Selector:map<span class=o>[</span>string<span class=o>]</span>string<span class=o>{</span>app: r4,<span class=o>}</span>,ClusterIP:10.96.239.113,Type:LoadBalancer,ExternalIPs:<span class=o>[]</span>,SessionAffinity:None,LoadBalancerIP:,LoadBalancerSourceRanges:<span class=o>[]</span>,ExternalName:,ExternalTrafficPolicy:Cluster,HealthCheckNodePort:0,PublishNotReadyAddresses:false,SessionAffinityConfig:nil,TopologyKeys:<span class=o>[]</span>,IPFamilyPolicy:*SingleStack,ClusterIPs:<span class=o>[</span>10.96.239.113<span class=o>]</span>,IPFamilies:<span class=o>[</span>IPv4<span class=o>]</span>,AllocateLoadBalancerNodePorts:*true,LoadBalancerClass:nil,InternalTrafficPolicy:*Cluster,<span class=o>}</span>,Status:ServiceStatus<span class=o>{</span>LoadBalancer:LoadBalancerStatus<span class=o>{</span>Ingress:<span class=o>[]</span>LoadBalancerIngress<span class=o>{}</span>,<span class=o>}</span>,Conditions:<span class=o>[]</span>Condition<span class=o>{}</span>,<span class=o>}</span>,<span class=o>}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Node <span class=s2>&#34;r4&#34;</span> resource created
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating Srlinux node resource r5
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Created SR Linux node r5 configmap
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Created Srlinux resource: r5
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Created Service:
</span></span><span class=line><span class=cl><span class=p>&amp;</span>Service<span class=o>{</span>ObjectMeta:<span class=o>{</span>service-r5  srl-test  0b6ab531-b20d-45a4-ac83-d1ce10f08547 <span class=m>53165</span> <span class=m>0</span> 2022-06-08 18:41:58 +0000 UTC &lt;nil&gt; &lt;nil&gt; map<span class=o>[</span>pod:r5<span class=o>]</span> map<span class=o>[]</span> <span class=o>[]</span> <span class=o>[]</span>  <span class=o>[{</span>kne_cli Update v1 2022-06-08 18:41:58 +0000 UTC FieldsV1 <span class=o>{</span><span class=s2>&#34;f:metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:pod&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:allocateLoadBalancerNodePorts&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:externalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:internalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:ports&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;k:{\&#34;port\&#34;:22,\&#34;protocol\&#34;:\&#34;TCP\&#34;}&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:name&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:port&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:protocol&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:targetPort&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:selector&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:sessionAffinity&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:type&#34;</span>:<span class=o>{}}}}]}</span>,Spec:ServiceSpec<span class=o>{</span>Ports:<span class=o>[]</span>ServicePort<span class=o>{</span>ServicePort<span class=o>{</span>Name:ssh,Protocol:TCP,Port:22,TargetPort:<span class=o>{</span><span class=m>0</span> <span class=m>22</span> <span class=o>}</span>,NodePort:31089,AppProtocol:nil,<span class=o>}</span>,<span class=o>}</span>,Selector:map<span class=o>[</span>string<span class=o>]</span>string<span class=o>{</span>app: r5,<span class=o>}</span>,ClusterIP:10.109.164.166,Type:LoadBalancer,ExternalIPs:<span class=o>[]</span>,SessionAffinity:None,LoadBalancerIP:,LoadBalancerSourceRanges:<span class=o>[]</span>,ExternalName:,ExternalTrafficPolicy:Cluster,HealthCheckNodePort:0,PublishNotReadyAddresses:false,SessionAffinityConfig:nil,TopologyKeys:<span class=o>[]</span>,IPFamilyPolicy:*SingleStack,ClusterIPs:<span class=o>[</span>10.109.164.166<span class=o>]</span>,IPFamilies:<span class=o>[</span>IPv4<span class=o>]</span>,AllocateLoadBalancerNodePorts:*true,LoadBalancerClass:nil,InternalTrafficPolicy:*Cluster,<span class=o>}</span>,Status:ServiceStatus<span class=o>{</span>LoadBalancer:LoadBalancerStatus<span class=o>{</span>Ingress:<span class=o>[]</span>LoadBalancerIngress<span class=o>{}</span>,<span class=o>}</span>,Conditions:<span class=o>[]</span>Condition<span class=o>{}</span>,<span class=o>}</span>,<span class=o>}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Node <span class=s2>&#34;r5&#34;</span> resource created
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Creating Srlinux node resource r1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Created SR Linux node r1 configmap
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Created Srlinux resource: r1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Created Service:
</span></span><span class=line><span class=cl><span class=p>&amp;</span>Service<span class=o>{</span>ObjectMeta:<span class=o>{</span>service-r1  srl-test  2c60749c-43d4-498b-90c8-0bf4e319e8fc <span class=m>53180</span> <span class=m>0</span> 2022-06-08 18:41:59 +0000 UTC &lt;nil&gt; &lt;nil&gt; map<span class=o>[</span>pod:r1<span class=o>]</span> map<span class=o>[]</span> <span class=o>[]</span> <span class=o>[]</span>  <span class=o>[{</span>kne_cli Update v1 2022-06-08 18:41:59 +0000 UTC FieldsV1 <span class=o>{</span><span class=s2>&#34;f:metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:pod&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:allocateLoadBalancerNodePorts&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:externalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:internalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:ports&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;k:{\&#34;port\&#34;:22,\&#34;protocol\&#34;:\&#34;TCP\&#34;}&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:name&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:port&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:protocol&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:targetPort&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:selector&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:sessionAffinity&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:type&#34;</span>:<span class=o>{}}}}]}</span>,Spec:ServiceSpec<span class=o>{</span>Ports:<span class=o>[]</span>ServicePort<span class=o>{</span>ServicePort<span class=o>{</span>Name:ssh,Protocol:TCP,Port:22,TargetPort:<span class=o>{</span><span class=m>0</span> <span class=m>22</span> <span class=o>}</span>,NodePort:30431,AppProtocol:nil,<span class=o>}</span>,<span class=o>}</span>,Selector:map<span class=o>[</span>string<span class=o>]</span>string<span class=o>{</span>app: r1,<span class=o>}</span>,ClusterIP:10.99.13.223,Type:LoadBalancer,ExternalIPs:<span class=o>[]</span>,SessionAffinity:None,LoadBalancerIP:,LoadBalancerSourceRanges:<span class=o>[]</span>,ExternalName:,ExternalTrafficPolicy:Cluster,HealthCheckNodePort:0,PublishNotReadyAddresses:false,SessionAffinityConfig:nil,TopologyKeys:<span class=o>[]</span>,IPFamilyPolicy:*SingleStack,ClusterIPs:<span class=o>[</span>10.99.13.223<span class=o>]</span>,IPFamilies:<span class=o>[</span>IPv4<span class=o>]</span>,AllocateLoadBalancerNodePorts:*true,LoadBalancerClass:nil,InternalTrafficPolicy:*Cluster,<span class=o>}</span>,Status:ServiceStatus<span class=o>{</span>LoadBalancer:LoadBalancerStatus<span class=o>{</span>Ingress:<span class=o>[]</span>LoadBalancerIngress<span class=o>{}</span>,<span class=o>}</span>,Conditions:<span class=o>[]</span>Condition<span class=o>{}</span>,<span class=o>}</span>,<span class=o>}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Node <span class=s2>&#34;r1&#34;</span> resource created
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Creating Srlinux node resource r2
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Created SR Linux node r2 configmap
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Created Srlinux resource: r2
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Created Service:
</span></span><span class=line><span class=cl><span class=p>&amp;</span>Service<span class=o>{</span>ObjectMeta:<span class=o>{</span>service-r2  srl-test  0ee27dd3-5e80-429a-afb1-f13f9b99555c <span class=m>53198</span> <span class=m>0</span> 2022-06-08 18:41:59 +0000 UTC &lt;nil&gt; &lt;nil&gt; map<span class=o>[</span>pod:r2<span class=o>]</span> map<span class=o>[]</span> <span class=o>[]</span> <span class=o>[]</span>  <span class=o>[{</span>kne_cli Update v1 2022-06-08 18:41:59 +0000 UTC FieldsV1 <span class=o>{</span><span class=s2>&#34;f:metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:pod&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:allocateLoadBalancerNodePorts&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:externalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:internalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:ports&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;k:{\&#34;port\&#34;:22,\&#34;protocol\&#34;:\&#34;TCP\&#34;}&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:name&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:port&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:protocol&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:targetPort&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:selector&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:sessionAffinity&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:type&#34;</span>:<span class=o>{}}}}]}</span>,Spec:ServiceSpec<span class=o>{</span>Ports:<span class=o>[]</span>ServicePort<span class=o>{</span>ServicePort<span class=o>{</span>Name:ssh,Protocol:TCP,Port:22,TargetPort:<span class=o>{</span><span class=m>0</span> <span class=m>22</span> <span class=o>}</span>,NodePort:30699,AppProtocol:nil,<span class=o>}</span>,<span class=o>}</span>,Selector:map<span class=o>[</span>string<span class=o>]</span>string<span class=o>{</span>app: r2,<span class=o>}</span>,ClusterIP:10.106.39.51,Type:LoadBalancer,ExternalIPs:<span class=o>[]</span>,SessionAffinity:None,LoadBalancerIP:,LoadBalancerSourceRanges:<span class=o>[]</span>,ExternalName:,ExternalTrafficPolicy:Cluster,HealthCheckNodePort:0,PublishNotReadyAddresses:false,SessionAffinityConfig:nil,TopologyKeys:<span class=o>[]</span>,IPFamilyPolicy:*SingleStack,ClusterIPs:<span class=o>[</span>10.106.39.51<span class=o>]</span>,IPFamilies:<span class=o>[</span>IPv4<span class=o>]</span>,AllocateLoadBalancerNodePorts:*true,LoadBalancerClass:nil,InternalTrafficPolicy:*Cluster,<span class=o>}</span>,Status:ServiceStatus<span class=o>{</span>LoadBalancer:LoadBalancerStatus<span class=o>{</span>Ingress:<span class=o>[]</span>LoadBalancerIngress<span class=o>{}</span>,<span class=o>}</span>,Conditions:<span class=o>[]</span>Condition<span class=o>{}</span>,<span class=o>}</span>,<span class=o>}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0001<span class=o>]</span> Node <span class=s2>&#34;r2&#34;</span> resource created
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0003<span class=o>]</span> Node <span class=s2>&#34;r2&#34;</span>: Status RUNNING
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0003<span class=o>]</span> Node <span class=s2>&#34;r1&#34;</span>: Status RUNNING
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0003<span class=o>]</span> Node <span class=s2>&#34;r3&#34;</span>: Status RUNNING
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0004<span class=o>]</span> Node <span class=s2>&#34;r4&#34;</span>: Status RUNNING
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0004<span class=o>]</span> Node <span class=s2>&#34;r5&#34;</span>: Status RUNNING
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0004<span class=o>]</span> Topology <span class=s2>&#34;srl-test&#34;</span> created
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0006<span class=o>]</span> Pods:
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0006<span class=o>]</span> r5
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0006<span class=o>]</span> r1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0006<span class=o>]</span> r2
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0006<span class=o>]</span> r3
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0006<span class=o>]</span> r4</span></span></code></pre></div><p>Let&rsquo;s see what we have on k8s.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl -n srl-test get all -owide
</span></span><span class=line><span class=cl>NAME     READY   STATUS             RESTARTS      AGE   IP            NODE            NOMINATED NODE   READINESS GATES
</span></span><span class=line><span class=cl>pod/r1   0/1     CrashLoopBackOff   <span class=m>2</span> <span class=o>(</span>28s ago<span class=o>)</span>   70s   10.244.1.20   kates-node-01   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>pod/r2   1/1     Running            <span class=m>0</span>             70s   10.244.2.22   kates-node-02   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>pod/r3   1/1     Running            <span class=m>0</span>             71s   10.244.2.20   kates-node-02   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>pod/r4   1/1     Running            <span class=m>0</span>             71s   10.244.1.19   kates-node-01   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>pod/r5   0/1     CrashLoopBackOff   <span class=m>2</span> <span class=o>(</span>22s ago<span class=o>)</span>   71s   10.244.2.21   kates-node-02   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                 TYPE           CLUSTER-IP       EXTERNAL-IP    PORT<span class=o>(</span>S<span class=o>)</span>        AGE   SELECTOR
</span></span><span class=line><span class=cl>service/service-r1   LoadBalancer   10.99.13.223     192.168.1.53   22:30431/TCP   70s   <span class=nv>app</span><span class=o>=</span>r1
</span></span><span class=line><span class=cl>service/service-r2   LoadBalancer   10.106.39.51     192.168.1.54   22:30699/TCP   70s   <span class=nv>app</span><span class=o>=</span>r2
</span></span><span class=line><span class=cl>service/service-r3   LoadBalancer   10.98.252.104    192.168.1.50   22:30482/TCP   71s   <span class=nv>app</span><span class=o>=</span>r3
</span></span><span class=line><span class=cl>service/service-r4   LoadBalancer   10.96.239.113    192.168.1.51   22:30936/TCP   71s   <span class=nv>app</span><span class=o>=</span>r4
</span></span><span class=line><span class=cl>service/service-r5   LoadBalancer   10.109.164.166   192.168.1.52   22:31089/TCP   71s   <span class=nv>app</span><span class=o>=</span>r5
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$</span></span></code></pre></div><p>So, r1 and r5 are loop crashing and from the logs it seems something hardware related.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl -n srl-test logs r1
</span></span><span class=line><span class=cl>Defaulted container <span class=s2>&#34;r1&#34;</span> out of: r1, init-r1 <span class=o>(</span>init<span class=o>)</span>
</span></span><span class=line><span class=cl>Wed Jun  <span class=m>8</span> 18:59:10 UTC 2022: entrypoint.sh called
</span></span><span class=line><span class=cl>Wed Jun  <span class=m>8</span> 18:59:10 UTC 2022: renaming docker interface eth0 to mgmt0
</span></span><span class=line><span class=cl>Cannot find device <span class=s2>&#34;eth0&#34;</span>
</span></span><span class=line><span class=cl>Device <span class=s2>&#34;eth0&#34;</span> does not exist.
</span></span><span class=line><span class=cl>Cannot find device <span class=s2>&#34;eth0&#34;</span>
</span></span><span class=line><span class=cl>Cannot find device <span class=s2>&#34;eth0&#34;</span>
</span></span><span class=line><span class=cl>Wed Jun  <span class=m>8</span> 18:59:10 UTC 2022: turning off checksum offloading on mgmt0
</span></span><span class=line><span class=cl>Wed Jun  <span class=m>8</span> 18:59:10 UTC 2022: starting sshd
</span></span><span class=line><span class=cl>ssh-keygen: generating new host keys: RSA DSA ECDSA ED25519
</span></span><span class=line><span class=cl>Wed Jun  <span class=m>8</span> 18:59:11 UTC 2022: Calling boot_run script
</span></span><span class=line><span class=cl>cat: /sys/class/dmi/id/board_name: No such file or directory
</span></span><span class="line hl"><span class=cl>/opt/srlinux/bin/bootscript/01_sr_bdb_arbitration.sh: line 9:    <span class=m>97</span> Aborted                 <span class=o>(</span>core dumped<span class=o>)</span> <span class=si>${</span><span class=nv>dev_mgr</span><span class=si>}</span> --hw-details --matelink --log-stdout &gt; <span class=si>${</span><span class=nv>arbitration_log</span><span class=si>}</span>
</span></span><span class=line><span class=cl>cat: /sys/class/dmi/id/board_name: No such file or directory
</span></span><span class=line><span class=cl>/opt/srlinux/bin/bootscript/05_sr_createuser.sh: line 270: !srl_is_running_on_nokia_rootfs: <span class=nb>command</span> not found
</span></span><span class=line><span class=cl>/opt/srlinux/bin/bootscript/05_sr_createuser.sh: line 282: python: <span class=nb>command</span> not found
</span></span><span class=line><span class=cl>chmod: cannot access <span class=s1>&#39;/dev/console&#39;</span>: No such file or directory
</span></span><span class=line><span class=cl>chmod: missing operand after <span class=s1>&#39;0664&#39;</span>
</span></span><span class=line><span class=cl>Try <span class=s1>&#39;chmod --help&#39;</span> <span class=k>for</span> more information.
</span></span><span class=line><span class=cl>/usr/bin/find: <span class=s1>&#39;/var/log/srlinux/file&#39;</span>: No such file or directory
</span></span><span class=line><span class=cl>logmgr_set_env.sh: plain_bootup_start
</span></span><span class=line><span class=cl>Wed Jun  <span class=m>8</span> 18:59:13 UTC <span class=m>2022</span>  logmgr_set_env.sh: restart of rsyslogd
</span></span><span class=line><span class=cl>which: no python in <span class=o>(</span>/opt/srlinux/bin:/opt/srlinux/usr/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin<span class=o>)</span>
</span></span><span class=line><span class=cl>readlink: missing operand
</span></span><span class=line><span class=cl>Try <span class=s1>&#39;readlink --help&#39;</span> <span class=k>for</span> more information.
</span></span><span class=line><span class=cl>setfacl: /mnt/nokiaos: No such file or directory
</span></span><span class=line><span class=cl>setfacl: /mnt/nokiaos: No such file or directory
</span></span><span class=line><span class=cl>setfacl: /mnt/nokiaos: No such file or directory
</span></span><span class=line><span class=cl>setfacl: /mnt/nokiaos: No such file or directory
</span></span><span class=line><span class=cl>setfacl: Option -m: Invalid argument near character <span class=m>5</span>
</span></span><span class=line><span class=cl>setfacl: Option -m: Invalid argument near character <span class=m>3</span>
</span></span><span class=line><span class=cl>setfacl: Option -m: Invalid argument near character <span class=m>5</span>
</span></span><span class=line><span class=cl>setfacl: Option -m: Invalid argument near character <span class=m>3</span>
</span></span><span class=line><span class=cl>System has not been booted with systemd as init system <span class=o>(</span>PID 1<span class=o>)</span>. Can<span class=s1>&#39;t operate.
</span></span></span><span class=line><span class=cl><span class=s1>Failed to connect to bus: Host is down
</span></span></span><span class=line><span class=cl><span class=s1>Failed to open connection to &#34;system&#34; message bus: Failed to connect to socket /run/dbus/system_bus_socket: No such file or directory
</span></span></span><span class=line><span class=cl><span class=s1>System has not been booted with systemd as init system (PID 1). Can&#39;</span>t operate.
</span></span><span class=line><span class=cl>Failed to connect to bus: Host is down
</span></span><span class=line><span class=cl>findfs: unable to resolve <span class=s1>&#39;LABEL=EFI-System&#39;</span>
</span></span><span class=line><span class=cl>No disk with label EFI-System is found
</span></span><span class=line><span class=cl>Failed to <span class=nb>set</span> capabilities on file <span class=sb>`</span>/usr/sbin/tcpdump<span class=err>&#39;</span> <span class=o>(</span>No such file or directory<span class=o>)</span>
</span></span><span class=line><span class=cl>usage: setcap <span class=o>[</span>-q<span class=o>]</span> <span class=o>[</span>-v<span class=o>]</span> <span class=o>[</span>-n &lt;rootid&gt;<span class=o>]</span> <span class=o>(</span>-r<span class=p>|</span>-<span class=p>|</span>&lt;caps&gt;<span class=o>)</span> &lt;filename&gt; <span class=o>[</span> ... <span class=o>(</span>-r<span class=p>|</span>-<span class=p>|</span>&lt;capsN&gt;<span class=o>)</span> &lt;filenameN&gt; <span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Note &lt;filename&gt; must be a regular <span class=o>(</span>non-symlink<span class=o>)</span> file.
</span></span><span class=line><span class=cl>Wed Jun  <span class=m>8</span> 18:59:15 UTC 2022: entrypoint.sh <span class=k>done</span>, executing sudo bash -c touch /.dockerenv <span class=o>&amp;&amp;</span> /opt/srlinux/bin/sr_linux
</span></span><span class=line><span class=cl>No/Invalid license found!
</span></span><span class=line><span class=cl>Not starting in a named namespace, giving it the name <span class=s2>&#34;srbase&#34;</span>
</span></span><span class=line><span class=cl>Unix domain socket directory is /opt/srlinux/var/run/
</span></span><span class=line><span class=cl>Log directory is /var/log/srlinux/stdout
</span></span><span class=line><span class=cl>  Started supportd: <span class=nb>source</span> /etc/profile.d/sr_app_env.sh <span class=p>&amp;</span>&gt;/dev/null<span class=p>;</span> bash -c <span class=s2>&#34;./sr_supportd --server-mode&#34;</span> &gt;/var/log/srlinux/stdout/supportd.log 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>  Application supportd is running: PID <span class=m>1474</span>
</span></span><span class=line><span class=cl>  Started dev_mgr: <span class=nb>source</span> /etc/profile.d/sr_app_env.sh <span class=p>&amp;</span>&gt;/dev/null<span class=p>;</span> bash -c <span class=s2>&#34;./sr_device_mgr&#34;</span> &gt;/var/log/srlinux/stdout/dev_mgr.log 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>  Application dev_mgr is running: PID <span class=m>1496</span>
</span></span><span class=line><span class=cl>  Found dev_mgr: PID <span class=m>1496</span> - killing
</span></span><span class=line><span class=cl>  Found supportd: PID <span class=m>1474</span> - killing
</span></span><span class=line><span class=cl>  Failed to <span class=nb>kill</span> supportd: PID 1474. Another <span class=nb>kill</span> is retried</span></span></code></pre></div><p>I guess more to troubleshoot, but for another time &#x1f604;. Let&rsquo;s see what we got for the other variants</p><table><thead><tr><th style=text-align:center>Device</th><th style=text-align:center>Variant</th><th style=text-align:center>Chassis Type</th><th style=text-align:center>Specs</th></tr></thead><tbody><tr><td style=text-align:center>r1</td><td style=text-align:center>ixr6</td><td style=text-align:center>NA</td><td style=text-align:center>NA</td></tr><tr><td style=text-align:center>r2</td><td style=text-align:center>ixrd1</td><td style=text-align:center>7220 IXR-D1</td><td style=text-align:center>48x1G , 4x10G</td></tr><tr><td style=text-align:center>r3</td><td style=text-align:center>ixrd2</td><td style=text-align:center>7220 IXR-D2</td><td style=text-align:center>48x25G, 4x100G</td></tr><tr><td style=text-align:center>r4</td><td style=text-align:center>ixrd3</td><td style=text-align:center>7220 IXR-D3</td><td style=text-align:center>2x10G, 32x100G</td></tr><tr><td style=text-align:center>r5</td><td style=text-align:center>ixrd10</td><td style=text-align:center>NA</td><td style=text-align:center>NA</td></tr></tbody></table><hr><h3 class=heading-element id=test-arista-ceos><span>Test Arista cEOS</span>
<a href=#test-arista-ceos class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><hr><p>Get the arista container image and copy it to all k8s nodes or only to the workers if you control-plane is tainted. Then import it in each node.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ sudo ctr -n k8s.io image import ceos.tgz
</span></span><span class=line><span class=cl>unpacking docker.io/library/ceos:latest <span class=o>(</span>sha256:bfd3f2fea1cad2d06f0e5113cb3a1dc81f0ccbb28acf11949e15dadcf68eda9a<span class=o>)</span>...done</span></span></code></pre></div><p>Let&rsquo;s create a simple lab file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~/labs$ cat ceos.pbtxt
</span></span><span class=line><span class=cl>name: <span class=s2>&#34;arista&#34;</span>
</span></span><span class=line><span class=cl>nodes: <span class=o>{</span>
</span></span><span class=line><span class=cl>    name: <span class=s2>&#34;r1&#34;</span>
</span></span><span class=line><span class=cl>    type: ARISTA_CEOS
</span></span><span class=line><span class=cl>    services:<span class=o>{</span>
</span></span><span class=line><span class=cl>        key: <span class=m>22</span>
</span></span><span class=line><span class=cl>        value: <span class=o>{</span>
</span></span><span class=line><span class=cl>            name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>            inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>nodes: <span class=o>{</span>
</span></span><span class=line><span class=cl>    name: <span class=s2>&#34;r2&#34;</span>
</span></span><span class=line><span class=cl>    type: ARISTA_CEOS
</span></span><span class=line><span class=cl>    services:<span class=o>{</span>
</span></span><span class=line><span class=cl>        key: <span class=m>22</span>
</span></span><span class=line><span class=cl>        value: <span class=o>{</span>
</span></span><span class=line><span class=cl>            name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>            inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>links: <span class=o>{</span>
</span></span><span class=line><span class=cl>    a_node: <span class=s2>&#34;r1&#34;</span>
</span></span><span class=line><span class=cl>    a_int: <span class=s2>&#34;eth1&#34;</span>
</span></span><span class=line><span class=cl>    z_node: <span class=s2>&#34;r2&#34;</span>
</span></span><span class=line><span class=cl>    z_int: <span class=s2>&#34;eth1&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>links: <span class=o>{</span>
</span></span><span class=line><span class=cl>    a_node: <span class=s2>&#34;r1&#34;</span>
</span></span><span class=line><span class=cl>    a_int: <span class=s2>&#34;eth2&#34;</span>
</span></span><span class=line><span class=cl>    z_node: <span class=s2>&#34;r2&#34;</span>
</span></span><span class=line><span class=cl>    z_int: <span class=s2>&#34;eth2&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div><p>And fire up the topology.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~/labs$ kne_cli create ceos.pbtxt
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> /home/ubuntu/labs
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating manager <span class=k>for</span>: arista
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Trying in-cluster configuration
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Falling back to kubeconfig: <span class=s2>&#34;/home/ubuntu/.kube/config&#34;</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Topology:
</span></span><span class=line><span class=cl>name: <span class=s2>&#34;arista&#34;</span>
</span></span><span class=line><span class=cl>nodes: &lt;
</span></span><span class=line><span class=cl>  name: <span class=s2>&#34;r1&#34;</span>
</span></span><span class=line><span class=cl>  type: ARISTA_CEOS
</span></span><span class=line><span class=cl>  services: &lt;
</span></span><span class=line><span class=cl>    key: <span class=m>22</span>
</span></span><span class=line><span class=cl>    value: &lt;
</span></span><span class=line><span class=cl>      name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>      inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>    &gt;
</span></span><span class=line><span class=cl>  &gt;
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>nodes: &lt;
</span></span><span class=line><span class=cl>  name: <span class=s2>&#34;r2&#34;</span>
</span></span><span class=line><span class=cl>  type: ARISTA_CEOS
</span></span><span class=line><span class=cl>  services: &lt;
</span></span><span class=line><span class=cl>    key: <span class=m>22</span>
</span></span><span class=line><span class=cl>    value: &lt;
</span></span><span class=line><span class=cl>      name: <span class=s2>&#34;ssh&#34;</span>
</span></span><span class=line><span class=cl>      inside: <span class=m>22</span>
</span></span><span class=line><span class=cl>    &gt;
</span></span><span class=line><span class=cl>  &gt;
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>links: &lt;
</span></span><span class=line><span class=cl>  a_node: <span class=s2>&#34;r1&#34;</span>
</span></span><span class=line><span class=cl>  a_int: <span class=s2>&#34;eth1&#34;</span>
</span></span><span class=line><span class=cl>  z_node: <span class=s2>&#34;r2&#34;</span>
</span></span><span class=line><span class=cl>  z_int: <span class=s2>&#34;eth1&#34;</span>
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>links: &lt;
</span></span><span class=line><span class=cl>  a_node: <span class=s2>&#34;r1&#34;</span>
</span></span><span class=line><span class=cl>  a_int: <span class=s2>&#34;eth2&#34;</span>
</span></span><span class=line><span class=cl>  z_node: <span class=s2>&#34;r2&#34;</span>
</span></span><span class=line><span class=cl>  z_int: <span class=s2>&#34;eth2&#34;</span>
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Link: r1:eth1 r2:eth1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Link: r1:eth2 r2:eth2
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Node: r1:UNKNOWN:ARISTA_CEOS
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Adding Node: r2:UNKNOWN:ARISTA_CEOS
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating namespace <span class=k>for</span> topology: <span class=s2>&#34;arista&#34;</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Server Namespace: <span class=p>&amp;</span>Namespace<span class=o>{</span>ObjectMeta:<span class=o>{</span>arista    82fe4826-a7dd-4fa3-bf2d-36d09236c2d7 <span class=m>71849</span> <span class=m>0</span> 2022-06-08 20:49:14 +0000 UTC &lt;nil&gt; &lt;nil&gt; map<span class=o>[</span>kubernetes.io/metadata.name:arista<span class=o>]</span> map<span class=o>[]</span> <span class=o>[]</span> <span class=o>[]</span>  <span class=o>[{</span>kne_cli Update v1 2022-06-08 20:49:14 +0000 UTC FieldsV1 <span class=o>{</span><span class=s2>&#34;f:metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:kubernetes.io/metadata.name&#34;</span>:<span class=o>{}}}}}]}</span>,Spec:NamespaceSpec<span class=o>{</span>Finalizers:<span class=o>[</span>kubernetes<span class=o>]</span>,<span class=o>}</span>,Status:NamespaceStatus<span class=o>{</span>Phase:Active,Conditions:<span class=o>[]</span>NamespaceCondition<span class=o>{}</span>,<span class=o>}</span>,<span class=o>}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> namespace arista
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> node r1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Getting topology specs <span class=k>for</span> node r2
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating topology <span class=k>for</span> meshnet node r1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Meshnet Node:
</span></span><span class=line><span class=cl><span class=p>&amp;</span><span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name:r1 GenerateName: Namespace:arista SelfLink: UID:ba43116d-1c55-4e43-9201-cd7f2c9f3259 ResourceVersion:71852 Generation:1 CreationTimestamp:2022-06-08 20:49:14 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[{</span>Manager:kne_cli Operation:Update APIVersion:networkop.co.uk/v1beta1 Time:2022-06-08 20:49:14 +0000 UTC FieldsType:FieldsV1 FieldsV1:<span class=o>{</span><span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:links&#34;</span>:<span class=o>{}}}}]}</span> Status:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name: GenerateName: Namespace: SelfLink: UID: ResourceVersion: Generation:0 CreationTimestamp:0001-01-01 00:00:00 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[]}</span> Skipped:<span class=o>[]</span> SrcIp: NetNs:<span class=o>}</span> Spec:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> Links:<span class=o>[{</span>LocalIntf:eth1 LocalIP: PeerIntf:eth1 PeerIP: PeerPod:r2 UID:0<span class=o>}</span> <span class=o>{</span>LocalIntf:eth2 LocalIP: PeerIntf:eth2 PeerIP: PeerPod:r2 UID:1<span class=o>}]}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating topology <span class=k>for</span> meshnet node r2
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Meshnet Node:
</span></span><span class=line><span class=cl><span class=p>&amp;</span><span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name:r2 GenerateName: Namespace:arista SelfLink: UID:e677078e-0dc1-4e02-8258-b759acb61cfd ResourceVersion:71853 Generation:1 CreationTimestamp:2022-06-08 20:49:14 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[{</span>Manager:kne_cli Operation:Update APIVersion:networkop.co.uk/v1beta1 Time:2022-06-08 20:49:14 +0000 UTC FieldsType:FieldsV1 FieldsV1:<span class=o>{</span><span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:links&#34;</span>:<span class=o>{}}}}]}</span> Status:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> ObjectMeta:<span class=o>{</span>Name: GenerateName: Namespace: SelfLink: UID: ResourceVersion: Generation:0 CreationTimestamp:0001-01-01 00:00:00 +0000 UTC DeletionTimestamp:&lt;nil&gt; DeletionGracePeriodSeconds:&lt;nil&gt; Labels:map<span class=o>[]</span> Annotations:map<span class=o>[]</span> OwnerReferences:<span class=o>[]</span> Finalizers:<span class=o>[]</span> ClusterName: ManagedFields:<span class=o>[]}</span> Skipped:<span class=o>[]</span> SrcIp: NetNs:<span class=o>}</span> Spec:<span class=o>{</span>TypeMeta:<span class=o>{</span>Kind: APIVersion:<span class=o>}</span> Links:<span class=o>[{</span>LocalIntf:eth1 LocalIP: PeerIntf:eth1 PeerIP: PeerPod:r1 UID:0<span class=o>}</span> <span class=o>{</span>LocalIntf:eth2 LocalIP: PeerIntf:eth2 PeerIP: PeerPod:r1 UID:1<span class=o>}]}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating Node Pods
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating Pod:
</span></span><span class=line><span class=cl> name:<span class=s2>&#34;r1&#34;</span> type:ARISTA_CEOS labels:<span class=o>{</span>key:<span class=s2>&#34;model&#34;</span> value:<span class=s2>&#34;&#34;</span><span class=o>}</span> labels:<span class=o>{</span>key:<span class=s2>&#34;os&#34;</span> value:<span class=s2>&#34;&#34;</span><span class=o>}</span> labels:<span class=o>{</span>key:<span class=s2>&#34;type&#34;</span> value:<span class=s2>&#34;ARISTA_CEOS&#34;</span><span class=o>}</span> labels:<span class=o>{</span>key:<span class=s2>&#34;vendor&#34;</span> value:<span class=s2>&#34;ARISTA&#34;</span><span class=o>}</span> labels:<span class=o>{</span>key:<span class=s2>&#34;version&#34;</span> value:<span class=s2>&#34;&#34;</span><span class=o>}</span> config:<span class=o>{</span>command:<span class=s2>&#34;/sbin/init&#34;</span> command:<span class=s2>&#34;systemd.setenv=INTFTYPE=eth&#34;</span> command:<span class=s2>&#34;systemd.setenv=ETBA=1&#34;</span> command:<span class=s2>&#34;systemd.setenv=SKIP_ZEROTOUCH_BARRIER_IN_SYSDBINIT=1&#34;</span> command:<span class=s2>&#34;systemd.setenv=CEOS=1&#34;</span> command:<span class=s2>&#34;systemd.setenv=EOS_PLATFORM=ceoslab&#34;</span> command:<span class=s2>&#34;systemd.setenv=container=docker&#34;</span> image:<span class=s2>&#34;ceos:latest&#34;</span> env:<span class=o>{</span>key:<span class=s2>&#34;CEOS&#34;</span> value:<span class=s2>&#34;1&#34;</span><span class=o>}</span> env:<span class=o>{</span>key:<span class=s2>&#34;EOS_PLATFORM&#34;</span> value:<span class=s2>&#34;ceoslab&#34;</span><span class=o>}</span> env:<span class=o>{</span>key:<span class=s2>&#34;ETBA&#34;</span> value:<span class=s2>&#34;1&#34;</span><span class=o>}</span> env:<span class=o>{</span>key:<span class=s2>&#34;INTFTYPE&#34;</span> value:<span class=s2>&#34;eth&#34;</span><span class=o>}</span> env:<span class=o>{</span>key:<span class=s2>&#34;SKIP_ZEROTOUCH_BARRIER_IN_SYSDBINIT&#34;</span> value:<span class=s2>&#34;1&#34;</span><span class=o>}</span> env:<span class=o>{</span>key:<span class=s2>&#34;container&#34;</span> value:<span class=s2>&#34;docker&#34;</span><span class=o>}</span> entry_command:<span class=s2>&#34;kubectl exec -it r1 -- Cli&#34;</span> config_path:<span class=s2>&#34;/mnt/flash&#34;</span> config_file:<span class=s2>&#34;startup-config&#34;</span><span class=o>}</span> services:<span class=o>{</span>key:22 value:<span class=o>{</span>name:<span class=s2>&#34;ssh&#34;</span> inside:22<span class=o>}}</span> constraints:<span class=o>{</span>key:<span class=s2>&#34;cpu&#34;</span> value:<span class=s2>&#34;0.5&#34;</span><span class=o>}</span> constraints:<span class=o>{</span>key:<span class=s2>&#34;memory&#34;</span> value:<span class=s2>&#34;1Gi&#34;</span><span class=o>}</span> interfaces:<span class=o>{</span>key:<span class=s2>&#34;eth1&#34;</span> value:<span class=o>{</span>name:<span class=s2>&#34;Ethernet1&#34;</span> int_name:<span class=s2>&#34;eth1&#34;</span> peer_name:<span class=s2>&#34;r2&#34;</span> peer_int_name:<span class=s2>&#34;eth1&#34;</span><span class=o>}}</span> interfaces:<span class=o>{</span>key:<span class=s2>&#34;eth2&#34;</span> value:<span class=o>{</span>name:<span class=s2>&#34;Ethernet2&#34;</span> int_name:<span class=s2>&#34;eth2&#34;</span> peer_name:<span class=s2>&#34;r2&#34;</span> peer_int_name:<span class=s2>&#34;eth2&#34;</span> uid:1<span class=o>}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Created Service:
</span></span><span class=line><span class=cl><span class=p>&amp;</span>Service<span class=o>{</span>ObjectMeta:<span class=o>{</span>service-r1  arista  4c93f283-7153-4813-aca5-875e70277c9a <span class=m>71860</span> <span class=m>0</span> 2022-06-08 20:49:14 +0000 UTC &lt;nil&gt; &lt;nil&gt; map<span class=o>[</span>pod:r1<span class=o>]</span> map<span class=o>[]</span> <span class=o>[]</span> <span class=o>[]</span>  <span class=o>[{</span>kne_cli Update v1 2022-06-08 20:49:14 +0000 UTC FieldsV1 <span class=o>{</span><span class=s2>&#34;f:metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:pod&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:allocateLoadBalancerNodePorts&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:externalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:internalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:ports&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;k:{\&#34;port\&#34;:22,\&#34;protocol\&#34;:\&#34;TCP\&#34;}&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:name&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:port&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:protocol&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:targetPort&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:selector&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:sessionAffinity&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:type&#34;</span>:<span class=o>{}}}}]}</span>,Spec:ServiceSpec<span class=o>{</span>Ports:<span class=o>[]</span>ServicePort<span class=o>{</span>ServicePort<span class=o>{</span>Name:ssh,Protocol:TCP,Port:22,TargetPort:<span class=o>{</span><span class=m>0</span> <span class=m>22</span> <span class=o>}</span>,NodePort:31088,AppProtocol:nil,<span class=o>}</span>,<span class=o>}</span>,Selector:map<span class=o>[</span>string<span class=o>]</span>string<span class=o>{</span>app: r1,<span class=o>}</span>,ClusterIP:10.102.188.238,Type:LoadBalancer,ExternalIPs:<span class=o>[]</span>,SessionAffinity:None,LoadBalancerIP:,LoadBalancerSourceRanges:<span class=o>[]</span>,ExternalName:,ExternalTrafficPolicy:Cluster,HealthCheckNodePort:0,PublishNotReadyAddresses:false,SessionAffinityConfig:nil,TopologyKeys:<span class=o>[]</span>,IPFamilyPolicy:*SingleStack,ClusterIPs:<span class=o>[</span>10.102.188.238<span class=o>]</span>,IPFamilies:<span class=o>[</span>IPv4<span class=o>]</span>,AllocateLoadBalancerNodePorts:*true,LoadBalancerClass:nil,InternalTrafficPolicy:*Cluster,<span class=o>}</span>,Status:ServiceStatus<span class=o>{</span>LoadBalancer:LoadBalancerStatus<span class=o>{</span>Ingress:<span class=o>[]</span>LoadBalancerIngress<span class=o>{}</span>,<span class=o>}</span>,Conditions:<span class=o>[]</span>Condition<span class=o>{}</span>,<span class=o>}</span>,<span class=o>}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Node <span class=s2>&#34;r1&#34;</span> resource created
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Creating Pod:
</span></span><span class=line><span class=cl> name:<span class=s2>&#34;r2&#34;</span> type:ARISTA_CEOS labels:<span class=o>{</span>key:<span class=s2>&#34;model&#34;</span> value:<span class=s2>&#34;&#34;</span><span class=o>}</span> labels:<span class=o>{</span>key:<span class=s2>&#34;os&#34;</span> value:<span class=s2>&#34;&#34;</span><span class=o>}</span> labels:<span class=o>{</span>key:<span class=s2>&#34;type&#34;</span> value:<span class=s2>&#34;ARISTA_CEOS&#34;</span><span class=o>}</span> labels:<span class=o>{</span>key:<span class=s2>&#34;vendor&#34;</span> value:<span class=s2>&#34;ARISTA&#34;</span><span class=o>}</span> labels:<span class=o>{</span>key:<span class=s2>&#34;version&#34;</span> value:<span class=s2>&#34;&#34;</span><span class=o>}</span> config:<span class=o>{</span>command:<span class=s2>&#34;/sbin/init&#34;</span> command:<span class=s2>&#34;systemd.setenv=INTFTYPE=eth&#34;</span> command:<span class=s2>&#34;systemd.setenv=ETBA=1&#34;</span> command:<span class=s2>&#34;systemd.setenv=SKIP_ZEROTOUCH_BARRIER_IN_SYSDBINIT=1&#34;</span> command:<span class=s2>&#34;systemd.setenv=CEOS=1&#34;</span> command:<span class=s2>&#34;systemd.setenv=EOS_PLATFORM=ceoslab&#34;</span> command:<span class=s2>&#34;systemd.setenv=container=docker&#34;</span> image:<span class=s2>&#34;ceos:latest&#34;</span> env:<span class=o>{</span>key:<span class=s2>&#34;CEOS&#34;</span> value:<span class=s2>&#34;1&#34;</span><span class=o>}</span> env:<span class=o>{</span>key:<span class=s2>&#34;EOS_PLATFORM&#34;</span> value:<span class=s2>&#34;ceoslab&#34;</span><span class=o>}</span> env:<span class=o>{</span>key:<span class=s2>&#34;ETBA&#34;</span> value:<span class=s2>&#34;1&#34;</span><span class=o>}</span> env:<span class=o>{</span>key:<span class=s2>&#34;INTFTYPE&#34;</span> value:<span class=s2>&#34;eth&#34;</span><span class=o>}</span> env:<span class=o>{</span>key:<span class=s2>&#34;SKIP_ZEROTOUCH_BARRIER_IN_SYSDBINIT&#34;</span> value:<span class=s2>&#34;1&#34;</span><span class=o>}</span> env:<span class=o>{</span>key:<span class=s2>&#34;container&#34;</span> value:<span class=s2>&#34;docker&#34;</span><span class=o>}</span> entry_command:<span class=s2>&#34;kubectl exec -it r2 -- Cli&#34;</span> config_path:<span class=s2>&#34;/mnt/flash&#34;</span> config_file:<span class=s2>&#34;startup-config&#34;</span><span class=o>}</span> services:<span class=o>{</span>key:22 value:<span class=o>{</span>name:<span class=s2>&#34;ssh&#34;</span> inside:22<span class=o>}}</span> constraints:<span class=o>{</span>key:<span class=s2>&#34;cpu&#34;</span> value:<span class=s2>&#34;0.5&#34;</span><span class=o>}</span> constraints:<span class=o>{</span>key:<span class=s2>&#34;memory&#34;</span> value:<span class=s2>&#34;1Gi&#34;</span><span class=o>}</span> interfaces:<span class=o>{</span>key:<span class=s2>&#34;eth1&#34;</span> value:<span class=o>{</span>name:<span class=s2>&#34;Ethernet1&#34;</span> int_name:<span class=s2>&#34;eth1&#34;</span> peer_name:<span class=s2>&#34;r1&#34;</span> peer_int_name:<span class=s2>&#34;eth1&#34;</span><span class=o>}}</span> interfaces:<span class=o>{</span>key:<span class=s2>&#34;eth2&#34;</span> value:<span class=o>{</span>name:<span class=s2>&#34;Ethernet2&#34;</span> int_name:<span class=s2>&#34;eth2&#34;</span> peer_name:<span class=s2>&#34;r1&#34;</span> peer_int_name:<span class=s2>&#34;eth2&#34;</span> uid:1<span class=o>}}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Created Service:
</span></span><span class=line><span class=cl><span class=p>&amp;</span>Service<span class=o>{</span>ObjectMeta:<span class=o>{</span>service-r2  arista  1ff432b7-ddd9-4ee4-9a07-dc28be6053d8 <span class=m>71872</span> <span class=m>0</span> 2022-06-08 20:49:14 +0000 UTC &lt;nil&gt; &lt;nil&gt; map<span class=o>[</span>pod:r2<span class=o>]</span> map<span class=o>[]</span> <span class=o>[]</span> <span class=o>[]</span>  <span class=o>[{</span>kne_cli Update v1 2022-06-08 20:49:14 +0000 UTC FieldsV1 <span class=o>{</span><span class=s2>&#34;f:metadata&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:labels&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:pod&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:spec&#34;</span>:<span class=o>{</span><span class=s2>&#34;f:allocateLoadBalancerNodePorts&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:externalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:internalTrafficPolicy&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:ports&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;k:{\&#34;port\&#34;:22,\&#34;protocol\&#34;:\&#34;TCP\&#34;}&#34;</span>:<span class=o>{</span><span class=s2>&#34;.&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:name&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:port&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:protocol&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:targetPort&#34;</span>:<span class=o>{}}}</span>,<span class=s2>&#34;f:selector&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:sessionAffinity&#34;</span>:<span class=o>{}</span>,<span class=s2>&#34;f:type&#34;</span>:<span class=o>{}}}}]}</span>,Spec:ServiceSpec<span class=o>{</span>Ports:<span class=o>[]</span>ServicePort<span class=o>{</span>ServicePort<span class=o>{</span>Name:ssh,Protocol:TCP,Port:22,TargetPort:<span class=o>{</span><span class=m>0</span> <span class=m>22</span> <span class=o>}</span>,NodePort:30761,AppProtocol:nil,<span class=o>}</span>,<span class=o>}</span>,Selector:map<span class=o>[</span>string<span class=o>]</span>string<span class=o>{</span>app: r2,<span class=o>}</span>,ClusterIP:10.110.58.235,Type:LoadBalancer,ExternalIPs:<span class=o>[]</span>,SessionAffinity:None,LoadBalancerIP:,LoadBalancerSourceRanges:<span class=o>[]</span>,ExternalName:,ExternalTrafficPolicy:Cluster,HealthCheckNodePort:0,PublishNotReadyAddresses:false,SessionAffinityConfig:nil,TopologyKeys:<span class=o>[]</span>,IPFamilyPolicy:*SingleStack,ClusterIPs:<span class=o>[</span>10.110.58.235<span class=o>]</span>,IPFamilies:<span class=o>[</span>IPv4<span class=o>]</span>,AllocateLoadBalancerNodePorts:*true,LoadBalancerClass:nil,InternalTrafficPolicy:*Cluster,<span class=o>}</span>,Status:ServiceStatus<span class=o>{</span>LoadBalancer:LoadBalancerStatus<span class=o>{</span>Ingress:<span class=o>[]</span>LoadBalancerIngress<span class=o>{}</span>,<span class=o>}</span>,Conditions:<span class=o>[]</span>Condition<span class=o>{}</span>,<span class=o>}</span>,<span class=o>}</span>
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0000<span class=o>]</span> Node <span class=s2>&#34;r2&#34;</span> resource created
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0004<span class=o>]</span> Node <span class=s2>&#34;r2&#34;</span>: Status RUNNING
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0004<span class=o>]</span> Node <span class=s2>&#34;r1&#34;</span>: Status RUNNING
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0004<span class=o>]</span> Topology <span class=s2>&#34;arista&#34;</span> created
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0005<span class=o>]</span> Pods:
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0005<span class=o>]</span> r1
</span></span><span class=line><span class=cl>INFO<span class=o>[</span>0005<span class=o>]</span> r2</span></span></code></pre></div><p>Check on k8s.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl -n arista get all -o wide
</span></span><span class=line><span class=cl>NAME     READY   STATUS    RESTARTS   AGE   IP            NODE            NOMINATED NODE   READINESS GATES
</span></span><span class=line><span class=cl>pod/r1   1/1     Running   <span class=m>0</span>          62s   10.244.1.23   kates-node-01   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>pod/r2   1/1     Running   <span class=m>0</span>          62s   10.244.2.25   kates-node-02   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                 TYPE           CLUSTER-IP       EXTERNAL-IP    PORT<span class=o>(</span>S<span class=o>)</span>        AGE   SELECTOR
</span></span><span class=line><span class=cl>service/service-r1   LoadBalancer   10.102.188.238   192.168.1.50   22:31088/TCP   62s   <span class=nv>app</span><span class=o>=</span>r1
</span></span><span class=line><span class=cl>service/service-r2   LoadBalancer   10.110.58.235    192.168.1.51   22:30761/TCP   62s   <span class=nv>app</span><span class=o>=</span>r2</span></span></code></pre></div><p>Seems good. Let&rsquo;s perform the initial configuration.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># For r1</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl -n arista <span class=nb>exec</span> -it r1 -- Cli
</span></span><span class=line><span class=cl>Defaulted container <span class=s2>&#34;r1&#34;</span> out of: r1, init-r1 <span class=o>(</span>init<span class=o>)</span>
</span></span><span class=line><span class=cl>localhost&gt;en
</span></span><span class=line><span class=cl>localhost#conf
</span></span><span class=line><span class=cl>localhost<span class=o>(</span>config<span class=o>)</span><span class=c1>#hostname r1</span>
</span></span><span class=line><span class=cl>r1<span class=o>(</span>config<span class=o>)</span><span class=c1>#interface ethernet 1</span>
</span></span><span class=line><span class=cl>r1<span class=o>(</span>config-if-Et1<span class=o>)</span><span class=c1>#no switchport</span>
</span></span><span class=line><span class=cl>r1<span class=o>(</span>config-if-Et1<span class=o>)</span><span class=c1>#ip address 10.1.1.1/30</span>
</span></span><span class=line><span class=cl>r1<span class=o>(</span>config-if-Et1<span class=o>)</span><span class=c1>#interface ethernet 2</span>
</span></span><span class=line><span class=cl>r1<span class=o>(</span>config-if-Et2<span class=o>)</span><span class=c1>#no switchport</span>
</span></span><span class=line><span class=cl>r1<span class=o>(</span>config-if-Et2<span class=o>)</span><span class=c1>#ip address 10.2.2.1/30</span>
</span></span><span class=line><span class=cl>r1<span class=o>(</span>config-if-Et2<span class=o>)</span><span class=c1>#end</span>
</span></span><span class=line><span class=cl>r1#conf
</span></span><span class=line><span class=cl>r1<span class=o>(</span>config<span class=o>)</span><span class=c1>#username admin privilege 15 secret admin</span>
</span></span><span class=line><span class=cl>r1<span class=o>(</span>config<span class=o>)</span><span class=c1>#end</span>
</span></span><span class=line><span class=cl>r1#write
</span></span><span class=line><span class=cl>Copy completed successfully.
</span></span><span class=line><span class=cl>r1#show interfaces status
</span></span><span class=line><span class=cl>Port       Name   Status       Vlan     Duplex Speed  Type            Flags Encapsulation
</span></span><span class=line><span class=cl>Et1               connected    routed   full   1G     EbraTestPhyPort
</span></span><span class=line><span class=cl>Et2               connected    routed   full   1G     EbraTestPhyPort
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># For r2</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ kubectl -n arista <span class=nb>exec</span> -it r2 -- Cli
</span></span><span class=line><span class=cl>Defaulted container <span class=s2>&#34;r2&#34;</span> out of: r2, init-r2 <span class=o>(</span>init<span class=o>)</span>
</span></span><span class=line><span class=cl>localhost&gt;en
</span></span><span class=line><span class=cl>localhost#conf
</span></span><span class=line><span class=cl>localhost<span class=o>(</span>config<span class=o>)</span><span class=c1>#hostname r2</span>
</span></span><span class=line><span class=cl>r2<span class=o>(</span>config<span class=o>)</span><span class=c1>#username admin privilege 15 secret admin</span>
</span></span><span class=line><span class=cl>r2<span class=o>(</span>config<span class=o>)</span><span class=c1>#interface ethernet 1</span>
</span></span><span class=line><span class=cl>r2<span class=o>(</span>config-if-Et1<span class=o>)</span><span class=c1>#no switchport</span>
</span></span><span class=line><span class=cl>r2<span class=o>(</span>config-if-Et1<span class=o>)</span><span class=c1>#ip address 10.1.1.2/30</span>
</span></span><span class=line><span class=cl>r2<span class=o>(</span>config-if-Et1<span class=o>)</span><span class=c1>#interface ethernet 2</span>
</span></span><span class=line><span class=cl>r2<span class=o>(</span>config-if-Et2<span class=o>)</span><span class=c1>#no switchport</span>
</span></span><span class=line><span class=cl>r2<span class=o>(</span>config-if-Et2<span class=o>)</span><span class=c1>#ip address 10.2.2.2/30</span>
</span></span><span class=line><span class=cl>r2<span class=o>(</span>config-if-Et2<span class=o>)</span><span class=c1>#end</span>
</span></span><span class=line><span class=cl>r2#write
</span></span><span class=line><span class=cl>Copy completed successfully.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check connectivity</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>r2#ping 10.1.1.1
</span></span><span class=line><span class=cl>PING 10.1.1.1 <span class=o>(</span>10.1.1.1<span class=o>)</span> 72<span class=o>(</span>100<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>80</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>1.36 ms
</span></span><span class=line><span class=cl><span class=m>80</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.482 ms
</span></span><span class=line><span class=cl><span class=m>80</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.621 ms
</span></span><span class=line><span class=cl><span class=m>80</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.452 ms
</span></span><span class=line><span class=cl><span class=m>80</span> bytes from 10.1.1.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>5</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>1.26 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 10.1.1.1 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>5</span> packets transmitted, <span class=m>5</span> received, 0% packet loss, <span class=nb>time</span> 4ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 0.452/0.836/1.362/0.397 ms, ipg/ewma 1.118/1.106 ms
</span></span><span class=line><span class=cl>r2#ping 10.2.2.1
</span></span><span class=line><span class=cl>PING 10.2.2.1 <span class=o>(</span>10.2.2.1<span class=o>)</span> 72<span class=o>(</span>100<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>80</span> bytes from 10.2.2.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>1.14 ms
</span></span><span class=line><span class=cl><span class=m>80</span> bytes from 10.2.2.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.512 ms
</span></span><span class=line><span class=cl><span class=m>80</span> bytes from 10.2.2.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.555 ms
</span></span><span class=line><span class=cl><span class=m>80</span> bytes from 10.2.2.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.556 ms
</span></span><span class=line><span class=cl><span class=m>80</span> bytes from 10.2.2.1: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>5</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.490 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 10.2.2.1 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>5</span> packets transmitted, <span class=m>5</span> received, 0% packet loss, <span class=nb>time</span> 4ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 0.490/0.650/1.140/0.247 ms, ipg/ewma 1.064/0.886 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Test OOB SSH access</span>
</span></span><span class=line><span class=cl>ubuntu@kates-control:~$ ssh admin@192.168.1.50
</span></span><span class=line><span class=cl>Password:
</span></span><span class=line><span class=cl>r1&gt;en
</span></span><span class=line><span class=cl>r1#conf
</span></span><span class=line><span class=cl>r1<span class=o>(</span>config<span class=o>)</span><span class=c1>#interface ethernet 1 - 2</span>
</span></span><span class=line><span class=cl>r1<span class=o>(</span>config-if-Et1-2<span class=o>)</span><span class=c1>#shutdown</span>
</span></span><span class=line><span class=cl>r1<span class=o>(</span>config-if-Et1-2<span class=o>)</span><span class=c1>#end</span>
</span></span><span class=line><span class=cl>r1#show user de
</span></span><span class=line><span class=cl>Session       Username       Roles               TTY        State       Duration       Auth        Remote Host
</span></span><span class=line><span class=cl>------------- -------------- ------------------- ---------- ----------- -------------- ----------- -----------
</span></span><span class=line><span class=cl><span class=m>13</span>            admin          network-admin       vty5       E           0:00:24        <span class=nb>local</span>       10.244.0.0
</span></span><span class=line><span class=cl>r1#show interfaces status
</span></span><span class=line><span class=cl>Port       Name   Status       Vlan     Duplex Speed  Type            Flags Encapsulation
</span></span><span class=line><span class=cl>Et1               disabled     routed   full   1G     EbraTestPhyPort
</span></span><span class=line><span class=cl>Et2               disabled     routed   full   1G     EbraTestPhyPort</span></span></code></pre></div><p>Seems we are ready now for some serious labbing. &#x1f604;</p><hr><h3 class=heading-element id=references-and-influences><span>References and influences</span>
<a href=#references-and-influences class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><ul><li><a href=https://github.com/google/kne target=_blank rel="external nofollow noopener noreferrer">KNE on github</a></li><li><a href=https://blog.itsalwaysthe.network/posts/kubernetes-based-network-emulation/ target=_blank rel="external nofollow noopener noreferrer">Inspired by this Blog post</a></li><li><a href=https://metallb.universe.tf/installation/ target=_blank rel="external nofollow noopener noreferrer">metallb</a></li><li><a href=https://github.com/srl-labs/srl-controller#readme target=_blank rel="external nofollow noopener noreferrer">srl-labs on github</a></li><li><a href=https://learn.srlinux.dev/ target=_blank rel="external nofollow noopener noreferrer">srlinux</a></li></ul><hr><h2 class=heading-element id=outro><span>Outro</span>
<a href=#outro class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><hr><p>Well, this was just a bare miminum and focused on how to set things up. I hope my post will help someone to start kicking the tyres with KNE. I also hope the project gets traction and evolves since the applications of it seem endless &#x1f604; from all aspects. Thanking you, for reading the post, as well as all people sharing and contributing to the community making it sustainable and strong.</p><p align=right>...till next time...<em>have fun!</em></p></div><hr class=awesome-hr><h2 id=see-also>Related Content</h2><ul><li><a href=/posts/kube-my-router-pt2/ title="Kube My Router Up! - Part Two">Kube My Router Up! - Part Two</a></li><li><a href=/posts/kube-my-router-pt1/ title="Kube My Router Up! - Part One">Kube My Router Up! - Part One</a></li></ul><div class=collection-card><div class="collection-title text-secondary">Included in <a href=/collections/kube-my-router-up/><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> <span>Collection・Kube My Router Up!</span></span></a> 3</div><div class=collection-nav><a href=/posts/kube-my-router-pt2/ class=collection-nav-item rel=prev title="Kube My Router Up! - Part Two"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i><span>Kube My Router Up! - Part Two</span></a></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="Updated on 2022-06-09 00:00:00">Updated on 2022-06-09&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/kube-my-router-pt3/index.md title="Read Markdown" class=link-to-markdown>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on X" data-sharer=twitter data-url=https://net4fungr.github.io/posts/kube-my-router-pt3/ data-title="Kube My Router Up! - Last Part" data-via=mkaliotis data-hashtags=k8s,kne,netsim><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://net4fungr.github.io/posts/kube-my-router-pt3/><i class="fa-brands fa-linkedin fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://net4fungr.github.io/posts/kube-my-router-pt3/><i class="fa-brands fa-reddit fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/k8s/ class=post-tag title="Tags - K8s">K8s</a><a href=/tags/kne/ class=post-tag title="Tags - Kne">Kne</a><a href=/tags/netsim/ class=post-tag title="Tags - Netsim">Netsim</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/kube-my-router-pt2/ class=post-nav-item rel=prev title="Kube My Router Up! - Part Two"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Kube My Router Up! - Part Two</a><a href=/posts/proxy-or-not/ class=post-nav-item rel=next title="Proxy or Not...here I Come...">Proxy or Not...here I Come...<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus class=comment><script src=https://giscus.app/client.js data-repo=Net4FunGR/net4fungr.github.io data-repo-id=R_kgDOGLZFKQ data-category="Blog Comments" data-category-id=DIC_kwDOGLZFKc4Cf1aA data-mapping=title data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=en data-loading=lazy crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article><aside class=toc id=toc-auto aria-label=Contents><h2 class=toc-title>Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class="toc-content always-active" id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered">Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.147.2"><img class=hugo-icon src=/images/hugo.min.svg alt="Hugo logo"> Hugo</a> | Theme - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.3.20"><img class=fixit-icon src=/images/fixit.min.svg alt="FixIt logo"> FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2021 - 2025</span><span class=author itemprop=copyrightHolder>
<a href=https://github.com/becos76 target=_blank rel="external nofollow noopener noreferrer">becos76</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label="View Comments"><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/becos76/ title="Visit my GitHub" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:orange;--bg-progress-dark:grey></div><noscript><div class=noscript-warning>This website works best with JavaScript enabled.</div></noscript></div><link rel=stylesheet href=/lib/lightgallery/css/lightgallery-bundle.min.css><link rel=preload href=/lib/katex/katex.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/katex/katex.min.css></noscript><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/twemoji/twemoji.min.js defer></script><script src=/lib/lightgallery/lightgallery.min.js defer></script><script src=/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js defer></script><script src=/lib/lightgallery/plugins/zoom/lg-zoom.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/typeit/index.umd.js defer></script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script src=/lib/pace/pace.min.js async defer></script><script>window.config={code:{maxShownLines:-1},comment:{enable:!0,expired:!1,giscus:{darkTheme:"dark",lightTheme:"light",origin:"https://giscus.app"}},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/search.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:3,noResultsFound:"No results found",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!1},twemoji:!0,typeit:{cursorChar:"|",cursorSpeed:1e3,duration:-1,loop:!1,speed:50},version:"v0.3.20"}</script><script src=/js/theme.min.js defer></script></body></html>